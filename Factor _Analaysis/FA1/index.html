<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Interactive Factor Analysis Report with detailed visualizations and statistical analysis">
  <meta name="theme-color" content="#4f46e5">
  
  <!-- Performance optimizations -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M11 3a8 8 0 00-8 8 8 8 0 008 8 8 8 0 008-8 8 8 0 00-8-8zm0 2a6 6 0 016 6 6 6 0 01-6 6 6 6 0 01-6-6 6 6 0 016-6zm3 3l-5 5-2-2-1 1 3 3 6-6-1-1z' fill='%234f46e5'/%3E%3C/svg%3E">
  
  <title>Factor Analysis Report</title>
  
  <!-- Font preloading for faster text rendering -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"></noscript>
  
  <!-- Defer non-critical JS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.1.0/dist/chartjs-plugin-annotation.min.js" defer></script>
  
  <!-- Critical CSS first, TailwindCSS after -->
  <style>
    /* Critical render path styles */
    :root {
      --primary: #4f46e5;
      --primary-dark: #4338ca;
      --secondary: #7e22ce;
      --accent: #2563eb;
      --text-main: #1f2937;
      --text-light: #6b7280;
      --light-bg: #f9fafb;
      --dark-bg: #111827;
    }
    
    /* Font optimization */
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      text-rendering: optimizeSpeed;
      scroll-behavior: smooth;
    }
    
    /* Loading indicator */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.3s ease-out;
    }
    
    .dark .loading-overlay {
      background-color: #1f2937;
    }
    
    .loader {
      width: 48px;
      height: 48px;
      border: 5px solid #ddd;
      border-bottom-color: var(--primary);
      border-radius: 50%;
      animation: rotate 1s linear infinite;
    }
    
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Minimize layout shifts - set fixed height for elements that load dynamically */
    .chart-container {
      min-height: 300px;
      position: relative;
    }
    
    /* Add focus styles for accessibility */
    :focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }
    
    /* Skip to content link for accessibility */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--primary);
      color: white;
      padding: 8px;
      z-index: 10000;
      transition: top 0.3s;
    }
    
    .skip-link:focus {
      top: 0;
    }
  </style>
  
  <!-- Browser compatibility and performance optimizations -->
  <style>
    /* Reduce layout shifts with content-visibility */
    .offscreen-content {
      content-visibility: auto;
      contain-intrinsic-size: 0 500px;
    }
    
    /* Add content-visibility for deferred content */
    .tab-panel:not(.active) {
      content-visibility: auto;
      contain-intrinsic-size: 0 700px;
    }
    
    /* Add hardware acceleration to animated elements */
    .animate-element {
      transform: translateZ(0);
      will-change: transform, opacity;
    }
    
    /* Add passive loading indicator for large content areas */
    .content-loading {
      position: relative;
      min-height: 200px;
    }
    
    .content-loading::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 40px;
      height: 40px;
      margin-top: -20px;
      margin-left: -20px;
      border: 3px solid #eee;
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: rotate 1s linear infinite;
    }
    
    /* Optimize responsive images */
    .optimized-image {
      max-width: 100%;
      height: auto;
      display: block;
    }
    
    /* Add font size adjustment for accessibility */
    .text-size-large {
      font-size: 1.2em;
      line-height: 1.5;
    }
    
    /* Add high contrast mode */
    .high-contrast {
      --primary: #0000ff;
      --secondary: #9900cc;
      --accent: #0066cc;
      --text-main: #000000;
      --text-light: #333333;
      --light-bg: #ffffff;
      --dark-bg: #000000;
      color: #000000;
      background-color: #ffffff;
    }
    
    .high-contrast.dark {
      color: #ffffff;
      background-color: #000000;
    }
    
    /* Add reduced motion mode */
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }
    
    /* Print optimization */
    @media print {
      .no-print {
        display: none !important;
      }
      
      body {
        font-size: 12pt;
        color: #000;
        background-color: #fff;
      }
      
      .page-break {
        page-break-before: always;
      }
      
      a[href]:after {
        content: " (" attr(href) ")";
      }
    }
  </style>
  
  <!-- Tailwind after critical CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* New dataset information section animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes pulse-slow {
      0%, 100% { transform: scale(1); opacity: 0.8; }
      50% { transform: scale(1.05); opacity: 1; }
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    @keyframes badge-entrance {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .animate-fadeIn {
      animation: fadeIn 0.8s ease-in-out;
    }
    
    .animate-pulse-slow {
      animation: pulse-slow 4s infinite ease-in-out;
    }
    
    .animate-shimmer {
      animation: shimmer 3s infinite linear;
    }
    
    .shadow-glow {
      box-shadow: 0 0 15px rgba(99, 102, 241, 0.3);
    }
    
    .slide-in-right {
      animation: slide-in-right 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
    }
    
    @keyframes slide-in-right {
      0% { transform: translateX(-20px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    
    .badge-animation {
      animation: badge-entrance 0.5s ease-out forwards;
    }
    
    .pulse-animation {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
      100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
    }
    
    .dataset-info-card {
      transition: all 0.3s ease;
    }
    
    .dataset-info-card:hover {
      transform: translateY(-5px);
    }
    
    .data-pattern-overlay {
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M54.627 0l.83.828-1.415 1.415L51.8 0h2.827zM5.373 0l-.83.828L5.96 2.243 8.2 0H5.374zM48.97 0l3.657 3.657-1.414 1.414L46.143 0h2.828zM11.03 0L7.372 3.657 8.787 5.07 13.857 0H11.03zm32.284 0L49.8 6.485 48.384 7.9l-7.9-7.9h2.83zM16.686 0L10.2 6.485 11.616 7.9l7.9-7.9h-2.83zm20.97 0l9.315 9.314-1.414 1.414L34.828 0h2.83zm-20.97 0l-9.315 9.314 1.414 1.414L25.172 0h-2.83zm-20.97 0l-9.315 9.314 1.414 1.414L13.857 0h-2.83zm20.97 0l9.315 9.314-1.414 1.414L34.828 0h2.83zm20.97 0l9.315 9.314-1.414 1.414L51.8 0h2.827zm-5.656 0L30 41.03 11.03 60h2.828L30 43.858 46.142 60h2.83zm-5.656 0L30 46.686 16.686 60h2.83L30 49.515 40.485 60h2.83zm-5.657 0L30 52.343 22.344 60h2.83L30 55.172 34.828 60h2.83zm-5.657 0L30 58.001 22.344 60h2.83L30 60.828 37.656 60h2.83zm5.657 0L30 63.657 27.172 60h2.83L30 61.885 32.828 60h2.827zm5.657 0L30 69.314 24.343 60h2.83L30 62.143 35.657 60h2.827zm5.656 0L30 74.97 24.343 60h2.83L30 67.8l5.657 7.172h2.827zm5.656 0L30 80.627 24.343 60h2.83L30 73.456 35.657 60h2.827zm5.656 0L30 86.285 24.343 60h2.83L30 79.114 35.657 60h2.827zm5.656 0L30 91.943 24.343 60h2.83L30 84.772 35.657 60h2.827zm5.656 0L30 97.6 24.343 60h2.83L30 90.429 35.657 60h2.827zM32 0l12.142 12.142-1.414 1.414L30 2.828 17.272 15.556l-1.414-1.414L28 0h4zM.284 0l28 28-1.414 1.414L0 2.544V0h.284zM0 5.373l25.456 25.455-1.414 1.415L0 8.2V5.374zm0 5.656l22.627 22.627-1.414 1.414L0 13.86v-2.83zm0 5.656l19.8 19.8-1.415 1.413L0 19.514v-2.83zm0 5.657l16.97 16.97-1.414 1.415L0 25.172v-2.83zM0 28l14.142 14.142-1.414 1.414L0 30.828V28zm0 5.657L11.314 44.97l-1.414 1.415L0 36.485v-2.83zm0 5.657L8.485 47.8l-1.414 1.414L0 42.143v-2.83zm0 5.657l5.657 5.657-1.414 1.415L0 47.8v-2.83zm0 5.657l2.828 2.83-1.414 1.413L0 53.456v-2.83zM54.627 60L30 35.373 5.373 60H8.2L30 38.2 51.8 60h2.827zm-5.656 0L30 41.03 11.03 60h2.828L30 43.858 46.142 60h2.83zm-5.656 0L30 46.686 16.686 60h2.83L30 49.515 40.485 60h2.83zm-5.657 0L30 52.343 22.344 60h2.83L30 55.172 34.828 60h2.83zm-5.657 0L30 58.001 22.344 60h2.83L30 60.828 37.656 60h2.83zm5.657 0L30 63.657 27.172 60h2.83L30 61.885 32.828 60h2.827zm5.657 0L30 69.314 24.343 60h2.83L30 62.143 35.657 60h2.827zm5.656 0L30 74.97 24.343 60h2.83L30 67.8l5.657 7.172h2.827zm5.656 0L30 80.627 24.343 60h2.83L30 73.456 35.657 60h2.827zm5.656 0L30 86.285 24.343 60h2.83L30 79.114 35.657 60h2.827zm5.656 0L30 91.943 24.343 60h2.83L30 84.772 35.657 60h2.827zm5.656 0L30 97.6 24.343 60h2.83L30 90.429 35.657 60h2.827zM39.9 16.385l1.414-1.414L30 3.658 18.686 14.97l1.415 1.415 9.9-9.9 9.9 9.9zm-2.83 2.828l1.415-1.414L30 9.313 21.515 17.8l1.414 1.413L30 11.8l7.07 7.07z' fill='%23ffffff' fill-opacity='0.03' fill-rule='evenodd'/%3E%3C/svg%3E");
      opacity: 0.5;
    }
    
    /* Counter animation */
    .count-animation .counter {
      display: inline-block;
      position: relative;
    }
  </style>
  <script>
    // Preload critical resources for better performance
    document.addEventListener('DOMContentLoaded', function() {
      // Add Font Awesome asynchronously to prevent render blocking
      const fontAwesome = document.createElement('link');
      fontAwesome.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css';
      fontAwesome.rel = 'stylesheet';
      document.head.appendChild(fontAwesome);
      
      // Add custom scrollbar styles for better UX
      const scrollbarStyle = document.createElement('style');
      scrollbarStyle.textContent = `
        .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(156, 163, 175, 0.5); border-radius: 3px; }
        .dark .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(75, 85, 99, 0.5); }
      `;
      document.head.appendChild(scrollbarStyle);
      
      // Hide loading overlay when content is ready
      setTimeout(() => {
        const loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
          loadingOverlay.style.opacity = '0';
          setTimeout(() => {
            loadingOverlay.style.display = 'none';
          }, 300);
        }
      }, 800);
    });
    
    // Wait for Chart.js to load
    window.addEventListener('load', function() {
      // Register the plugins globally if Chart is available
      if (typeof Chart !== 'undefined') {
        Chart.register(ChartDataLabels);
        
        // Initialize all charts
        initializeCharts();
      } else {
        console.warn('Chart.js not loaded yet. Charts will be initialized when ready.');
        // Try again in a moment
        setTimeout(() => {
          if (typeof Chart !== 'undefined') {
            Chart.register(ChartDataLabels);
            initializeCharts();
          }
        }, 1000);
      }
      
      // Initialize counter animations
      document.querySelectorAll('.count-animation').forEach(counter => {
        const targetValue = parseInt(counter.getAttribute('data-value'));
        const counterElement = counter.querySelector('.counter');
        const duration = 1500; // Animation duration in milliseconds
        const steps = 30; // Number of steps in animation
        const stepTime = duration / steps;
        const increment = targetValue / steps;
        let currentValue = 0;
        
        const counterInterval = setInterval(() => {
          currentValue += increment;
          if (currentValue >= targetValue) {
            currentValue = targetValue;
            clearInterval(counterInterval);
          }
          counterElement.textContent = Math.round(currentValue);
        }, stepTime);
      });
      
      // Add animations for the dataset variable items with staggered delay
      document.querySelectorAll('.variable-item').forEach((item, index) => {
        // Add staggered animation delay
        item.style.opacity = '0';
        item.style.transform = 'translateX(-20px)';
        item.style.transition = 'all 0.3s ease-out';
        
        setTimeout(() => {
          item.style.opacity = '1';
          item.style.transform = 'translateX(0)';
        }, 100 + (index * 50)); // Staggered delay
        
        // Add hover effect for icons
        const icon = item.querySelector('.variable-icon');
        if (icon) {
          item.addEventListener('mouseenter', () => {
            icon.style.transform = 'scale(1.2) rotate(5deg)';
            icon.style.transition = 'transform 0.3s ease-out';
          });
          
          item.addEventListener('mouseleave', () => {
            icon.style.transform = 'scale(1) rotate(0)';
          });
        }
      });
      
      // Add glow effect to buttons
      document.querySelectorAll('.btn-glow').forEach(btn => {
        btn.addEventListener('mouseenter', () => {
          btn.style.boxShadow = '0 0 15px rgba(59, 130, 246, 0.5)';
        });
        
        btn.addEventListener('mouseleave', () => {
          btn.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.1)';
        });
      });
      
      // Add animation for the dataset info card
      const datasetCard = document.querySelector('.dataset-info-card');
      if (datasetCard) {
        // Apply initial animation
        datasetCard.classList.add('animate-fadeIn');
        
        // Add parallax effect on mouse move
        datasetCard.addEventListener('mousemove', (e) => {
          const card = e.currentTarget;
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          
          const moveX = (x - centerX) / 30;
          const moveY = (y - centerY) / 30;
          
          // Apply subtle transform
          card.style.transform = `perspective(1000px) rotateX(${-moveY}deg) rotateY(${moveX}deg) scale3d(1.02, 1.02, 1.02)`;
        });
        
        // Reset transform on mouse leave
        datasetCard.addEventListener('mouseleave', (e) => {
          e.currentTarget.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)';
        });
      }
      
      // Function to destroy existing chart if it exists
      function destroyChart(chartId) {
        const existingChart = Chart.getChart(chartId);
        if (existingChart) {
          existingChart.destroy();
        }
      }

      // Function to create charts
      function initializeCharts() {
                  // Scree Plot
        const screeCtx = document.getElementById('screePlot');
        if (screeCtx) {
          destroyChart('screePlot');
          const screePlot = new Chart(screeCtx.getContext('2d'), {
            type: 'line',
            data: {
              labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
              datasets: [{
                label: 'Eigenvalues',
                data: [3.298, 1.214, 1.196, 0.85, 0.75, 0.65, 0.45, 0.32, 0.28],
                borderColor: 'rgb(59, 130, 246)', // bright blue
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                pointBackgroundColor: 'rgb(59, 130, 246)',
                pointBorderColor: '#fff',
                pointBorderWidth: 2,
                pointRadius: 5,
                pointHoverRadius: 7,
                fill: true,
                tension: 0.4,
                borderWidth: 2
              }, {
                label: 'Kaiser Criterion (Eigenvalue=1)',
                data: [1, 1, 1, 1, 1, 1, 1, 1, 1],
                borderColor: 'rgba(244, 63, 94, 0.6)', // light red
                borderDash: [5, 5],
                pointRadius: 0,
                fill: false,
                borderWidth: 2
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: 'bottom',
                  align: 'start',
                  labels: {
                    usePointStyle: true,
                    padding: 10,
                    boxWidth: 10,
                    boxHeight: 10,
                    font: {
                      size: 11
                    }
                  }
                },
                tooltip: {
                  backgroundColor: 'rgba(255, 255, 255, 0.95)',
                  titleColor: '#1a1a1a',
                  bodyColor: '#666666',
                  borderColor: '#e5e7eb',
                  borderWidth: 1,
                  padding: 10,
                  cornerRadius: 4,
                  displayColors: true,
                  callbacks: {
                    label: function(context) {
                      if (context.dataset.label === 'Eigenvalues') {
                        return `Eigenvalues: ${context.parsed.y.toFixed(3)}`;
                      }
                      return `Kaiser Criterion: ${context.parsed.y.toFixed(3)}`;
                    }
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  max: 3.5,
                  grid: {
                    color: 'rgba(226, 232, 240, 0.6)',
                    drawBorder: false
                  },
                  ticks: {
                    stepSize: 0.5,
                    padding: 8,
                    font: {
                      size: 11
                    }
                  },
                  title: {
                    display: true,
                    text: 'Eigenvalue',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  }
                },
                x: {
                  grid: {
                    display: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  },
                  title: {
                    display: true,
                    text: 'Factor Number',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {top: 10}
                  }
                }
              }
            }
          });
        } else {
          console.log('Scree plot canvas not found');
        }

                  // Communalities Chart
        const communalitiesCtx = document.getElementById('communalitiesChart');
        if (communalitiesCtx) {
          destroyChart('communalitiesChart');
          new Chart(communalitiesCtx, {
            type: 'bar',
            data: {
              labels: ['climate', 'housing', 'health', 'crime', 'trans', 'educate', 'arts', 'recreate', 'econ'],
              datasets: [{
                label: 'Communality',
                data: [0.795, 0.518, 0.722, 0.512, 0.510, 0.561, 0.754, 0.517, 0.728],
                backgroundColor: [
                  'rgba(16, 185, 129, 0.8)',  // emerald
                  'rgba(99, 102, 241, 0.8)',  // indigo
                  'rgba(20, 184, 166, 0.8)',  // teal
                  'rgba(249, 115, 22, 0.8)',  // orange
                  'rgba(59, 130, 246, 0.8)',  // blue
                  'rgba(236, 72, 153, 0.8)',  // pink
                  'rgba(16, 185, 129, 0.8)',  // emerald
                  'rgba(139, 92, 246, 0.8)',  // violet
                  'rgba(34, 197, 94, 0.8)'    // green
                ],
                borderWidth: 1,
                borderRadius: 6,
                borderColor: [
                  'rgb(16, 185, 129)',
                  'rgb(99, 102, 241)',
                  'rgb(20, 184, 166)',
                  'rgb(249, 115, 22)',
                  'rgb(59, 130, 246)',
                  'rgb(236, 72, 153)',
                  'rgb(16, 185, 129)',
                  'rgb(139, 92, 246)',
                  'rgb(34, 197, 94)'
                ]
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              animation: {
                duration: 2000,
                easing: 'easeOutQuart'
              },
              plugins: {
                legend: {
                  display: false
                },
                tooltip: {
                  backgroundColor: 'rgba(255, 255, 255, 0.95)',
                  titleColor: '#1a1a1a',
                  bodyColor: '#666666',
                  borderColor: '#e5e7eb',
                  borderWidth: 1,
                  padding: 12,
                  cornerRadius: 4,
                  callbacks: {
                    label: function(context) {
                      const value = context.raw;
                      let interpretation = value > 0.7 ? 'Excellent' : value > 0.5 ? 'Good' : 'Fair';
                      return [`Value: ${value.toFixed(3)}`, `Interpretation: ${interpretation}`];
                    }
                  }
                },
                datalabels: {
                  color: '#ffffff',
                  font: {
                    weight: '600',
                    size: 11
                  },
                  padding: 4,
                  formatter: (value) => value.toFixed(3)
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  max: 1,
                  title: {
                    display: true,
                    text: 'Communality Value',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  },
                  grid: {
                    color: 'rgba(226, 232, 240, 0.6)',
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  }
                },
                x: {
                  grid: {
                    display: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  }
                }
              }
            }
          });
        } else {
          console.log('Communalities chart canvas not found');
        }

                  // Variance Distribution Chart
        const varianceCtx = document.getElementById('varianceExplainedChart');
        if (varianceCtx) {
          destroyChart('varianceExplainedChart');
          new Chart(varianceCtx, {
            type: 'bar',
            data: {
              labels: ['Factor 1', 'Factor 2', 'Factor 3'],
              datasets: [{
                label: 'Variance Explained',
                data: [36.64, 13.48, 12.28],
                backgroundColor: [
                  'rgba(79, 70, 229, 0.8)',  // indigo
                  'rgba(236, 72, 153, 0.8)', // pink
                  'rgba(20, 184, 166, 0.8)'  // teal
                ],
                borderColor: [
                  'rgb(79, 70, 229)',
                  'rgb(236, 72, 153)',
                  'rgb(20, 184, 166)'
                ],
                borderWidth: 1,
                borderRadius: 6
              }, {
                type: 'line',
                label: 'Cumulative Variance',
                data: [36.64, 50.12, 62.40],
                borderColor: 'rgba(14, 165, 233, 1)',
                backgroundColor: 'rgba(14, 165, 233, 0.2)',
                pointBackgroundColor: 'rgba(14, 165, 233, 1)',
                pointBorderColor: '#ffffff',
                pointBorderWidth: 2,
                pointRadius: 6,
                pointHoverRadius: 8,
                fill: false,
                tension: 0.1,
                yAxisID: 'y1'
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              animation: {
                duration: 2000,
                easing: 'easeOutQuart'
              },
              interaction: {
                mode: 'index',
                intersect: false
              },
              plugins: {
                legend: {
                  position: 'top',
                  align: 'end',
                  labels: {
                    boxWidth: 15,
                    padding: 15,
                    usePointStyle: true
                  }
                },
                tooltip: {
                  backgroundColor: 'rgba(255, 255, 255, 0.95)',
                  titleColor: '#1a1a1a',
                  bodyColor: '#666666',
                  borderColor: '#e5e7eb',
                  borderWidth: 1,
                  padding: 12,
                  cornerRadius: 4,
                  callbacks: {
                    label: function(context) {
                      let label = context.dataset.label || '';
                      if (label) {
                        label += ': ';
                      }
                      label += context.parsed.y.toFixed(2) + '%';
                      return label;
                    }
                  }
                },
                datalabels: {
                  color: '#ffffff',
                  font: {
                    weight: '600',
                    size: 11
                  },
                  padding: 4,
                  formatter: (value) => value.toFixed(1) + '%'
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  max: 100,
                  position: 'left',
                  title: {
                    display: true,
                    text: 'Variance Explained (%)',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  },
                  grid: {
                    color: 'rgba(226, 232, 240, 0.6)',
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    callback: function(value) {
                      return value + '%';
                    },
                    font: {
                      size: 11
                    }
                  }
                },
                y1: {
                  beginAtZero: true,
                  max: 100,
                  position: 'right',
                  title: {
                    display: true,
                    text: 'Cumulative Variance (%)',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  },
                  grid: {
                    drawOnChartArea: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    callback: function(value) {
                      return value + '%';
                    },
                    font: {
                      size: 11
                    }
                  }
                },
                x: {
                  grid: {
                    display: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  }
                }
              }
            }
          });
        } else {
          console.log('Variance chart canvas not found');
        }
      }

      // Initialize charts
      initializeCharts();

      // Re-initialize charts when tab is clicked (in case they're in tabs)
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', function() {
          setTimeout(initializeCharts, 100);
        });
      });

            // Add download button to each chart container
      // Initialize chart download functionality
      function initChartDownload() {
        document.querySelectorAll('.chart-container').forEach(container => {
          const chartId = container.querySelector('canvas').id;
          
          // Add button to download chart as image
          const downloadBtn = document.createElement('button');
          downloadBtn.className = 'absolute top-2 right-2 bg-white/50 dark:bg-gray-800/50 hover:bg-white/80 dark:hover:bg-gray-800/80 p-1 rounded-full transition-all text-gray-600 dark:text-gray-300';
          downloadBtn.innerHTML = '<i class="fas fa-download"></i>';
          downloadBtn.title = 'Save chart as image';
          
          downloadBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            
            const canvas = document.getElementById(chartId);
            const link = document.createElement('a');
            link.download = `factor-analysis-${chartId}.png`;
            link.href = canvas.toDataURL('image/png');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Show confirmation
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 left-4 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-4 py-2 rounded shadow-lg z-50';
            toast.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Chart saved as image';
            document.body.appendChild(toast);
            setTimeout(() => {
              document.body.removeChild(toast);
            }, 3000);
          });
          
          // Add positioning to container if not already present
          container.style.position = 'relative';
          container.appendChild(downloadBtn);
        });
      }
      
      // Initialize chart download functionality
      initChartDownload();
    });
    
    // Add expanding card animation
    document.addEventListener('DOMContentLoaded', function() {
      const cards = document.querySelectorAll('.card');

      cards.forEach(card => {
        card.addEventListener('click', function() {
          this.classList.toggle('expanded');
        });
      });
    });
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <style>
    :root {
      --primary: #4361ee;
      --secondary: #3f37c9;
      --success: #4cc9f0;
      --info: #4895ef;
      --warning: #f72585;
      --danger: #e63946;
      --light: #f8f9fa;
      --dark: #212529;
    }
    
    :root.dark-mode {
      --primary: #6366f1;
      --secondary: #818cf8;
      --success: #22d3ee;
      --info: #67e8f9;
      --warning: #fb7185;
      --danger: #f43f5e;
      --light: #1f2937;
      --dark: #f9fafb;
      --bg-main: #0f172a;
      --bg-card: #1e293b;
      --text-primary: #f1f5f9;
      --text-secondary: #cbd5e1;
      --border-color: #334155;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg-main, #f0f2f5);
      color: var(--text-primary, #111827);
      line-height: 1.6;
      background-image: linear-gradient(135deg, var(--bg-main, #f5f7fa) 0%, var(--bg-card, #c3cfe2) 100%);
      min-height: 100vh;
      transition: background-color 0.3s ease, color 0.3s ease;
    }    .report-container {
      max-width: 1500px;
      min-height: 1200px; /* Added minimum height */
      margin: 2rem auto;
      background: var(--bg-card, white);
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      overflow: hidden;
      transform: translateY(0);
      transition: all 0.5s ease;
      animation: fadeInUp 0.8s ease-out;
    }
    
    @keyframes fadeInUp {
      from { 
        opacity: 0; 
        transform: translateY(30px);
      }
      to { 
        opacity: 1; 
        transform: translateY(0);
      }
    }
    
    .report-header {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      padding: 2.5rem 2rem;
      text-align: center;
      position: relative;
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }
    
    @keyframes gradientBG {
      0% { background-position: 0% 50% }
      50% { background-position: 100% 50% }
      100% { background-position: 0% 50% }
    }
    
    .report-header h1 {
      margin: 0;
      font-size: 2.2rem;
      font-weight: 700;
    }
    
    .report-header p {
      margin-top: 0.5rem;
      opacity: 0.9;
    }
      .stat-card {
      background: var(--bg-card, white);
      border-radius: 8px;
      padding: 1.2rem;
      margin: 1rem;
      transition: all 0.3s ease;
      border-left: 4px solid var(--primary);
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0,0,0,0.1);
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 0;
      background: linear-gradient(to top, rgba(var(--primary-rgb, 67, 97, 238), 0.1), transparent);
      transition: height 0.3s ease;
      z-index: -1;
    }
    
    .stat-card:hover::before {
      height: 100%;
    }
      .section-title {
      position: relative;
      cursor: pointer;
      padding: 1rem 1.5rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      background: var(--bg-card, #f8f9fa);
      border-radius: 8px;
      margin: 1rem 0;
      transition: all 0.3s ease;
      border-left: 4px solid var(--primary);
    }
    
    .section-title:hover {
      background: var(--bg-card, #edf2ff);
      transform: translateX(5px);
    }
    
    .dark-mode .section-title:hover {
      background: rgba(99, 102, 241, 0.15);
    }
    
    .section-title::after {
      content: "↓";
      margin-left: auto;
      transition: all 0.3s ease;
    }
    
    details[open] .section-title::after {
      transform: rotate(180deg);
    }
      .content-box {
      background: var(--bg-card, white);
      padding: 1.5rem;
      border-radius: 8px;
      margin-top: 0.5rem;
      animation: fadeIn 0.5s ease-in-out;
      transition: background-color 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      overflow: hidden;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    
    thead {
      background: linear-gradient(135deg, #e9ecef, #dee2e6);
    }
    
    th {
      padding: 1rem;
      text-align: left;
      font-weight: 600;
    }
    
    td {
      padding: 1rem;
      border-bottom: 1px solid #e9ecef;
    }
    
    tbody tr:hover {
      background-color: #f8f9fa;
    }
    
    .highlight {
      font-weight: 600;
      color: var(--primary);
    }
    
    .factor1 { background-color: rgba(67, 97, 238, 0.1); }
    .factor2 { background-color: rgba(247, 37, 133, 0.1); }
    .factor3 { background-color: rgba(76, 201, 240, 0.1); }
    
    .badge {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-right: 0.5rem;
      background: var(--primary);
      color: white;
    }
    
    .badge-success { background: #4cc9f0; }
    .badge-warning { background: #f72585; }
    .badge-info { background: #4895ef; }
    
    .tooltip {
      position: relative;
      cursor: help;
      border-bottom: 1px dotted #ccc;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    .progress-wrapper {
      height: 6px;
      width: 100%;
      background: #e9ecef;
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 5px;
    }
    
    .progress-bar {
      height: 100%;
      background: var(--primary);
    }
    
    .progress-bar.factor1 { background: var(--primary); }
    .progress-bar.factor2 { background: var(--warning); }
    .progress-bar.factor3 { background: var(--success); }
    
    .chart-container {
      position: relative;
      height: 300px;
      width: 100%;
      margin: 1.5rem 0;
    }
    
    .key-finding {
      padding: 1rem;
      background: linear-gradient(135deg, #f0f9ff, #e1f5fe);
      border-radius: 8px;
      border-left: 4px solid var(--info);
      margin: 1rem 0;
    }
    
    .loading-bar {
      height: 4px;
      width: 0%;
      background: linear-gradient(to right, var(--primary), var(--info));
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      animation: loading 2s ease forwards;
    }
    
    @keyframes loading {
      0% { width: 0%; }
      100% { width: 100%; }
    }
    
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }

    /* Factor Loadings Tabs Styles */
    .tabs {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      border-bottom: 1px solid #e5e7eb;
      padding-bottom: 0.5rem;
    }

    .tab {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      color: #6B7280;
      font-weight: 500;
      transition: all 0.2s ease;
      user-select: none;
    }

    .tab:hover {
      color: #4B5563;
    }

    .tab.active {
      color: #4F46E5;
      border-bottom-color: #4F46E5;
    }

    .tab-content {
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
      width: 100%;
    }

    .tab-content.active {
      display: block;
      opacity: 1;
    }

    /* Heatmap specific styles */
    #heatmap {
      width: 100%;
      min-height: 500px;
      padding: 1rem;
    }
    
    #heatmap .chart-container {
      background: white;
      border-radius: 0.5rem;
      padding: 1.5rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      width: 100%;
      height: 500px;
      position: relative;
    }
    
    #heatmapChart {
      width: 100% !important;
      height: 100% !important;
      touch-action: none;
    }
      .interactive-cell {
      transition: all 0.2s;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    .interactive-cell:hover {
      background-color: rgba(67, 97, 238, 0.1);
      transform: scale(1.02);
    }
    
    .interactive-cell:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary), var(--info));
      transition: width 0.3s ease;
    }
    
    .interactive-cell:hover:after {
      width: 100%;
    }
    
    .bold-value {
      font-weight: 700;
      color: #1a1a1a;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid #dee2e6;
      margin-bottom: 1rem;
    }
    
    .tab {
      padding: 0.75rem 1.25rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 2px solid transparent;
    }
    
    .tab.active {
      border-bottom: 2px solid var(--primary);
      font-weight: 600;
      color: var(--primary);
    }
      .tab-content {
      display: none;
      animation: fadeIn 0.5s;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .tab-content.active {
      display: block;
      opacity: 1;
    }
    
    .pulse-effect {
      animation: pulse 0.3s ease;
    }
      @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    /* Dark mode adjustments */
    .dark-mode .report-header {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
    }
    
    .dark-mode .tab.active {
      color: var(--primary);
      border-color: var(--primary);
    }
    
    .dark-mode th, .dark-mode td {
      color: var(--text-primary);
      border-color: var(--border-color);
    }
    
    .dark-mode .badge {
      background: var(--primary);
    }
    
    .dark-mode .badge-success { background: var(--success); }
    .dark-mode .badge-warning { background: var(--warning); }
    .dark-mode .badge-info { background: var(--info); }
    
    .dark-mode thead {
      background: linear-gradient(135deg, #334155, #1e293b);
    }
    
    .dark-mode .highlight {
      color: var(--primary);
    }
    
    /* Enhanced table styling */
    table {
      transition: all 0.3s ease;
    }
    
    .dark-mode table {
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    }
    
    /* Enhanced buttons */
    .action-button {
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .action-button::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%, -50%);
      transform-origin: 50% 50%;
    }
    
    .action-button:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }
    
    @keyframes ripple {
      0% { transform: scale(0, 0); opacity: 0.7; }
      20% { transform: scale(25, 25); opacity: 0.5; }
      100% { opacity: 0; transform: scale(40, 40); }
    }
    
    /* Button styling enhancements */
    #exportBtn, #shareBtn {
      position: relative !important;
      z-index: 100 !important;
      transition: all 0.3s ease !important;
      cursor: pointer !important;
      overflow: visible !important;
      transform: translateZ(0) !important;
      will-change: transform !important;
      box-shadow: 0 0 10px rgba(0,0,0,0.1) !important;
    }
    
    #exportBtn:hover, #shareBtn:hover {
      transform: translateY(-2px) !important;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2) !important;
    }
    
    .dark-mode #exportBtn {
      background-color: #4f46e5 !important;
      color: white !important;
      border: none !important;
    }
    
    .dark-mode #shareBtn {
      background-color: #3b82f6 !important;
      color: white !important;
      border: none !important;
    }
    
    .dark-mode #exportBtn i, .dark-mode #shareBtn i {
      color: white !important;
    }
    
    /* Enhanced chart tooltips */
    .enhanced-tooltip {
      background-color: rgba(0, 0, 0, 0.8) !important;
      border-radius: 6px !important;
      color: white !important;
      padding: 8px 12px !important;
      font-weight: 500 !important;
      font-size: 12px !important;
    }
  </style>
  
  <!-- Additional resources loaded asynchronously -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" media="print" onload="this.media='all'">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" media="print" onload="this.media='all'">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/gsap.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js" defer></script>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M11 3a8 8 0 00-8 8 8 8 0 008 8 8 8 0 008-8 8 8 0 00-8-8zm0 2a6 6 0 016 6 6 6 0 01-6 6 6 6 0 01-6-6 6 6 0 016-6zm3 3l-5 5-2-2-1 1 3 3 6-6-1-1z' fill='%234f46e5'/%3E%3C/svg%3E">
  
  <title>Factor Analysis Report</title>
  
  <!-- Font preloading for faster text rendering -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"></noscript>
  
  <!-- Defer non-critical JS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.1.0/dist/chartjs-plugin-annotation.min.js" defer></script>
  
  <!-- Critical CSS first, TailwindCSS after -->
  <style>
    /* Critical render path styles */
    :root {
      --primary: #4f46e5;
      --primary-dark: #4338ca;
      --secondary: #7e22ce;
      --accent: #2563eb;
      --text-main: #1f2937;
      --text-light: #6b7280;
      --light-bg: #f9fafb;
      --dark-bg: #111827;
    }
    
    /* Font optimization */
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      text-rendering: optimizeSpeed;
      scroll-behavior: smooth;
    }
    
    /* Loading indicator */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.3s ease-out;
    }
    
    .dark .loading-overlay {
      background-color: #1f2937;
    }
    
    .loader {
      width: 48px;
      height: 48px;
      border: 5px solid #ddd;
      border-bottom-color: var(--primary);
      border-radius: 50%;
      animation: rotate 1s linear infinite;
    }
    
    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Minimize layout shifts - set fixed height for elements that load dynamically */
    .chart-container {
      min-height: 300px;
      position: relative;
    }
    
    /* Add focus styles for accessibility */
    :focus-visible {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }
    
    /* Skip to content link for accessibility */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--primary);
      color: white;
      padding: 8px;
      z-index: 10000;
      transition: top 0.3s;
    }
    
    .skip-link:focus {
      top: 0;
    }
  </style>
  
  <!-- Tailwind after critical CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* New dataset information section animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes pulse-slow {
      0%, 100% { transform: scale(1); opacity: 0.8; }
      50% { transform: scale(1.05); opacity: 1; }
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    @keyframes badge-entrance {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .animate-fadeIn {
      animation: fadeIn 0.8s ease-in-out;
    }
    
    .animate-pulse-slow {
      animation: pulse-slow 4s infinite ease-in-out;
    }
    
    .animate-shimmer {
      animation: shimmer 3s infinite linear;
    }
    
    .shadow-glow {
      box-shadow: 0 0 15px rgba(99, 102, 241, 0.3);
    }
    
    .slide-in-right {
      animation: slide-in-right 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
    }
    
    @keyframes slide-in-right {
      0% { transform: translateX(-20px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    
    .badge-animation {
      animation: badge-entrance 0.5s ease-out forwards;
    }
    
    .pulse-animation {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
      100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
    }
    
    .dataset-info-card {
      transition: all 0.3s ease;
    }
    
    .dataset-info-card:hover {
      transform: translateY(-5px);
    }
    
    .data-pattern-overlay {
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M54.627 0l.83.828-1.415 1.415L51.8 0h2.827zM5.373 0l-.83.828L5.96 2.243 8.2 0H5.374zM48.97 0l3.657 3.657-1.414 1.414L46.143 0h2.828zM11.03 0L7.372 3.657 8.787 5.07 13.857 0H11.03zm32.284 0L49.8 6.485 48.384 7.9l-7.9-7.9h2.83zM16.686 0L10.2 6.485 11.616 7.9l7.9-7.9h-2.83zm20.97 0l9.315 9.314-1.414 1.414L34.828 0h2.83zM22.344 0L13.03 9.314l1.414 1.414L25.172 0h-2.83zM32 0l12.142 12.142-1.414 1.414L30 2.828 17.272 15.556l-1.414-1.414L28 0h4zM.284 0l28 28-1.414 1.414L0 2.544V0h.284zM0 5.373l25.456 25.455-1.414 1.415L0 8.2V5.374zm0 5.656l22.627 22.627-1.414 1.414L0 13.86v-2.83zm0 5.656l19.8 19.8-1.415 1.413L0 19.514v-2.83zm0 5.657l16.97 16.97-1.414 1.415L0 25.172v-2.83zM0 28l14.142 14.142-1.414 1.414L0 30.828V28zm0 5.657L11.314 44.97l-1.414 1.415L0 36.485v-2.83zm0 5.657L8.485 47.8l-1.414 1.414L0 42.143v-2.83zm0 5.657l5.657 5.657-1.414 1.415L0 47.8v-2.83zm0 5.657l2.828 2.83-1.414 1.413L0 53.456v-2.83zM54.627 60L30 35.373 5.373 60H8.2L30 38.2 51.8 60h2.827zm-5.656 0L30 41.03 11.03 60h2.828L30 43.858 46.142 60h2.83zm-5.656 0L30 46.686 16.686 60h2.83L30 49.515 40.485 60h2.83zm-5.657 0L30 52.343 22.344 60h2.83L30 55.172 34.828 60h2.83zM32 60l-2-2-2 2h4zM59.716 0l-28 28 1.414 1.414L60 2.544V0h-.284zM60 5.373L34.544 30.828l1.414 1.415L60 8.2V5.374zm0 5.656L37.373 33.656l1.414 1.414L60 13.86v-2.83zm0 5.656l-19.8 19.8 1.415 1.413L60 19.514v-2.83zm0 5.657l-16.97 16.97 1.414 1.415L60 25.172v-2.83zM60 28L45.858 42.142l1.414 1.414L60 30.828V28zm0 5.657L48.686 44.97l1.414 1.415L60 36.485v-2.83zm0 5.657L51.515 47.8l1.414 1.414L60 42.143v-2.83zm0 5.657l-5.657 5.657 1.414 1.415L60 47.8v-2.83zm0 5.657l-2.828 2.83 1.414 1.413L60 53.456v-2.83zM39.9 16.385l1.414-1.414L30 3.658 18.686 14.97l1.415 1.415 9.9-9.9 9.9 9.9zm-2.83 2.828l1.415-1.414L30 9.313 21.515 17.8l1.414 1.413L30 11.8l7.07 7.07z' fill='%23ffffff' fill-opacity='0.03' fill-rule='evenodd'/%3E%3C/svg%3E");
      opacity: 0.5;
    }
    
    /* Counter animation */
    .count-animation .counter {
      display: inline-block;
      position: relative;
    }
  </style>
  <script>
    // Preload critical resources for better performance
    document.addEventListener('DOMContentLoaded', function() {
      // Add Font Awesome asynchronously to prevent render blocking
      const fontAwesome = document.createElement('link');
      fontAwesome.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css';
      fontAwesome.rel = 'stylesheet';
      document.head.appendChild(fontAwesome);
      
      // Add custom scrollbar styles for better UX
      const scrollbarStyle = document.createElement('style');
      scrollbarStyle.textContent = `
        .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: transparent; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(156, 163, 175, 0.5); border-radius: 3px; }
        .dark .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(75, 85, 99, 0.5); }
      `;
      document.head.appendChild(scrollbarStyle);
      
      // Hide loading overlay when content is ready
      setTimeout(() => {
        const loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
          loadingOverlay.style.opacity = '0';
          setTimeout(() => {
            loadingOverlay.style.display = 'none';
          }, 300);
        }
      }, 800);
    });
    
    // Wait for Chart.js to load
    window.addEventListener('load', function() {
      // Register the plugins globally if Chart is available
      if (typeof Chart !== 'undefined') {
        Chart.register(ChartDataLabels);
        
        // Initialize all charts
        initializeCharts();
      } else {
        console.warn('Chart.js not loaded yet. Charts will be initialized when ready.');
        // Try again in a moment
        setTimeout(() => {
          if (typeof Chart !== 'undefined') {
            Chart.register(ChartDataLabels);
            initializeCharts();
          }
        }, 1000);
      }
      
      // Initialize counter animations
      document.querySelectorAll('.count-animation').forEach(counter => {
        const targetValue = parseInt(counter.getAttribute('data-value'));
        const counterElement = counter.querySelector('.counter');
        const duration = 1500; // Animation duration in milliseconds
        const steps = 30; // Number of steps in animation
        const stepTime = duration / steps;
        const increment = targetValue / steps;
        let currentValue = 0;
        
        const counterInterval = setInterval(() => {
          currentValue += increment;
          if (currentValue >= targetValue) {
            currentValue = targetValue;
            clearInterval(counterInterval);
          }
          counterElement.textContent = Math.round(currentValue);
        }, stepTime);
      });
      
      // Add animations for dataset variable items with staggered delay
      document.querySelectorAll('.variable-item').forEach((item, index) => {
        // Add staggered animation delay
        item.style.opacity = '0';
        item.style.transform = 'translateX(-20px)';
        item.style.transition = 'all 0.3s ease-out';
        
        setTimeout(() => {
          item.style.opacity = '1';
          item.style.transform = 'translateX(0)';
        }, 100 + (index * 50)); // Staggered delay
        
        // Add hover effect for icons
        const icon = item.querySelector('.variable-icon');
        if (icon) {
          item.addEventListener('mouseenter', () => {
            icon.style.transform = 'scale(1.2) rotate(5deg)';
            icon.style.transition = 'transform 0.3s ease-out';
          });
          
          item.addEventListener('mouseleave', () => {
            icon.style.transform = 'scale(1) rotate(0)';
          });
        }
      });
      
      // Add glow effect to buttons
      document.querySelectorAll('.btn-glow').forEach(btn => {
        btn.addEventListener('mouseenter', () => {
          btn.style.boxShadow = '0 0 15px rgba(59, 130, 246, 0.5)';
        });
        
        btn.addEventListener('mouseleave', () => {
          btn.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.1)';
        });
      });
      
      // Add animation for the dataset info card
      const datasetCard = document.querySelector('.dataset-info-card');
      if (datasetCard) {
        // Apply initial animation
        datasetCard.classList.add('animate-fadeIn');
        
        // Add parallax effect on mouse move
        datasetCard.addEventListener('mousemove', (e) => {
          const card = e.currentTarget;
          const rect = card.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          
          const moveX = (x - centerX) / 30;
          const moveY = (y - centerY) / 30;
          
          // Apply subtle transform
          card.style.transform = `perspective(1000px) rotateX(${-moveY}deg) rotateY(${moveX}deg) scale3d(1.02, 1.02, 1.02)`;
        });
        
        // Reset transform on mouse leave
        datasetCard.addEventListener('mouseleave', (e) => {
          e.currentTarget.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)';
        });
      }
      
      // Function to destroy existing chart if it exists
      function destroyChart(chartId) {
        const existingChart = Chart.getChart(chartId);
        if (existingChart) {
          existingChart.destroy();
        }
      }

      // Function to create charts
      function initializeCharts() {
                  // Scree Plot
        const screeCtx = document.getElementById('screePlot');
        if (screeCtx) {
          destroyChart('screePlot');
          const screePlot = new Chart(screeCtx.getContext('2d'), {
            type: 'line',
            data: {
              labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
              datasets: [{
                label: 'Eigenvalues',
                data: [3.298, 1.214, 1.196, 0.85, 0.75, 0.65, 0.45, 0.32, 0.28],
                borderColor: 'rgb(59, 130, 246)', // bright blue
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                pointBackgroundColor: 'rgb(59, 130, 246)',
                pointBorderColor: '#fff',
                pointBorderWidth: 2,
                pointRadius: 5,
                pointHoverRadius: 7,
                fill: true,
                tension: 0.4,
                borderWidth: 2
              }, {
                label: 'Kaiser Criterion (Eigenvalue=1)',
                data: [1, 1, 1, 1, 1, 1, 1, 1, 1],
                borderColor: 'rgba(244, 63, 94, 0.6)', // light red
                borderDash: [5, 5],
                pointRadius: 0,
                fill: false,
                borderWidth: 2
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: 'bottom',
                  align: 'start',
                  labels: {
                    usePointStyle: true,
                    padding: 10,
                    boxWidth: 10,
                    boxHeight: 10,
                    font: {
                      size: 11
                    }
                  }
                },
                tooltip: {
                  backgroundColor: 'rgba(255, 255, 255, 0.95)',
                  titleColor: '#1a1a1a',
                  bodyColor: '#666666',
                  borderColor: '#e5e7eb',
                  borderWidth: 1,
                  padding: 10,
                  cornerRadius: 4,
                  displayColors: true,
                  callbacks: {
                    label: function(context) {
                      if (context.dataset.label === 'Eigenvalues') {
                        return `Eigenvalues: ${context.parsed.y.toFixed(3)}`;
                      }
                      return `Kaiser Criterion: ${context.parsed.y.toFixed(3)}`;
                    }
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  max: 3.5,
                  grid: {
                    color: 'rgba(226, 232, 240, 0.6)',
                    drawBorder: false
                  },
                  ticks: {
                    stepSize: 0.5,
                    padding: 8,
                    font: {
                      size: 11
                    }
                  },
                  title: {
                    display: true,
                    text: 'Eigenvalue',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  }
                },
                x: {
                  grid: {
                    display: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  },
                  title: {
                    display: true,
                    text: 'Factor Number',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {top: 10}
                  }
                }
              }
            }
          });
        } else {
          console.log('Scree plot canvas not found');
        }

                  // Communalities Chart
        const communalitiesCtx = document.getElementById('communalitiesChart');
        if (communalitiesCtx) {
          destroyChart('communalitiesChart');
          new Chart(communalitiesCtx, {
            type: 'bar',
            data: {
              labels: ['climate', 'housing', 'health', 'crime', 'trans', 'educate', 'arts', 'recreate', 'econ'],
              datasets: [{
                label: 'Communality',
                data: [0.795, 0.518, 0.722, 0.512, 0.510, 0.561, 0.754, 0.517, 0.728],
                backgroundColor: [
                  'rgba(16, 185, 129, 0.8)',  // emerald
                  'rgba(99, 102, 241, 0.8)',  // indigo
                  'rgba(20, 184, 166, 0.8)',  // teal
                  'rgba(249, 115, 22, 0.8)',  // orange
                  'rgba(59, 130, 246, 0.8)',  // blue
                  'rgba(236, 72, 153, 0.8)',  // pink
                  'rgba(16, 185, 129, 0.8)',  // emerald
                  'rgba(139, 92, 246, 0.8)',  // violet
                  'rgba(34, 197, 94, 0.8)'    // green
                ],
                borderWidth: 1,
                borderRadius: 6,
                borderColor: [
                  'rgb(16, 185, 129)',
                  'rgb(99, 102, 241)',
                  'rgb(20, 184, 166)',
                  'rgb(249, 115, 22)',
                  'rgb(59, 130, 246)',
                  'rgb(236, 72, 153)',
                  'rgb(16, 185, 129)',
                  'rgb(139, 92, 246)',
                  'rgb(34, 197, 94)'
                ]
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              animation: {
                duration: 2000,
                easing: 'easeOutQuart'
              },
              plugins: {
                legend: {
                  display: false
                },
                tooltip: {
                  backgroundColor: 'rgba(255, 255, 255, 0.95)',
                  titleColor: '#1a1a1a',
                  bodyColor: '#666666',
                  borderColor: '#e5e7eb',
                  borderWidth: 1,
                  padding: 12,
                  cornerRadius: 4,
                  callbacks: {
                    label: function(context) {
                      const value = context.raw;
                      let interpretation = value > 0.7 ? 'Excellent' : value > 0.5 ? 'Good' : 'Fair';
                      return [`Value: ${value.toFixed(3)}`, `Interpretation: ${interpretation}`];
                    }
                  }
                },
                datalabels: {
                  color: '#ffffff',
                  font: {
                    weight: '600',
                    size: 11
                  },
                  padding: 4,
                  formatter: (value) => value.toFixed(3)
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  max: 1,
                  title: {
                    display: true,
                    text: 'Communality Value',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  },
                  grid: {
                    color: 'rgba(226, 232, 240, 0.6)',
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  }
                },
                x: {
                  grid: {
                    display: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  }
                }
              }
            }
          });
        } else {
          console.log('Communalities chart canvas not found');
        }

                  // Variance Distribution Chart
        const varianceCtx = document.getElementById('varianceExplainedChart');
        if (varianceCtx) {
          destroyChart('varianceExplainedChart');
          new Chart(varianceCtx, {
            type: 'bar',
            data: {
              labels: ['Factor 1', 'Factor 2', 'Factor 3'],
              datasets: [{
                label: 'Variance Explained',
                data: [36.64, 13.48, 12.28],
                backgroundColor: [
                  'rgba(79, 70, 229, 0.8)',  // indigo
                  'rgba(236, 72, 153, 0.8)', // pink
                  'rgba(20, 184, 166, 0.8)'  // teal
                ],
                borderColor: [
                  'rgb(79, 70, 229)',
                  'rgb(236, 72, 153)',
                  'rgb(20, 184, 166)'
                ],
                borderWidth: 1,
                borderRadius: 6
              }, {
                type: 'line',
                label: 'Cumulative Variance',
                data: [36.64, 50.12, 62.40],
                borderColor: 'rgba(14, 165, 233, 1)',
                backgroundColor: 'rgba(14, 165, 233, 0.2)',
                pointBackgroundColor: 'rgba(14, 165, 233, 1)',
                pointBorderColor: '#ffffff',
                pointBorderWidth: 2,
                pointRadius: 6,
                pointHoverRadius: 8,
                fill: false,
                tension: 0.1,
                yAxisID: 'y1'
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              animation: {
                duration: 2000,
                easing: 'easeOutQuart'
              },
              interaction: {
                mode: 'index',
                intersect: false
              },
              plugins: {
                legend: {
                  position: 'top',
                  align: 'end',
                  labels: {
                    boxWidth: 15,
                    padding: 15,
                    usePointStyle: true
                  }
                },
                tooltip: {
                  backgroundColor: 'rgba(255, 255, 255, 0.95)',
                  titleColor: '#1a1a1a',
                  bodyColor: '#666666',
                  borderColor: '#e5e7eb',
                  borderWidth: 1,
                  padding: 12,
                  cornerRadius: 4,
                  callbacks: {
                    label: function(context) {
                      let label = context.dataset.label || '';
                      if (label) {
                        label += ': ';
                      }
                      label += context.parsed.y.toFixed(2) + '%';
                      return label;
                    }
                  }
                },
                datalabels: {
                  color: '#ffffff',
                  font: {
                    weight: '600',
                    size: 11
                  },
                  padding: 4,
                  formatter: (value) => value.toFixed(1) + '%'
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  max: 100,
                  position: 'left',
                  title: {
                    display: true,
                    text: 'Variance Explained (%)',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  },
                  grid: {
                    color: 'rgba(226, 232, 240, 0.6)',
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    callback: function(value) {
                      return value + '%';
                    },
                    font: {
                      size: 11
                    }
                  }
                },
                y1: {
                  beginAtZero: true,
                  max: 100,
                  position: 'right',
                  title: {
                    display: true,
                    text: 'Cumulative Variance (%)',
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    padding: {bottom: 10}
                  },
                  grid: {
                    drawOnChartArea: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    callback: function(value) {
                      return value + '%';
                    },
                    font: {
                      size: 11
                    }
                  }
                },
                x: {
                  grid: {
                    display: false,
                    drawBorder: false
                  },
                  ticks: {
                    padding: 8,
                    font: {
                      size: 11
                    }
                  }
                }
              }
            }
          });
        } else {
          console.log('Variance chart canvas not found');
        }
      }

      // Initialize charts
      initializeCharts();

      // Re-initialize charts when tab is clicked (in case they're in tabs)
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', function() {
          setTimeout(initializeCharts, 100);
        });
      });

            // Add download button to each chart container
      // Initialize chart download functionality
      function initChartDownload() {
        document.querySelectorAll('.chart-container').forEach(container => {
          const chartId = container.querySelector('canvas').id;
          
          // Add button to download chart as image
          const downloadBtn = document.createElement('button');
          downloadBtn.className = 'absolute top-2 right-2 bg-white/50 dark:bg-gray-800/50 hover:bg-white/80 dark:hover:bg-gray-800/80 p-1 rounded-full transition-all text-gray-600 dark:text-gray-300';
          downloadBtn.innerHTML = '<i class="fas fa-download"></i>';
          downloadBtn.title = 'Save chart as image';
          
          downloadBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            
            const canvas = document.getElementById(chartId);
            const link = document.createElement('a');
            link.download = `factor-analysis-${chartId}.png`;
            link.href = canvas.toDataURL('image/png');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Show confirmation
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 left-4 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-4 py-2 rounded shadow-lg z-50';
            toast.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Chart saved as image';
            document.body.appendChild(toast);
            setTimeout(() => {
              document.body.removeChild(toast);
            }, 3000);
          });
          
          // Add positioning to container if not already present
          container.style.position = 'relative';
          container.appendChild(downloadBtn);
        });
      }
      
      // Initialize chart download functionality
      initChartDownload();
    });
    
    // Add expanding card animation
    document.addEventListener('DOMContentLoaded', function() {
      const cards = document.querySelectorAll('.card');

      cards.forEach(card => {
        card.addEventListener('click', function() {
          this.classList.toggle('expanded');
        });
      });
    });
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <style>
    :root {
      --primary: #4361ee;
      --secondary: #3f37c9;
      --success: #4cc9f0;
      --info: #4895ef;
      --warning: #f72585;
      --danger: #e63946;
      --light: #f8f9fa;
      --dark: #212529;
    }
    
    :root.dark-mode {
      --primary: #6366f1;
      --secondary: #818cf8;
      --success: #22d3ee;
      --info: #67e8f9;
      --warning: #fb7185;
      --danger: #f43f5e;
      --light: #1f2937;
      --dark: #f9fafb;
      --bg-main: #0f172a;
      --bg-card: #1e293b;
      --text-primary: #f1f5f9;
      --text-secondary: #cbd5e1;
      --border-color: #334155;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg-main, #f0f2f5);
      color: var(--text-primary, #111827);
      line-height: 1.6;
      background-image: linear-gradient(135deg, var(--bg-main, #f5f7fa) 0%, var(--bg-card, #c3cfe2) 100%);
      min-height: 100vh;
      transition: background-color 0.3s ease, color 0.3s ease;
    }    .report-container {
      max-width: 1500px;
      min-height: 1200px; /* Added minimum height */
      margin: 2rem auto;
      background: var(--bg-card, white);
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      overflow: hidden;
      transform: translateY(0);
      transition: all 0.5s ease;
      animation: fadeInUp 0.8s ease-out;
    }
    
    @keyframes fadeInUp {
      from { 
        opacity: 0; 
        transform: translateY(30px);
      }
      to { 
        opacity: 1; 
        transform: translateY(0);
      }
    }
    
    .report-header {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      padding: 2.5rem 2rem;
      text-align: center;
      position: relative;
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }
    
    @keyframes gradientBG {
      0% { background-position: 0% 50% }
      50% { background-position: 100% 50% }
      100% { background-position: 0% 50% }
    }
    
    .report-header h1 {
      margin: 0;
      font-size: 2.2rem;
      font-weight: 700;
    }
    
    .report-header p {
      margin-top: 0.5rem;
      opacity: 0.9;
    }
      .stat-card {
      background: var(--bg-card, white);
      border-radius: 8px;
      padding: 1.2rem;
      margin: 1rem;
      transition: all 0.3s ease;
      border-left: 4px solid var(--primary);
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      position: relative;
      overflow: hidden;
      z-index: 1;
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0,0,0,0.1);
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 0;
      background: linear-gradient(to top, rgba(var(--primary-rgb, 67, 97, 238), 0.1), transparent);
      transition: height 0.3s ease;
      z-index: -1;
    }
    
    .stat-card:hover::before {
      height: 100%;
    }
      .section-title {
      position: relative;
      cursor: pointer;
      padding: 1rem 1.5rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      background: var(--bg-card, #f8f9fa);
      border-radius: 8px;
      margin: 1rem 0;
      transition: all 0.3s ease;
      border-left: 4px solid var(--primary);
    }
    
    .section-title:hover {
      background: var(--bg-card, #edf2ff);
      transform: translateX(5px);
    }
    
    .dark-mode .section-title:hover {
      background: rgba(99, 102, 241, 0.15);
    }
    
    .section-title::after {
      content: "↓";
      margin-left: auto;
      transition: all 0.3s ease;
    }
    
    details[open] .section-title::after {
      transform: rotate(180deg);
    }
      .content-box {
      background: var(--bg-card, white);
      padding: 1.5rem;
      border-radius: 8px;
      margin-top: 0.5rem;
      animation: fadeIn 0.5s ease-in-out;
      transition: background-color 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      overflow: hidden;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    
    thead {
      background: linear-gradient(135deg, #e9ecef, #dee2e6);
    }
    
    th {
      padding: 1rem;
      text-align: left;
      font-weight: 600;
    }
    
    td {
      padding: 1rem;
      border-bottom: 1px solid #e9ecef;
    }
    
    tbody tr:hover {
      background-color: #f8f9fa;
    }
    
    .highlight {
      font-weight: 600;
      color: var(--primary);
    }
    
    .factor1 { background-color: rgba(67, 97, 238, 0.1); }
    .factor2 { background-color: rgba(247, 37, 133, 0.1); }
    .factor3 { background-color: rgba(76, 201, 240, 0.1); }
    
    .badge {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-right: 0.5rem;
      background: var(--primary);
      color: white;
    }
    
    .badge-success { background: #4cc9f0; }
    .badge-warning { background: #f72585; }
    .badge-info { background: #4895ef; }
    
    .tooltip {
      position: relative;
      cursor: help;
      border-bottom: 1px dotted #ccc;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    .progress-wrapper {
      height: 6px;
      width: 100%;
      background: #e9ecef;
      border-radius: 3px;
      overflow: hidden;
      margin-bottom: 5px;
    }
    
    .progress-bar {
      height: 100%;
      background: var(--primary);
    }
    
    .progress-bar.factor1 { background: var(--primary); }
    .progress-bar.factor2 { background: var(--warning); }
    .progress-bar.factor3 { background: var(--success); }
    
    .chart-container {
      position: relative;
      height: 300px;
      width: 100%;
      margin: 1.5rem 0;
    }
    
    .key-finding {
      padding: 1rem;
      background: linear-gradient(135deg, #f0f9ff, #e1f5fe);
      border-radius: 8px;
      border-left: 4px solid var(--info);
      margin: 1rem 0;
    }
    
    .loading-bar {
      height: 4px;
      width: 0%;
      background: linear-gradient(to right, var(--primary), var(--info));
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
      animation: loading 2s ease forwards;
    }
    
    @keyframes loading {
      0% { width: 0%; }
      100% { width: 100%; }
    }
    
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }

    /* Factor Loadings Tabs Styles */
    .tabs {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      border-bottom: 1px solid #e5e7eb;
      padding-bottom: 0.5rem;
    }

    .tab {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      color: #6B7280;
      font-weight: 500;
      transition: all 0.2s ease;
      user-select: none;
    }

    .tab:hover {
      color: #4B5563;
    }

    .tab.active {
      color: #4F46E5;
      border-bottom-color: #4F46E5;
    }

    .tab-content {
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
      width: 100%;
    }

    .tab-content.active {
      display: block;
      opacity: 1;
    }

    /* Heatmap specific styles */
    #heatmap {
      width: 100%;
      min-height: 500px;
      padding: 1rem;
    }
    
    #heatmap .chart-container {
      background: white;
      border-radius: 0.5rem;
      padding: 1.5rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      width: 100%;
      height: 500px;
      position: relative;
    }
    
    #heatmapChart {
      width: 100% !important;
      height: 100% !important;
      touch-action: none;
    }
      .interactive-cell {
      transition: all 0.2s;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    .interactive-cell:hover {
      background-color: rgba(67, 97, 238, 0.1);
      transform: scale(1.02);
    }
    
    .interactive-cell:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary), var(--info));
      transition: width 0.3s ease;
    }
    
    .interactive-cell:hover:after {
      width: 100%;
    }
    
    .bold-value {
      font-weight: 700;
      color: #1a1a1a;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid #dee2e6;
      margin-bottom: 1rem;
    }
    
    .tab {
      padding: 0.75rem 1.25rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 2px solid transparent;
    }
    
    .tab.active {
      border-bottom: 2px solid var(--primary);
      font-weight: 600;
      color: var(--primary);
    }
      .tab-content {
      display: none;
      animation: fadeIn 0.5s;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .tab-content.active {
      display: block;
      opacity: 1;
    }
    
    .pulse-effect {
      animation: pulse 0.3s ease;
    }
      @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    /* Dark mode adjustments */
    .dark-mode .report-header {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
    }
    
    .dark-mode .tab.active {
      color: var(--primary);
      border-color: var(--primary);
    }
    
    .dark-mode th, .dark-mode td {
      color: var(--text-primary);
      border-color: var(--border-color);
    }
    
    .dark-mode .badge {
      background: var(--primary);
    }
    
    .dark-mode .badge-success { background: var(--success); }
    .dark-mode .badge-warning { background: var(--warning); }
    .dark-mode .badge-info { background: var(--info); }
    
    .dark-mode thead {
      background: linear-gradient(135deg, #334155, #1e293b);
    }
    
    .dark-mode .highlight {
      color: var(--primary);
    }
    
    /* Enhanced table styling */
    table {
      transition: all 0.3s ease;
    }
    
    .dark-mode table {
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
    }
    
    /* Enhanced buttons */
    .action-button {
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .action-button::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 5px;
      height: 5px;
      background: rgba(255, 255, 255, 0.5);
      opacity: 0;
      border-radius: 100%;
      transform: scale(1, 1) translate(-50%, -50%);
      transform-origin: 50% 50%;
    }
    
    .action-button:focus:not(:active)::after {
      animation: ripple 1s ease-out;
    }
    
    @keyframes ripple {
      0% { transform: scale(0, 0); opacity: 0.7; }
      20% { transform: scale(25, 25); opacity: 0.5; }
      100% { opacity: 0; transform: scale(40, 40); }
    }
    
    /* Button styling enhancements */
    #exportBtn, #shareBtn {
      position: relative !important;
      z-index: 100 !important;
      transition: all 0.3s ease !important;
      cursor: pointer !important;
      overflow: visible !important;
      transform: translateZ(0) !important;
      will-change: transform !important;
      box-shadow: 0 0 10px rgba(0,0,0,0.1) !important;
    }
    
    #exportBtn:hover, #shareBtn:hover {
      transform: translateY(-2px) !important;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2) !important;
    }
    
    .dark-mode #exportBtn {
      background-color: #4f46e5 !important;
      color: white !important;
      border: none !important;
    }
    
    .dark-mode #shareBtn {
      background-color: #3b82f6 !important;
      color: white !important;
      border: none !important;
    }
    
    .dark-mode #exportBtn i, .dark-mode #shareBtn i {
      color: white !important;
    }
    
    /* Enhanced chart tooltips */
    .enhanced-tooltip {
      background-color: rgba(0, 0, 0, 0.8) !important;
      border-radius: 6px !important;
      color: white !important;
      padding: 8px 12px !important;
      font-weight: 500 !important;
      font-size: 12px !important;
    }
    
    /* Print styles for export */
    @media print {
      body {
        background: white !important;
        color: black !important;
      }
      
      .report-container {
        box-shadow: none !important;
        margin: 0 !important;
      }
      
      nav, .no-print {
        display: none !important;
      }
    }

    /* Enhanced Animations and Effects */
    .floating {
      animation: floating 3s ease-in-out infinite;
    }

    @keyframes floating {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }

    /* Glass Card Effect */
    .glass-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    }

    /* Neon Glow Effect */
    .neon-glow {
      box-shadow: 0 0 5px var(--primary),
                  0 0 25px var(--primary),
                  0 0 50px var(--primary),
                  0 0 100px var(--primary);
    }

    /* Interactive Hover Effects */
    .hover-lift {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .hover-lift:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }

    /* Gradient Text */
    .gradient-text {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Progress Bar Animation */
    .progress-bar {
      position: relative;
      overflow: hidden;
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 30px;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      animation: progress-shine 1.5s infinite;
    }

    @keyframes progress-shine {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(400%); }
    }

    /* Ripple Effect */
    .ripple {
      position: relative;
      overflow: hidden;
    }

    .ripple::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      pointer-events: none;
      background-image: radial-gradient(circle, #fff 10%, transparent 10.01%);
      background-repeat: no-repeat;
      background-position: 50%;
      transform: scale(10, 10);
      opacity: 0;
      transition: transform .5s, opacity 1s;
    }

    .ripple:active::after {
      transform: scale(0, 0);
      opacity: .3;
      transition: 0s;
    }
    
    @keyframes progress-pulse {
      0% { transform: scaleY(1); }
      50% { transform: scaleY(1.2); }
      100% { transform: scaleY(1); }
    }
    
    .progress-pulse {
      animation: progress-pulse 0.5s ease;
    }
    
    .factor-tooltip {
      position: fixed;
      z-index: 9999;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      padding: 12px;
      max-width: 280px;
      pointer-events: none;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s, transform 0.3s;
    }
    
    .factor-tooltip.show {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>
  <!-- Loading overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loader"></div>
  </div>
  
  <!-- Accessibility: Skip to content link -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <div class="loading-bar"></div>
    <nav class="fixed top-0 left-0 right-0 bg-white/90 dark:bg-gray-900/90 backdrop-blur-md shadow-sm py-2 px-6 flex items-center justify-between z-50 transition-all">
    <div class="flex items-center">
 
    </div>
    <div class="flex items-center space-x-4">
      <button id="datasetBtn" class="action-button px-3 py-1 rounded-full bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-200 text-sm font-medium hover:bg-green-200 dark:hover:bg-green-800 transition-all flex items-center">
        <i class="fas fa-table mr-1"></i> View Dataset
      </button>
      <button id="notebookBtn" class="action-button px-3 py-1 rounded-full bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-200 text-sm font-medium hover:bg-purple-200 dark:hover:bg-purple-800 transition-all flex items-center">
        <i class="fab fa-python mr-1"></i> Jupyter Notebook
      </button>
      <button id="exportBtn" onclick="handleExport()" class="action-button px-3 py-1 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-200 text-sm font-medium hover:bg-indigo-200 dark:hover:bg-indigo-800 transition-all flex items-center">
        <i class="fas fa-download mr-1"></i> Export
      </button>
      <button id="shareBtn" onclick="handleShare()" class="action-button px-3 py-1 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 text-sm font-medium hover:bg-blue-200 dark:hover:bg-blue-800 transition-all flex items-center">
        <i class="fas fa-share-alt mr-1"></i> Share
      </button>
    </div>
  </nav>
  
  <!-- Jupyter Notebook Modal -->
  <div id="notebookModal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
    <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm" id="notebookOverlay"></div>
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-11/12 max-w-7xl max-h-[95vh] flex flex-col relative z-10 transform transition-all scale-95 opacity-0" id="notebookContent">
      <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800 rounded-t-xl z-10">
        <div>
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
            <i class="fab fa-python mr-2 text-purple-500"></i>
            Jupyter Notebook: Factor Analysis
          </h3>
          <p class="text-sm text-gray-500 dark:text-gray-400">
            Source: <a href="https://github.com/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="text-blue-500 hover:underline">GitHub Repository</a>
          </p>
        </div>
        <div class="flex items-center gap-2">
          <a href="https://colab.research.google.com/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="px-3 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-200 rounded-md hover:bg-yellow-200 dark:hover:bg-yellow-800 transition-colors flex items-center text-sm">
            <i class="fab fa-google mr-1"></i> Open in Colab
          </a>
          <a href="https://github.com/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center text-sm">
            <i class="fab fa-github mr-1"></i> View Raw
          </a>
          <button id="notebookCloseBtn" class="ml-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
      </div>
      
             <div class="flex-grow relative overflow-hidden" style="min-height: 80vh;">
        <!-- First option: GitHub embedded view -->
        <iframe 
          id="notebookIframe"
          src="https://nbviewer.jupyter.org/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" 
          class="absolute inset-0 w-full h-full"
          frameborder="0" 
          allowfullscreen>
        </iframe>
        
        <!-- Fallback message if iframe doesn't load -->
        <div id="iframeLoadingIndicator" class="absolute inset-0 flex flex-col items-center justify-center bg-white dark:bg-gray-800 p-8">
          <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-purple-500 mb-4"></div>
          <p class="text-gray-600 dark:text-gray-300 mb-4">Loading Jupyter notebook...</p>
          <div class="flex flex-col space-y-2">
            <p class="text-sm text-gray-500 dark:text-gray-400">This may take a few moments. If it doesn't load:</p>
            <div class="flex flex-wrap gap-2 justify-center mt-4">
              <a href="https://nbviewer.jupyter.org/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors flex items-center text-sm">
                <i class="fas fa-external-link-alt mr-2"></i> View in NBViewer
              </a>
              <a href="https://colab.research.google.com/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="px-3 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-md transition-colors flex items-center text-sm">
                <i class="fab fa-google mr-2"></i> Open in Colab
              </a>
              <a href="https://github.com/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md transition-colors flex items-center text-sm">
                <i class="fab fa-github mr-2"></i> View on GitHub
              </a>
            </div>
            <p class="mt-2 text-xs text-gray-500 italic">Note: Sometimes embedded Jupyter notebooks can be slow to load</p>
          </div>
        </div>
      </div>
      
      <div class="p-4 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center">
                 <div class="flex space-x-3">
          <button id="viewNBViewer" class="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 rounded-md hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors flex items-center text-sm">
            <i class="fas fa-sync-alt mr-2"></i> Try NBViewer
          </button>
          <button id="viewGitHubRender" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center text-sm">
            <i class="fas fa-sync-alt mr-2"></i> Try Alternative Viewer
          </button>
          <a href="https://colab.research.google.com/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="px-3 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-200 rounded-md hover:bg-yellow-200 dark:hover:bg-yellow-800 transition-colors flex items-center text-sm">
            <i class="fab fa-google mr-2"></i> Open in Colab
          </a>
        </div>
        <div>
          <span class="text-sm text-gray-500 dark:text-gray-400">Having trouble viewing? <a href="https://github.com/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="text-blue-500 hover:underline">Open on GitHub</a></span>
        </div>
      </div>
      
      <script>
        // Notebook viewer functionality
        document.addEventListener('DOMContentLoaded', function() {
          const iframe = document.getElementById('notebookIframe');
          const loadingIndicator = document.getElementById('iframeLoadingIndicator');
          const viewNBViewerBtn = document.getElementById('viewNBViewer');
          const viewGitHubRenderBtn = document.getElementById('viewGitHubRender');
          
          // URLs for different rendering options
          const nbviewerUrl = "https://nbviewer.jupyter.org/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb";
          const colabUrl = "https://colab.research.google.com/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb";
          const githubRawUrl = "https://github.com/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb";
          
          console.log('Initializing notebook viewer with iframe:', iframe);
          
          // When iframe loads
          if (iframe && loadingIndicator) {
            iframe.onload = function() {
              console.log('Notebook iframe loaded');
              loadingIndicator.classList.add('hidden');
            };
            
            // Error handling for iframe
            iframe.onerror = function() {
              console.error('Notebook iframe failed to load');
              loadingIndicator.innerHTML = `
                <div class="text-center p-6">
                  <div class="text-red-500 text-xl mb-4"><i class="fas fa-exclamation-circle"></i> Failed to load notebook</div>
                  <p class="text-gray-700 dark:text-gray-300 mb-4">Please try one of these alternative viewing options:</p>
                  <div class="flex space-x-4 justify-center">
                    <a href="${nbviewerUrl}" target="_blank" class="px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors flex items-center text-sm">
                      <i class="fas fa-external-link-alt mr-2"></i> Open in NBViewer
                    </a>
                    <a href="${colabUrl}" target="_blank" class="px-3 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-md transition-colors flex items-center text-sm">
                      <i class="fab fa-google mr-2"></i> Open in Colab
                    </a>
                  </div>
                </div>
              `;
            };
            
            // Fallback in case onload doesn't fire
            setTimeout(function() {
              if (!loadingIndicator.classList.contains('hidden')) {
                console.log('Hiding loading indicator after timeout');
                loadingIndicator.classList.add('hidden');
              }
            }, 10000);
          }
          
                     // Switch to NBViewer
           if (viewNBViewerBtn) {
             viewNBViewerBtn.addEventListener('click', function() {
               console.log('Switching to NBViewer');
               loadingIndicator.classList.remove('hidden');
               iframe.src = nbviewerUrl;
               
               // Update button states
               viewNBViewerBtn.className = "px-3 py-1 bg-blue-500 text-white rounded-md transition-colors flex items-center text-sm";
               viewGitHubRenderBtn.className = "px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center text-sm";
             });
           }
           
           // Try a different approach with direct rendering
           if (viewGitHubRenderBtn) {
             viewGitHubRenderBtn.addEventListener('click', function() {
               console.log('Switching to alternative renderer');
               loadingIndicator.classList.remove('hidden');
               
               try {
                 // Try Google Colaboratory's preview embed (may work better for some users)
                 const alternativeUrl = `https://nbviewer.jupyter.org/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb?flush_cache=true`;
                 console.log('Loading alternative URL:', alternativeUrl);
                 iframe.src = alternativeUrl;
                 
                 // Update button states
                 viewGitHubRenderBtn.className = "px-3 py-1 bg-gray-500 text-white rounded-md transition-colors flex items-center text-sm";
                 viewNBViewerBtn.className = "px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200 rounded-md hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors flex items-center text-sm";
               } catch (e) {
                 console.error('Error loading alternative viewer:', e);
                 alert('Could not load alternative viewer. Please try opening directly in Colab using the button provided.');
               }
             });
           }
        });
      </script>
    </div>
  </div>
  
  <!-- Dataset Viewer Modal -->
  <div id="datasetModal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
    <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm" id="datasetOverlay"></div>
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-11/12 max-w-6xl max-h-[90vh] flex flex-col relative z-10 transform transition-all scale-95 opacity-0" id="datasetContent">
      <div class="p-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800 rounded-t-xl z-10">
        <div>
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white flex items-center">
            <i class="fas fa-database mr-2 text-green-500"></i>
            Dataset: Factor Analysis Data
          </h3>
          <p class="text-sm text-gray-500 dark:text-gray-400">
            Source: <a href="https://github.com/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/FA1/places_tf.csv" target="_blank" class="text-blue-500 hover:underline">GitHub Repository</a>
          </p>
        </div>
        <div class="flex items-center gap-2">
          <div class="relative">
            <input 
              type="text" 
              id="datasetSearch" 
              placeholder="Search data..." 
              class="pl-8 pr-4 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-sm focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400"
            >
            <i class="fas fa-search absolute left-3 top-2 text-gray-400"></i>
          </div>
          <button id="datasetDownloadBtn" class="px-3 py-1 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-200 rounded-md hover:bg-green-200 dark:hover:bg-green-800 transition-colors flex items-center text-sm">
            <i class="fas fa-download mr-1"></i> CSV
          </button>
          <button id="datasetCloseBtn" class="ml-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
      </div>
      
      <div class="p-5 overflow-auto flex-grow relative">
        <!-- Loading indicator -->
        <div id="datasetLoader" class="absolute inset-0 flex flex-col items-center justify-center bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm z-10">
          <div class="w-16 h-16 border-4 border-t-blue-500 border-blue-200 rounded-full animate-spin mb-4"></div>
          <p class="text-gray-600 dark:text-gray-300">Loading dataset...</p>
        </div>
        
        <!-- Error message -->
        <div id="datasetError" class="hidden flex flex-col items-center justify-center py-10 text-center">
          <div class="bg-red-100 dark:bg-red-900/30 p-4 rounded-lg max-w-md">
            <i class="fas fa-exclamation-triangle text-red-500 text-3xl mb-3"></i>
            <h4 class="text-lg font-semibold text-red-700 dark:text-red-400 mb-2">Failed to load dataset</h4>
            <p class="text-gray-600 dark:text-gray-300 mb-4" id="errorMessage">Unable to retrieve the dataset from GitHub.</p>
            <button id="retryBtn" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md transition-colors">
              Try Again
            </button>
          </div>
        </div>
        
        <!-- Dataset view tabs -->
        <div id="datasetView" class="hidden">
          <div class="border-b border-gray-200 dark:border-gray-700 mb-4">
            <ul class="flex -mb-px">
              <li class="mr-2">
                <button id="summaryTabBtn" class="inline-block py-2 px-4 text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400 font-medium text-sm focus:outline-none">
                  Data Summary
                </button>
              </li>
              <li class="mr-2">
                <button id="tableTabBtn" class="inline-block py-2 px-4 text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 font-medium text-sm border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700 focus:outline-none">
                  Data Table
                </button>
              </li>
            </ul>
          </div>
          
          <!-- Data Summary Tab -->
          <div id="dataSummaryTab">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <!-- Dataset Overview -->
              <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                <div class="bg-indigo-50 dark:bg-indigo-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                  <h3 class="font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                    <i class="fas fa-info-circle mr-2 text-indigo-600 dark:text-indigo-400"></i>
                    Dataset Overview
                  </h3>
                </div>
                <div class="p-4">
                  <div class="grid grid-cols-2 gap-4">
                    <div class="bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg">
                      <div class="text-sm text-gray-500 dark:text-gray-400">Total Rows</div>
                      <div class="font-bold text-lg text-indigo-600 dark:text-indigo-400" id="summaryTotalRows">-</div>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg">
                      <div class="text-sm text-gray-500 dark:text-gray-400">Total Columns</div>
                      <div class="font-bold text-lg text-indigo-600 dark:text-indigo-400" id="summaryTotalCols">-</div>
                    </div>
                  </div>
                  
                  <!-- Sample Records -->
                  <div class="mt-4">
                    <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Sample Records</h4>
                    <div class="overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700" id="sampleRecordsTable">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                          <tr id="sampleTableHeader"></tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="sampleTableBody"></tbody>
                      </table>
                    </div>
                    <div class="text-xs text-gray-500 dark:text-gray-400 mt-1">Showing first 5 records</div>
                  </div>
                </div>
              </div>
              
              <!-- Variable Information -->
              <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                <div class="bg-blue-50 dark:bg-blue-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                  <h3 class="font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                    <i class="fas fa-table mr-2 text-blue-600 dark:text-blue-400"></i>
                    Variable Information
                  </h3>
                </div>
                <div class="p-4">
                  <div class="overflow-x-auto border border-gray-200 dark:border-gray-700 rounded-lg">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                      <thead class="bg-gray-50 dark:bg-gray-700">
                        <tr>
                          <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Variable
                          </th>
                          <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Type
                          </th>
                          <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                            Non-Null
                          </th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="variableInfoBody">
                        <!-- Variable info will be populated here -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
              
              <!-- Data Quality -->
              <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                <div class="bg-amber-50 dark:bg-amber-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                  <h3 class="font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                    <i class="fas fa-check-circle mr-2 text-amber-600 dark:text-amber-400"></i>
                    Data Quality Check
                  </h3>
                </div>
                <div class="p-4">
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg">
                      <div class="text-sm text-gray-500 dark:text-gray-400">Missing Values</div>
                      <div class="font-bold text-lg text-amber-600 dark:text-amber-400" id="summaryMissingValues">-</div>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg">
                      <div class="text-sm text-gray-500 dark:text-gray-400">Duplicate Rows</div>
                      <div class="font-bold text-lg text-amber-600 dark:text-amber-400" id="summaryDuplicates">-</div>
                    </div>
                    <div class="bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg">
                      <div class="text-sm text-gray-500 dark:text-gray-400">Potential Outliers</div>
                      <div class="font-bold text-lg text-amber-600 dark:text-amber-400" id="summaryOutliers">-</div>
                    </div>
                  </div>
                  
                  <!-- Missing Values Details -->
                  <div class="mt-4">
                    <h4 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Missing Values by Column</h4>
                    <div class="overflow-x-auto max-h-40 border border-gray-200 dark:border-gray-700 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-700 sticky top-0">
                          <tr>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Column</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Missing Count</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Percentage</th>
                          </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="missingValuesBody">
                          <!-- Missing values will be populated here -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Basic Statistics -->
              <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
                <div class="bg-green-50 dark:bg-green-900/20 px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                  <h3 class="font-semibold text-gray-800 dark:text-gray-200 flex items-center">
                    <i class="fas fa-chart-bar mr-2 text-green-600 dark:text-green-400"></i>
                    Basic Statistics
                  </h3>
                </div>
                <div class="p-4">
                  <!-- Statistics Tabs -->
                  <div class="border-b border-gray-200 dark:border-gray-700 mb-3">
                    <ul class="flex -mb-px">
                      <li class="mr-2">
                        <button id="numericalStatsBtn" class="inline-block py-2 px-4 text-green-600 dark:text-green-400 border-b-2 border-green-600 dark:border-green-400 font-medium text-sm focus:outline-none">
                          Numerical
                        </button>
                      </li>
                      <li class="mr-2">
                        <button id="categoricalStatsBtn" class="inline-block py-2 px-4 text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 font-medium text-sm border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700 focus:outline-none">
                          Categorical
                        </button>
                      </li>
                    </ul>
                  </div>
                  
                  <!-- Numerical Stats Tab -->
                  <div id="numericalStatsTab">
                    <div class="overflow-x-auto max-h-64 border border-gray-200 dark:border-gray-700 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-700 sticky top-0">
                          <tr>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Variable</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Mean</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Median</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Std</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Min</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Max</th>
                          </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="numericalStatsBody">
                          <!-- Numerical statistics will be populated here -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                  
                  <!-- Categorical Stats Tab -->
                  <div id="categoricalStatsTab" class="hidden">
                    <div class="overflow-x-auto max-h-64 border border-gray-200 dark:border-gray-700 rounded-lg">
                      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead class="bg-gray-50 dark:bg-gray-700 sticky top-0">
                          <tr>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Variable</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Unique Values</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Most Common</th>
                            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Frequency</th>
                          </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="categoricalStatsBody">
                          <!-- Categorical statistics will be populated here -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Data Table Tab -->
          <div id="dataTableTab" class="hidden">
            <div id="datasetTableContainer">
          <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-4 flex gap-4 flex-wrap">
            <div>
              <span class="font-semibold text-gray-700 dark:text-gray-300">Rows:</span>
              <span id="dataRowCount" class="ml-1 text-blue-700 dark:text-blue-300">0</span>
            </div>
            <div>
              <span class="font-semibold text-gray-700 dark:text-gray-300">Columns:</span>
              <span id="dataColCount" class="ml-1 text-blue-700 dark:text-blue-300">0</span>
            </div>
            <div class="ml-auto flex gap-2">
              <select id="dataPageSize" class="bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-sm px-2 py-1">
                <option value="10">10 rows</option>
                <option value="25" selected>25 rows</option>
                <option value="50">50 rows</option>
                <option value="100">100 rows</option>
                <option value="all">All rows</option>
              </select>
            </div>
          </div>
          
          <div class="overflow-x-auto">
            <table id="datasetTable" class="w-full border-collapse">
              <thead>
                <tr id="tableHeader" class="bg-gray-100 dark:bg-gray-700 text-left">
                  <!-- Table headers will be inserted here dynamically -->
                </tr>
              </thead>
              <tbody id="tableBody">
                <!-- Table rows will be inserted here dynamically -->
              </tbody>
            </table>
          </div>
          
          <!-- Pagination controls -->
          <div id="paginationControls" class="flex items-center justify-between mt-4 flex-wrap gap-2">
            <div class="flex items-center gap-1">
              <button id="prevPageBtn" class="px-3 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fas fa-chevron-left"></i>
              </button>
              <span class="mx-2 text-sm">
                Page <span id="currentPage">1</span> of <span id="totalPages">1</span>
              </span>
              <button id="nextPageBtn" class="px-3 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
            <div class="text-sm text-gray-500 dark:text-gray-400">
              Showing <span id="startRow">1</span>-<span id="endRow">25</span> of <span id="totalRows">0</span> rows
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="pt-12"></div>
  
   <!-- Main Navigation Tabs -->
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-6" id="main-content">
     <nav class="main-navigation flex border-b border-gray-200 dark:border-gray-700 overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-700" role="tablist" aria-label="Main content sections">
       <button id="datasetTabBtn" class="main-tab-btn active px-6 py-3 font-medium text-lg border-b-2 border-indigo-500 text-indigo-600 dark:text-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" role="tab" aria-selected="true" aria-controls="datasetTabContent">
         <i class="fas fa-database mr-2" aria-hidden="true"></i> Dataset
       </button>
       <button id="codeTabBtn" class="main-tab-btn px-6 py-3 font-medium text-lg border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" role="tab" aria-selected="false" aria-controls="codeTabContent">
         <i class="fas fa-code mr-2" aria-hidden="true"></i> Code
       </button>
       <button id="mathExplanationTabBtn" class="main-tab-btn px-6 py-3 font-medium text-lg border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" role="tab" aria-selected="false" aria-controls="mathExplanationTabContent">
         <i class="fas fa-square-root-alt mr-2" aria-hidden="true"></i> Mathematical Explanation
       </button>
       <button id="reportTabBtn" class="main-tab-btn px-6 py-3 font-medium text-lg border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" role="tab" aria-selected="false" aria-controls="reportTabContent">
         <i class="fas fa-file-alt mr-2" aria-hidden="true"></i> Report
       </button>
     </nav>
   </div>
   
   <!-- Dataset Tab Content -->
   <div id="datasetTabContent" class="main-tab-content" role="tabpanel" aria-labelledby="datasetTabBtn">
     <!-- Heading Information Section -->
     <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-4">
       <div class="dataset-info-card bg-gradient-to-br from-blue-700 via-purple-700 to-indigo-800 rounded-lg shadow-2xl overflow-hidden relative animate-fadeIn">
         <!-- Animated background elements -->
         <div class="absolute inset-0 overflow-hidden">
           <div class="absolute top-0 right-0 w-64 h-64 bg-blue-400/20 rounded-full filter blur-3xl animate-pulse-slow"></div>
           <div class="absolute bottom-0 left-0 w-72 h-72 bg-purple-400/20 rounded-full filter blur-3xl animate-pulse-slow" style="animation-delay: 1.5s"></div>
           <div class="absolute top-1/2 left-1/4 w-40 h-40 bg-indigo-400/20 rounded-full filter blur-3xl animate-pulse-slow" style="animation-delay: 0.8s"></div>
         </div>
         
         <!-- Animated data pattern overlay -->
         <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/20 data-pattern-overlay"></div>
       
         <div class="px-6 py-5 flex items-center justify-between relative z-10">
           <div class="flex items-center transform hover:scale-105 transition-transform duration-300">
             <div class="bg-white/20 p-3 rounded-lg mr-5 shadow-glow pulse-animation">
               <i class="fas fa-database text-white text-2xl"></i>
             </div>
             <div class="slide-in-right">
               <h1 class="text-xl font-bold text-white">Dataset Information</h1>
               <p class="text-indigo-100">Exploring Quality of Life Variables for Factor Analysis</p>
             </div>
           </div>
           <div class="bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2 hidden sm:block hover:bg-white/15 transition-all duration-300 transform hover:scale-105 shadow-glow">
             <div class="flex space-x-4 text-white text-sm">
               <div class="flex flex-col items-center count-animation" data-value="329">
                 <span class="font-bold text-xl counter">329</span>
                 <span class="text-xs text-indigo-200">Observations</span>
               </div>
               <div class="w-px bg-white/20"></div>
               <div class="flex flex-col items-center count-animation" data-value="9">
                 <span class="font-bold text-xl counter">10</span>
                 <span class="text-xs text-indigo-200">Variables</span>
               </div>
               <div class="w-px bg-white/20"></div>

             </div>
           </div>
         </div>
         
         <!-- Information Pills -->
         <div class="bg-indigo-900/40 backdrop-blur-sm px-6 py-3 flex flex-wrap gap-2 relative z-10">
           <div class="bg-white/10 px-3 py-1 rounded-full text-xs text-white flex items-center transform hover:scale-110 transition-all hover:bg-green-500/30 cursor-pointer badge-animation">
             <i class="fas fa-check-circle text-green-400 mr-1"></i> No Missing Values
           </div>
           <div class="bg-white/10 px-3 py-1 rounded-full text-xs text-white flex items-center transform hover:scale-110 transition-all hover:bg-blue-500/30 cursor-pointer badge-animation" style="animation-delay: 0.2s">
             <i class="fas fa-calculator mr-1"></i> Irrelevant Variable: id
           </div>
           <div class="bg-white/10 px-3 py-1 rounded-full text-xs text-white flex items-center transform hover:scale-110 transition-all hover:bg-purple-500/30 cursor-pointer badge-animation" style="animation-delay: 0.4s">
             <i class="fas fa-percentage mr-1"></i> No Categorical Variables
           </div>
   
         </div>
         
         <!-- Animated border glow -->
         <div class="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-blue-400/70 to-transparent animate-shimmer"></div>
       </div>
     </div>
     
     <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
       <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden">
         <div class="p-6 border-b border-gray-200 dark:border-gray-700">
           <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Factor Analysis Dataset</h2>
           <p class="mt-2 text-gray-600 dark:text-gray-300">The analysis uses the places dataset with 10 (one irrelevant variable wil be dropped) variables measuring various quality of life aspects across 329 locations.</p>
         </div>
         
         <div class="p-6">
           <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
             <!-- Dataset Statistics -->
             <div class="stat-card bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 border border-gray-100 dark:border-gray-700 relative overflow-hidden group">
               <div class="absolute inset-0 bg-blue-500/5 dark:bg-blue-400/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
               <div class="absolute -bottom-2 -right-2 w-24 h-24 bg-blue-400/10 dark:bg-blue-500/10 rounded-full filter blur-xl group-hover:scale-150 transition-transform duration-700"></div>
               
               <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center">
                 <i class="fas fa-chart-bar text-blue-500 mr-2"></i>
                 Dataset Overview
               </h3>
               <ul class="space-y-3 text-gray-600 dark:text-gray-300 relative z-10">
                 <li class="flex items-center transform transition-transform duration-300 hover:translate-x-2">
                   <div class="w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/40 flex items-center justify-center mr-3 text-blue-500">
                     <i class="fas fa-table"></i>
                   </div>
                   <span><span class="font-medium">Observations:</span> 329</span>
                 </li>
                 <li class="flex items-center transform transition-transform duration-300 hover:translate-x-2">
                   <div class="w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/40 flex items-center justify-center mr-3 text-purple-500">
                     <i class="fas fa-columns"></i>
                   </div>
                   <span><span class="font-medium">Variables:</span> 10</span>
                 </li>
                 <li class="flex items-center transform transition-transform duration-300 hover:translate-x-2">
                   <div class="w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/40 flex items-center justify-center mr-3 text-green-500">
                     <i class="fas fa-check-circle"></i>
                   </div>
                   <span><span class="font-medium">Missing Values:</span> None</span>
                 </li>
               </ul>
             </div>
             
             <!-- Variables List -->
             <div class="stat-card bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 border border-gray-100 dark:border-gray-700 relative overflow-hidden group">
               <div class="absolute inset-0 bg-purple-500/5 dark:bg-purple-400/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
               <div class="absolute -top-2 -left-2 w-24 h-24 bg-purple-400/10 dark:bg-purple-500/10 rounded-full filter blur-xl group-hover:scale-150 transition-transform duration-700"></div>
               
               <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center">
                 <i class="fas fa-list-ul text-purple-500 mr-2"></i>
                 Variables
               </h3>
               <ul class="space-y-1 text-gray-600 dark:text-gray-300 relative z-10 variable-list">
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-blue-500 mr-2"><i class="fas fa-cloud-sun"></i></span> climate - Climate quality
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-green-500 mr-2"><i class="fas fa-home"></i></span> housing - Housing quality
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-red-500 mr-2"><i class="fas fa-heartbeat"></i></span> health - Health services
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-orange-500 mr-2"><i class="fas fa-shield-alt"></i></span> crime - Crime rate
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-indigo-500 mr-2"><i class="fas fa-bus"></i></span> trans - Transportation
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-purple-500 mr-2"><i class="fas fa-graduation-cap"></i></span> educate - Education quality
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-pink-500 mr-2"><i class="fas fa-palette"></i></span> arts - Arts opportunities
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-teal-500 mr-2"><i class="fas fa-hiking"></i></span> recreate - Recreation
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors">
                   <span class="variable-icon text-yellow-500 mr-2"><i class="fas fa-chart-line"></i></span> econ - Economic conditions
                 </li>
                 <li class="variable-item flex items-center py-1 px-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors opacity-50">
                   <span class="variable-icon text-gray-500 mr-2"><i class="fas fa-id-card"></i></span> id - Irrelevant variable
                 </li>
               </ul>
             </div>
             
             <!-- Dataset Source -->
             <div class="stat-card bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 p-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 border border-gray-100 dark:border-gray-700 relative overflow-hidden group">
               <div class="absolute inset-0 bg-green-500/5 dark:bg-green-400/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
               <div class="absolute -bottom-2 -right-2 w-24 h-24 bg-green-400/10 dark:bg-green-500/10 rounded-full filter blur-xl group-hover:scale-150 transition-transform duration-700"></div>
               
               <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center">
                 <i class="fas fa-database text-green-500 mr-2"></i>
                 Source & Access
               </h3>
               <p class="text-gray-600 dark:text-gray-300 mb-4 relative z-10">The dataset contains ratings of various quality-of-life aspects for different places.</p>
               <div class="flex flex-col sm:flex-row gap-3 relative z-10">
                 <button id="viewDatasetBtn" class="btn-glow px-4 py-3 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white rounded-lg transition-all duration-300 flex items-center justify-center text-sm shadow-md hover:shadow-lg">
                   <i class="fas fa-table mr-2"></i> View Dataset
                 </button>
                 <a href="https://github.com/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/FA1/places_tf.csv" target="_blank" class="btn-glow px-4 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg transition-all duration-300 flex items-center justify-center text-sm shadow-md hover:shadow-lg">
                   <i class="fab fa-github mr-2"></i> Source on GitHub
                 </a>
               </div>
             </div>
           </div>
         </div>
             </div>
    </div>
    
    <!-- Footer for Dataset Tab -->
    <footer class="bg-gradient-to-br from-gray-900 via-purple-950 to-indigo-900 text-white py-12 mt-12 relative overflow-hidden">
      <!-- Animated background elements -->
      <div class="absolute inset-0 overflow-hidden">
        <div class="particles-js absolute inset-0 opacity-20" id="dataset-footer-particles"></div>
        <div class="absolute top-0 right-0 w-96 h-96 bg-blue-500/10 rounded-full filter blur-3xl animate-pulse-slow"></div>
        <div class="absolute bottom-0 left-0 w-96 h-96 bg-purple-500/10 rounded-full filter blur-3xl animate-pulse-slow" style="animation-delay: 2s"></div>
      </div>
      
      <!-- Border glow top -->
      <div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-purple-500/50 to-transparent"></div>
      
      <!-- Content container -->
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
          <!-- About Creator Section - Enhanced with 3D card -->
          <div class="space-y-4 perspective">
            <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-300">
              <i class="fas fa-user-circle mr-3 text-purple-400"></i>
              About Aditto Ahosan Kabbo
            </h3>
            <p class="text-gray-300 text-sm leading-relaxed">Data Enthusiast and Statistics Student at Pabna University of Science and Technology. Passionate about transforming raw data into actionable insights.</p>
            
            <!-- 3D interactive profile card -->
            <div class="profile-card bg-gradient-to-br from-purple-900/60 to-indigo-900/60 backdrop-blur-lg rounded-xl p-6 mt-4 border border-white/10 shadow-xl transform transition-all duration-500 hover:shadow-purple-500/20 group relative">
              <!-- Card tilt effect - JS will be added later -->
              <div class="absolute inset-0 bg-gradient-to-br from-purple-500/5 to-blue-500/5 opacity-0 group-hover:opacity-100 rounded-xl transition-opacity"></div>
              
              <!-- Animated profile picture -->
              <div class="relative w-32 h-32 mx-auto mb-5 rounded-full overflow-hidden profile-pic-container perspective">
                <div class="profile-pic-inner transform transition-all duration-700">
                  <img src="https://raw.githubusercontent.com/AdittoAhosanKabbo/AdittoAhosanKabbo/main/Assets/20221031_113233-removebg.png" 
                      alt="Aditto Ahosan Kabbo" 
                      class="w-full h-full object-cover rounded-full border-2 border-purple-400/70 shadow-lg"
                      onerror="this.src='https://avatars.githubusercontent.com/u/AdittoAhosanKabbo'"
                      style="aspect-ratio: 1/1; object-fit: cover; object-position: center top;">
                </div>
                
                <!-- Glowing ring animation -->
                <div class="absolute inset-0 border-2 border-transparent rounded-full animate-spin-slow opacity-0 group-hover:opacity-100" style="background: linear-gradient(45deg, transparent, rgba(147, 51, 234, 0.3), transparent); animation-duration: 3s;"></div>
              </div>
              
              <!-- Animated title with typewriter effect -->
              <div class="text-center h-6 mb-2">
                <span class="inline-block font-medium text-purple-300 typewriter-container overflow-hidden whitespace-nowrap" data-typing="🎓 Statistics Student,💻 Data Enthusiast,📊 Skilled in Visualization ">🎓 Statistics Student</span>
              </div>
              
              <!-- Interactive buttons that appear on hover -->
              <div class="mt-4 flex justify-center space-x-3 opacity-0 group-hover:opacity-100 transition-opacity">
                <button class="btn-glow px-3 py-1 rounded-full bg-purple-600/30 hover:bg-purple-600/50 text-xs font-medium border border-purple-500/30 transition-all flex items-center" onclick="window.open('https://github.com/AdittoAhosanKabbo', '_blank')">
                  <i class="fab fa-github mr-1"></i> GitHub
                </button>
                <button class="btn-glow px-3 py-1 rounded-full bg-blue-600/30 hover:bg-blue-600/50 text-xs font-medium border border-blue-500/30 transition-all flex items-center" onclick="window.open('https://www.linkedin.com/in/adittoahosankabbo/', '_blank')">
                  <i class="fab fa-linkedin mr-1"></i> LinkedIn
                </button>
              </div>
            </div>
          </div>
          
          <!-- Enhanced Connect with me - Interactive 3D social links -->
          <div class="space-y-5">
            <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300">
              <i class="fas fa-link mr-3 text-blue-400"></i>
              Connect with me
            </h3>
            <ul class="space-y-3 text-gray-300">
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-linkedin text-blue-400 w-6"></i>
                <a href="https://www.linkedin.com/in/adittoahosankabbo/" target="_blank" class="ml-2 hover:underline">LinkedIn</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-github text-gray-400 w-6"></i>
                <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="ml-2 hover:underline">GitHub</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-facebook text-blue-500 w-6"></i>
                <a href="https://www.facebook.com/Adittoahosan" target="_blank" class="ml-2 hover:underline">Facebook</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-kaggle text-cyan-500 w-6"></i>
                <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="ml-2 hover:underline">Kaggle</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="far fa-envelope text-red-400 w-6"></i>
                <a href="mailto:adittoahosankabbo@gmail.com" class="ml-2 hover:underline">adittoahosankabbo@gmail.com</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-whatsapp text-green-400 w-6"></i>
                <a href="https://wa.me/8801749018051?text=hello" target="_blank" class="ml-2 hover:underline">WhatsApp</a>
              </li>
            </ul>
          </div>
          
          <!-- Skills & Project Links -->
          <div class="space-y-4">
            <h3 class="text-xl font-bold flex items-center">
              <i class="fas fa-laptop-code mr-2 text-green-400"></i>
              Skills & Projects
            </h3>
            <div class="grid grid-cols-2 gap-2 mb-4">
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fab fa-python text-xl text-blue-400"></i>
                <p class="text-xs mt-1">Python</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-database text-xl text-blue-500"></i>
                <p class="text-xs mt-1">SQL</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fab fa-r-project text-xl text-blue-300"></i>
                <p class="text-xs mt-1">R</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-table text-xl text-green-400"></i>
                <p class="text-xs mt-1">Excel</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-chart-bar text-xl text-purple-400"></i>
                <p class="text-xs mt-1">Power BI</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-chart-line text-xl text-purple-300"></i>
                <p class="text-xs mt-1">SPSS</p>
              </div>
            </div>
            <p class="text-gray-300 text-sm">View more data analysis and statistics projects on my GitHub and Kaggle profiles.</p>
            <div class="mt-4">
              <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:from-purple-700 hover:to-indigo-700 transition-all inline-flex items-center">
                <i class="fab fa-github mr-2"></i> View GitHub Projects
              </a>
            </div>
          </div>
        </div>
        
        <div class="mt-8 pt-6 border-t border-white/10 flex flex-col md:flex-row justify-between items-center">
          <p class="text-gray-400 text-sm">© 2025 Aditto Ahosan Kabbo. All rights reserved.</p>
          <div class="flex space-x-4 mt-4 md:mt-0">
            <a href="https://www.hackerrank.com/profile/aditahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-hackerrank"></i>
            </a>
            <a href="https://www.reddit.com/user/AhosanKabbo/" target="_blank" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-reddit-alien"></i>
            </a>
            <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-kaggle"></i>
            </a>
          </div>
        </div>
      </div>
      
      <!-- Footer particles container -->
      <div id="dataset-footer-particles-js" class="absolute inset-0 opacity-20"></div>
    </footer>
  </div>
   
  <!-- Code Tab Content -->
   <div id="codeTabContent" class="main-tab-content hidden">
     <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
       <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden">
         <div class="p-6 border-b border-gray-200 dark:border-gray-700">
           <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Factor Analysis Implementation</h2>
           <p class="mt-2 text-gray-600 dark:text-gray-300">Python code implementation of Factor Analysis using scikit-learn and other libraries.</p>
         </div>
         
         <div class="p-6">
           <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
             <!-- Notebook Info -->
             <div class="lg:col-span-1">
               <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200">Jupyter Notebook</h3>
               <p class="text-gray-600 dark:text-gray-300 mb-4">The analysis was performed using Python with libraries including pandas, numpy, scikit-learn, factor_analyzer and seaborn,matplotlib for visualization. The implementation includes:</p>
               <ul class="list-disc pl-5 space-y-1 text-gray-600 dark:text-gray-300 mb-6">
                 <li>Data Loading and Preprocessing</li>
                 <li>Adequacy Test</li>
                 <li>Tuning No of Factor (Eigen Value & Scree Plot)</li>
                 <li>Factor Analaysis & Model Fitting </li>
                 <li>Principal Component Method and Rotation techniques (None used)</li>
                 <li>Factor interpretation (Communality & variance Explained)</li>
                 <li>Factor Score Calculation</li>
               </ul>
               <div class="flex space-x-3">
                 <button id="openNotebookModal" class="px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-md transition-colors flex items-center text-sm">
                   <i class="fab fa-python mr-2"></i> View Notebook
                 </button>
                 <a href="https://colab.research.google.com/github/AdittoAhosanKabbo/Dimension_Reduction/blob/main/Factor%20_Analaysis/Pythonipynbfile/Factor_Analaysis_(placedata_tf).ipynb" target="_blank" class="px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-md transition-colors flex items-center text-sm">
                   <i class="fab fa-google mr-2"></i> Open in Colab
                 </a>
               </div>
             </div>
             
             <!-- Learning Resources -->
             <div class="lg:col-span-1">
               <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200">Learning Resources</h3>
               <p class="text-gray-600 dark:text-gray-300 mb-4">Explore these valuable resources to deepen your understanding of Factor Analysis and its applications:</p>
               <div class="space-y-3 text-gray-600 dark:text-gray-300">
                 <a href="https://online.stat.psu.edu/stat505/book/export/html/691" target="_blank" class="flex items-center p-3 bg-white/10 dark:bg-gray-800/50 hover:bg-white/20 dark:hover:bg-gray-700/70 rounded-lg transition-colors">
                   <div class="mr-3 flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full">
                     <i class="fas fa-university text-blue-500 dark:text-blue-400"></i>
                   </div>
                   <div>
                     <h4 class="font-medium text-gray-800 dark:text-gray-200">Penn State University</h4>
                     <p class="text-xs text-gray-500 dark:text-gray-400">Comprehensive academic explanation of Factor Analysis theory</p>
                   </div>
                 </a>
                 
                 <a href="https://www.geeksforgeeks.org/introduction-to-factor-analytics/" target="_blank" class="flex items-center p-3 bg-white/10 dark:bg-gray-800/50 hover:bg-white/20 dark:hover:bg-gray-700/70 rounded-lg transition-colors">
                   <div class="mr-3 flex-shrink-0 bg-green-100 dark:bg-green-900/30 p-2 rounded-full">
                     <i class="fas fa-code text-green-500 dark:text-green-400"></i>
                   </div>
                   <div>
                     <h4 class="font-medium text-gray-800 dark:text-gray-200">GeeksforGeeks</h4>
                     <p class="text-xs text-gray-500 dark:text-gray-400">Practical introduction to Factor Analytics concepts</p>
                   </div>
                 </a>
                 
                 <a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.FactorAnalysis.html" target="_blank" class="flex items-center p-3 bg-white/10 dark:bg-gray-800/50 hover:bg-white/20 dark:hover:bg-gray-700/70 rounded-lg transition-colors">
                   <div class="mr-3 flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 p-2 rounded-full">
                     <i class="fab fa-python text-yellow-500 dark:text-yellow-400"></i>
                   </div>
                   <div>
                     <h4 class="font-medium text-gray-800 dark:text-gray-200">Scikit-learn</h4>
                     <p class="text-xs text-gray-500 dark:text-gray-400">Official documentation for sklearn's FactorAnalysis implementation</p>
                   </div>
                 </a>
                 
                 <a href="https://www.datacamp.com/tutorial/introduction-factor-analysis" target="_blank" class="flex items-center p-3 bg-white/10 dark:bg-gray-800/50 hover:bg-white/20 dark:hover:bg-gray-700/70 rounded-lg transition-colors">
                   <div class="mr-3 flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 p-2 rounded-full">
                     <i class="fas fa-laptop-code text-purple-500 dark:text-purple-400"></i>
                   </div>
                   <div>
                     <h4 class="font-medium text-gray-800 dark:text-gray-200">DataCamp</h4>
                     <p class="text-xs text-gray-500 dark:text-gray-400">Interactive tutorial with hands-on examples</p>
                   </div>
                 </a>
               </div>
             </div>
             
             <!-- Code Snippet -->
             <div class="bg-gray-100 dark:bg-gray-900 rounded-lg p-4 overflow-hidden">
                              <h3 class="text-sm font-semibold mb-3 text-gray-700 dark:text-gray-300">Sample Code Snippet</h3>
               <div class="text-xs overflow-auto relative code-container" style="max-height: 300px;">
                 <div class="bg-gray-800 text-white p-2 flex justify-between items-center rounded-t-lg code-toolbar">
                   <div class="flex items-center">
                     <span class="mr-2 px-2 py-1 rounded bg-blue-600 text-xs font-medium">Python</span>
                     <span class="text-gray-400 text-xs">factor_analysis.py</span>
                   </div>
                   <div class="flex gap-2">
                     <button id="run-code-btn" class="px-2 py-1 bg-green-600 hover:bg-green-700 rounded text-xs flex items-center transition-colors">
                       <i class="fas fa-play mr-1"></i> Run
                     </button>
                     <button id="copy-code-btn" class="px-2 py-1 bg-gray-600 hover:bg-gray-700 rounded text-xs flex items-center transition-colors">
                       <i class="fas fa-copy mr-1"></i> Copy
                     </button>
                   </div>
                 </div>
                 <div class="relative">
                   <div class="absolute left-0 top-0 bottom-0 w-8 bg-gray-900 flex flex-col items-center pt-1 text-gray-500 text-xs line-numbers">
                     <div>1</div>
                     <div>2</div>
                     <div>3</div>
                     <div>4</div>
                     <div>5</div>
                     <div>6</div>
                     <div>7</div>
                     <div>8</div>
                     <div>9</div>
                     <div>10</div>
                     <div>11</div>
                     <div>12</div>
                     <div>13</div>
                   </div>
                   <pre class="python-code pl-10 py-3 text-gray-100 bg-gray-900 rounded-b-lg overflow-x-auto" style="tab-size: 4;"><code class="language-python"><span class="comment"># Install the library if running 1st time</span>
<span class="comment">#!pip install factor-analyzer</span>

<span class="keyword">from</span> <span class="module">factor_analyzer</span> <span class="keyword">import</span> <span class="class">FactorAnalyzer</span>  
fa = <span class="class">FactorAnalyzer</span>() 
fa.fit(df1)                                  
ev, v = fa.get_eigenvalues()                 
ev

fa = <span class="class">FactorAnalyzer</span>(n_factors,rotation=<span class="special">None</span>,method=<span class="string">'principal'</span>)    <span class="comment"># rotation=varimax,oblique rotation etc</span>      
fa.fit(df1)                            
fa.loadings_

fa.get_communalities()

fa.get_factor_variance()

fa.transform(df1)</code></pre>
                 </div>
                 
                 <!-- Code Output Panel -->
                 <div id="code-output" class="hidden mt-2 p-3 bg-black text-green-400 font-mono text-xs rounded code-output">
                   <div class="flex items-center justify-between mb-2">
                     <span class="text-gray-400">Output:</span>
                     <button id="clear-output-btn" class="text-gray-500 hover:text-gray-300 text-xs">
                       <i class="fas fa-times"></i> Clear
                     </button>
                   </div>
                   <div id="output-content">
                     <!-- Output will be populated by JavaScript -->
                   </div>
                 </div>
               </div>
               
               <!-- Interactive controls -->
               <div class="mt-4 flex flex-wrap gap-2">
                 <button class="px-3 py-1 text-xs bg-purple-600 hover:bg-purple-700 text-white rounded-full transition-colors flex items-center code-explain-btn">
                   <i class="fas fa-info-circle mr-1"></i> Explain Code
                 </button>
                 <button class="px-3 py-1 text-xs bg-indigo-600 hover:bg-indigo-700 text-white rounded-full transition-colors flex items-center code-step-btn">
                   <i class="fas fa-code-branch mr-1"></i> Step Through
                 </button>
                 <div class="px-3 py-1 text-xs bg-gray-200 dark:bg-gray-700 rounded-full flex items-center">
                   <span class="mr-2 text-gray-600 dark:text-gray-300">Theme:</span>
                   <select id="code-theme" class="bg-transparent text-gray-800 dark:text-gray-200 text-xs focus:outline-none">
                     <option value="dark">Dark</option>
                     <option value="light">Light</option>
                     <option value="monokai">Monokai</option>
                   </select>
                 </div>
               </div>
               
               <!-- Code explanation panel (hidden by default) -->
               <div id="code-explanation" class="hidden mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-xs text-gray-800 dark:text-gray-200 border-l-4 border-blue-500">
                 <h4 class="font-semibold mb-2 text-blue-600 dark:text-blue-400">Code Explanation</h4>
                 <ul class="space-y-2 list-disc pl-4">
                   <li><strong>Lines 1-2:</strong> Installation of the factor_analyzer package (commented out).</li>
                   <li><strong>Lines 4-7:</strong> Basic initialization of the FactorAnalyzer and extraction of eigenvalues.</li>
                   <li><strong>Lines 9-10:</strong> Creating a FactorAnalyzer with specific parameters - using the principal component method.</li>
                   <li><strong>Lines 12-16:</strong> Extracting important metrics: loadings, communalities, factor variance, and transforming the data to get factor scores.</li>
                 </ul>
               </div>

               <!-- Add CSS for syntax highlighting -->
               <style>
                 .code-container {
                   font-family: 'Fira Code', monospace;
                   border-radius: 0.5rem;
                   box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
                 }
                 .keyword { color: #ff79c6; }
                 .module { color: #8be9fd; }
                 .class { color: #50fa7b; }
                 .function { color: #ffb86c; }
                 .string { color: #f1fa8c; }
                 .comment { color: #6272a4; }
                 .special { color: #bd93f9; }
                 .code-output {
                   max-height: 200px;
                   overflow-y: auto;
                 }
                 .line-numbers {
                   user-select: none;
                   line-height: 1.4;
                 }
                 .python-code {
                   line-height: 1.4;
                 }
                 /* Highlight on hover */
                 .python-code:hover {
                   background-color: #2d3748;
                 }
               </style>
               
               <!-- JavaScript for interaction -->
               <script>
                 document.addEventListener('DOMContentLoaded', function() {
                   // Copy button functionality
                   const copyBtn = document.getElementById('copy-code-btn');
                   const codeElement = document.querySelector('.python-code');
                   
                   copyBtn.addEventListener('click', function() {
                     // Get text without HTML tags
                     const codeToCopy = codeElement.textContent;
                     
                     // Create temporary textarea to copy from
                     const textarea = document.createElement('textarea');
                     textarea.value = codeToCopy;
                     textarea.setAttribute('readonly', '');
                     textarea.style.position = 'absolute';
                     textarea.style.left = '-9999px';
                     document.body.appendChild(textarea);
                     
                     // Select and copy
                     textarea.select();
                     document.execCommand('copy');
                     
                     // Remove temporary element
                     document.body.removeChild(textarea);
                     
                     // Change button text temporarily
                     const originalText = copyBtn.innerHTML;
                     copyBtn.innerHTML = '<i class="fas fa-check mr-1"></i> Copied!';
                     copyBtn.style.backgroundColor = '#10B981'; // Green success color
                     
                     setTimeout(function() {
                       copyBtn.innerHTML = originalText;
                       copyBtn.style.backgroundColor = '';
                     }, 2000);
                   });
                   
                   // Run code simulation
                   const runBtn = document.getElementById('run-code-btn');
                   const outputPanel = document.getElementById('code-output');
                   const outputContent = document.getElementById('output-content');
                   const clearOutputBtn = document.getElementById('clear-output-btn');
                   
                   runBtn.addEventListener('click', function() {
                     // Show output panel with loading indicator
                     outputPanel.classList.remove('hidden');
                     outputContent.innerHTML = '<div class="text-gray-400">Running code...</div>';
                     
                     // Simulate code execution with delay
                     setTimeout(function() {
                       outputContent.innerHTML = `
                       <div class="mb-2"># Eigenvalues</div>
                       <div>array([3.29778896, 1.21431927, 1.10600263, 0.84962701, 0.74964834,
                       0.64954025, 0.45438856, 0.32121259, 0.28129239])</div>
                       <div class="mt-2 mb-1"># Loadings for 3 factors:</div>
                       <div class="mb-1">climate: [0.287, 0.076, 0.841]</div>
                       <div class="mb-1">housing: [0.698, 0.153, 0.084]</div>
                       <div class="mb-1">health:  [0.744, -0.410, -0.020]</div>
                       <div class="mb-1">crime:   [0.471, 0.522, 0.135]</div>
                       <div class="mb-1">trans:   [0.681, -0.156, -0.148]</div>
                       <div class="mb-1">educate: [0.498, -0.498, -0.253]</div>
                       <div class="mb-1">arts:    [0.860, -0.115, 0.012]</div>
                       <div class="mb-1">recreate:[0.642, 0.322, 0.044]</div>
                       <div class="mb-1">econ:    [0.298, 0.595, -0.533]</div>
                       <div class="mt-2 text-yellow-400">Execution successful! KMO = 0.703</div>`;
                     }, 1500);
                   });
                   
                   // Clear output button
                   clearOutputBtn.addEventListener('click', function() {
                     outputPanel.classList.add('hidden');
                     outputContent.innerHTML = '';
                   });
                   
                   // Code explanation toggle
                   const explainBtn = document.querySelector('.code-explain-btn');
                   const explanationPanel = document.getElementById('code-explanation');
                   
                   explainBtn.addEventListener('click', function() {
                     explanationPanel.classList.toggle('hidden');
                     if (!explanationPanel.classList.contains('hidden')) {
                       explanationPanel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                     }
                   });
                   
                   // Step through code simulation
                   const stepBtn = document.querySelector('.code-step-btn');
                   let currentStep = 0;
                   const codeLines = document.querySelectorAll('.python-code code span');
                   const totalSteps = codeLines.length;
                   
                   stepBtn.addEventListener('click', function() {
                     // Reset all highlights
                     document.querySelectorAll('.highlighted-line').forEach(el => {
                       el.classList.remove('highlighted-line');
                     });
                     
                     // Show output panel if hidden
                     if (outputPanel.classList.contains('hidden')) {
                       outputPanel.classList.remove('hidden');
                       outputContent.innerHTML = '';
                     }
                     
                     // Highlight next step
                     if (currentStep < totalSteps) {
                       const lineElement = codeLines[currentStep].parentElement;
                       lineElement.classList.add('highlighted-line');
                       lineElement.style.backgroundColor = 'rgba(59, 130, 246, 0.2)';
                       
                       // Add corresponding output
                       if (currentStep === 6) {
                         outputContent.innerHTML = `<div>array([3.29778896, 1.21431927, 1.10600263, ...])</div>`;
                       } else if (currentStep === 10) {
                         outputContent.innerHTML += `<div class="mt-2">Loadings matrix computed</div>`;
                       } else if (currentStep === 12) {
                         outputContent.innerHTML += `<div class="mt-2">Communalities calculated</div>`;
                       } else if (currentStep === 14) {
                         outputContent.innerHTML += `<div class="mt-2">Factor variance: [36.64%, 13.48%, 12.28%]</div>`;
                       } else if (currentStep === 16) {
                         outputContent.innerHTML += `<div class="mt-2 text-yellow-400">Factor scores calculated for all observations</div>`;
                       }
                       
                       currentStep++;
                       lineElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                     } else {
                       // Reset if we're at the end
                       currentStep = 0;
                       outputContent.innerHTML = '<div class="text-gray-400">Reset to beginning. Click again to step through.</div>';
                     }
                   });
                   
                   // Theme selection
                   const themeSelect = document.getElementById('code-theme');
                   const codeContainer = document.querySelector('.code-container');
                   
                   themeSelect.addEventListener('change', function() {
                     const selectedTheme = themeSelect.value;
                     
                     // Remove existing theme classes
                     codeContainer.classList.remove('theme-dark', 'theme-light', 'theme-monokai');
                     
                     // Apply new theme
                     if (selectedTheme === 'light') {
                       document.querySelector('.python-code').style.backgroundColor = '#f8f9fa';
                       document.querySelector('.python-code').style.color = '#212529';
                       document.querySelector('.line-numbers').style.backgroundColor = '#e9ecef';
                       document.querySelector('.line-numbers').style.color = '#495057';
                       document.querySelector('.code-toolbar').style.backgroundColor = '#e9ecef';
                       document.querySelector('.code-toolbar').style.color = '#212529';
                     } else if (selectedTheme === 'monokai') {
                       document.querySelector('.python-code').style.backgroundColor = '#272822';
                       document.querySelector('.python-code').style.color = '#f8f8f2';
                       document.querySelector('.line-numbers').style.backgroundColor = '#1e1f1c';
                       document.querySelector('.line-numbers').style.color = '#90908a';
                       document.querySelector('.code-toolbar').style.backgroundColor = '#1e1f1c';
                       document.querySelector('.code-toolbar').style.color = '#f8f8f2';
                     } else {
                       // Default dark theme
                       document.querySelector('.python-code').style.backgroundColor = '#1e1e1e';
                       document.querySelector('.python-code').style.color = '#d4d4d4';
                       document.querySelector('.line-numbers').style.backgroundColor = '#252526';
                       document.querySelector('.line-numbers').style.color = '#858585';
                       document.querySelector('.code-toolbar').style.backgroundColor = '#252526';
                       document.querySelector('.code-toolbar').style.color = '#d4d4d4';
                     }
                   });
                 });
               </script>
                   </div>
                   </div>
                 </div>
               </div>
               
      <!-- Footer for Code Tab -->
      <footer class="bg-gradient-to-br from-gray-900 via-purple-950 to-indigo-900 text-white py-12 mt-12 relative overflow-hidden">
        <!-- Animated background elements -->
        <div class="absolute inset-0 overflow-hidden">
          <div class="particles-js absolute inset-0 opacity-20" id="code-footer-particles"></div>
          <div class="absolute top-0 right-0 w-96 h-96 bg-blue-500/10 rounded-full filter blur-3xl animate-pulse-slow"></div>
          <div class="absolute bottom-0 left-0 w-96 h-96 bg-purple-500/10 rounded-full filter blur-3xl animate-pulse-slow" style="animation-delay: 2s"></div>
               </div>
               
        <!-- Border glow top -->
        <div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-purple-500/50 to-transparent"></div>
        
        <!-- Content container -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
            <!-- About Creator Section - Enhanced with 3D card -->
            <div class="space-y-4 perspective">
              <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-300">
                <i class="fas fa-user-circle mr-3 text-purple-400"></i>
                About Aditto Ahosan Kabbo
              </h3>
              <p class="text-gray-300 text-sm leading-relaxed">Data Enthusiast and Statistics Student at Pabna University of Science and Technology. Passionate about transforming raw data into actionable insights.</p>
              
              <!-- 3D interactive profile card -->
              <div class="profile-card bg-gradient-to-br from-purple-900/60 to-indigo-900/60 backdrop-blur-lg rounded-xl p-6 mt-4 border border-white/10 shadow-xl transform transition-all duration-500 hover:shadow-purple-500/20 group relative">
                <!-- Card tilt effect - JS will be added later -->
                <div class="absolute inset-0 bg-gradient-to-br from-purple-500/5 to-blue-500/5 opacity-0 group-hover:opacity-100 rounded-xl transition-opacity"></div>
                
                <!-- Animated profile picture -->
                <div class="relative w-32 h-32 mx-auto mb-5 rounded-full overflow-hidden profile-pic-container perspective">
                  <div class="profile-pic-inner transform transition-all duration-700">
                    <img src="https://raw.githubusercontent.com/AdittoAhosanKabbo/AdittoAhosanKabbo/main/Assets/20221031_113233-removebg.png" 
                        alt="Aditto Ahosan Kabbo" 
                        class="w-full h-full object-cover rounded-full border-2 border-purple-400/70 shadow-lg"
                        onerror="this.src='https://avatars.githubusercontent.com/u/AdittoAhosanKabbo'"
                        style="aspect-ratio: 1/1; object-fit: cover; object-position: center top;">
                  </div>
                  
                  <!-- Glowing ring animation -->
                  <div class="absolute inset-0 border-2 border-transparent rounded-full animate-spin-slow opacity-0 group-hover:opacity-100" style="background: linear-gradient(45deg, transparent, rgba(147, 51, 234, 0.3), transparent); animation-duration: 3s;"></div>
                </div>
                
                <!-- Animated title with typewriter effect -->
                <div class="text-center h-6 mb-2">
                  <span class="inline-block font-medium text-purple-300 typewriter-container overflow-hidden whitespace-nowrap" data-typing="🎓 Statistics Student,💻 Data Enthusiast,📊 Skilled in Visualization ">🎓 Statistics Student</span>
                </div>
                
                <!-- Interactive buttons that appear on hover -->
                <div class="mt-4 flex justify-center space-x-3 opacity-0 group-hover:opacity-100 transition-opacity">
                  <button class="btn-glow px-3 py-1 rounded-full bg-purple-600/30 hover:bg-purple-600/50 text-xs font-medium border border-purple-500/30 transition-all flex items-center" onclick="window.open('https://github.com/AdittoAhosanKabbo', '_blank')">
                    <i class="fab fa-github mr-1"></i> GitHub
                  </button>
                  <button class="btn-glow px-3 py-1 rounded-full bg-blue-600/30 hover:bg-blue-600/50 text-xs font-medium border border-blue-500/30 transition-all flex items-center" onclick="window.open('https://www.linkedin.com/in/adittoahosankabbo/', '_blank')">
                    <i class="fab fa-linkedin mr-1"></i> LinkedIn
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Enhanced Connect with me - Interactive 3D social links -->
            <div class="space-y-5">
              <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300">
                <i class="fas fa-link mr-3 text-blue-400"></i>
                Connect with me
              </h3>
              <ul class="space-y-3 text-gray-300">
                <li class="flex items-center hover:text-white transition-colors">
                  <i class="fab fa-linkedin text-blue-400 w-6"></i>
                  <a href="https://www.linkedin.com/in/adittoahosankabbo/" target="_blank" class="ml-2 hover:underline">LinkedIn</a>
                </li>
                <li class="flex items-center hover:text-white transition-colors">
                  <i class="fab fa-github text-gray-400 w-6"></i>
                  <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="ml-2 hover:underline">GitHub</a>
                </li>
                <li class="flex items-center hover:text-white transition-colors">
                  <i class="fab fa-facebook text-blue-500 w-6"></i>
                  <a href="https://www.facebook.com/Adittoahosan" target="_blank" class="ml-2 hover:underline">Facebook</a>
                </li>
                <li class="flex items-center hover:text-white transition-colors">
                  <i class="fab fa-kaggle text-cyan-500 w-6"></i>
                  <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="ml-2 hover:underline">Kaggle</a>
                </li>
                <li class="flex items-center hover:text-white transition-colors">
                  <i class="far fa-envelope text-red-400 w-6"></i>
                  <a href="mailto:adittoahosankabbo@gmail.com" class="ml-2 hover:underline">adittoahosankabbo@gmail.com</a>
                </li>
                <li class="flex items-center hover:text-white transition-colors">
                  <i class="fab fa-whatsapp text-green-400 w-6"></i>
                  <a href="https://wa.me/8801749018051?text=hello" target="_blank" class="ml-2 hover:underline">WhatsApp</a>
                </li>
              </ul>
            </div>
            
            <!-- Skills & Project Links -->
            <div class="space-y-4">
              <h3 class="text-xl font-bold flex items-center">
                <i class="fas fa-laptop-code mr-2 text-green-400"></i>
                Skills & Projects
              </h3>
              <div class="grid grid-cols-2 gap-2 mb-4">
                <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                  <i class="fab fa-python text-xl text-blue-400"></i>
                  <p class="text-xs mt-1">Python</p>
                </div>
                <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                  <i class="fas fa-database text-xl text-blue-500"></i>
                  <p class="text-xs mt-1">SQL</p>
                </div>
                <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                  <i class="fab fa-r-project text-xl text-blue-300"></i>
                  <p class="text-xs mt-1">R</p>
                </div>
                <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                  <i class="fas fa-table text-xl text-green-400"></i>
                  <p class="text-xs mt-1">Excel</p>
                </div>
                <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                  <i class="fas fa-chart-bar text-xl text-purple-400"></i>
                  <p class="text-xs mt-1">Power BI</p>
                </div>
                <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                  <i class="fas fa-chart-line text-xl text-purple-300"></i>
                  <p class="text-xs mt-1">SPSS</p>
                </div>
              </div>
              <p class="text-gray-300 text-sm">View more data analysis and statistics projects on my GitHub and Kaggle profiles.</p>
              <div class="mt-4">
                <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:from-purple-700 hover:to-indigo-700 transition-all inline-flex items-center">
                  <i class="fab fa-github mr-2"></i> View GitHub Projects
                </a>
              </div>
            </div>
          </div>
          
          <div class="mt-8 pt-6 border-t border-white/10 flex flex-col md:flex-row justify-between items-center">
            <p class="text-gray-400 text-sm">© 2025 Aditto Ahosan Kabbo. All rights reserved.</p>
            <div class="flex space-x-4 mt-4 md:mt-0">
              <a href="https://www.hackerrank.com/profile/aditahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
                <i class="fab fa-hackerrank"></i>
              </a>
              <a href="https://www.reddit.com/user/AhosanKabbo/" target="_blank" class="text-gray-400 hover:text-white transition-colors">
                <i class="fab fa-reddit-alien"></i>
              </a>
              <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
                <i class="fab fa-kaggle"></i>
              </a>
            </div>
          </div>
        </div>
        
        <!-- Footer particles container -->
        <div id="code-footer-particles-js" class="absolute inset-0 opacity-20"></div>
      </footer>
    </div>
  </div>
  
  <!-- Mathematical Explanation Tab Content -->
  <div id="mathExplanationTabContent" class="main-tab-content hidden">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="bg-white dark:bg-gray-800 shadow-lg rounded-lg overflow-hidden">
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
          <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Mathematical Foundation of Factor Analysis</h2>
          <p class="mt-2 text-gray-600 dark:text-gray-300">This section explains the mathematical theory behind factor analysis with principal component method, and verifies the results with our Python implementation.</p>
        </div>
        
        <div class="p-6">
          <div class="space-y-8">
            <!-- Introduction to Factor Analysis -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-book-open mr-2 text-blue-600 dark:text-blue-400"></i>
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400 mr-2">Step 1</span>
                Introduction to Factor Analysis
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-4">
                <p>Factor Analysis is a statistical method used to reduce the dimensionality of observed variables by identifying underlying unobservable variables called factors. It can only be applied to continuous variables in a dataset. The key characteristics of factor analysis include:</p>
                
                <ul class="list-disc pl-5 space-y-2">
                  <li>It's a linear statistical model that explains variance among observed variables</li>
                  <li>It condenses a set of observed variables into unobserved latent variables (factors)</li>
                  <li>Each factor explains a particular amount of variance in the observed variables</li>
                  <li>Factors are associated with multiple observed variables that have common patterns of responses</li>
                  <li>It helps in data interpretation by reducing the number of variables</li>
                </ul>
                
                <p class="mt-4 font-semibold">Types of Factor Analysis:</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                  <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                    <p class="font-semibold text-blue-700 dark:text-blue-400">Exploratory Factor Analysis (EFA)</p>
                    <p class="mt-2 text-sm">Assumes that any observed variable can be associated with any factor. Used to identify underlying factor structure without prior knowledge.</p>
                  </div>
                  <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg">
                    <p class="font-semibold text-purple-700 dark:text-purple-400">Confirmatory Factor Analysis (CFA)</p>
                    <p class="mt-2 text-sm">Assumes that each factor is associated with a specific set of observed variables. Used to test whether data fits a hypothesized measurement model.</p>
                  </div>
                </div>
                
                <p class="mt-4 font-semibold">Key Terms in Factor Analysis:</p>
                <ul class="list-disc pl-5 space-y-2">
                  <li><strong>Factor:</strong> A latent variable that describes the association among observed variables</li>
                  <li><strong>Factor Loadings:</strong> Correlation coefficients between observed variables and factors</li>
                  <li><strong>Eigenvalues:</strong> Represent variance explained by each factor from the total variance</li>
                  <li><strong>Communalities:</strong> Sum of squared loadings for each variable, representing shared variance</li>
                  <li><strong>Factor Rotation:</strong> A tool for better interpretation that redistributes the commonalities with a clearer pattern</li>
                </ul>
                
                <div class="border-l-4 border-amber-500 pl-4 py-2 bg-amber-50 dark:bg-amber-900/20 mt-4">
                  <p class="text-amber-800 dark:text-amber-200 font-medium">In our analysis, we used Exploratory Factor Analysis with the Principal Component Method and applied no rotation techniques.</p>
                </div>

                <h4 class="text-lg font-semibold mt-6 text-gray-800 dark:text-gray-200">Mathematical Model</h4>
                <p>The fundamental equation of the factor analysis model can be expressed as:</p>
                
                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg overflow-x-auto">
                  <p class="font-mono text-center">X = μ + Lf + ε</p>
                </div>
                
                <p>Where:</p>
                <ul class="list-disc pl-5 space-y-2">
                  <li><strong>X</strong> = (X₁, X₂, ..., Xₚ)ᵀ is the vector of observed variables (in our case, the 9 quality of life metrics)</li>
                  <li><strong>μ</strong> = (μ₁, μ₂, ..., μₚ)ᵀ is the vector of variable means</li>
                  <li><strong>L</strong> is the p×m matrix of factor loadings (where p=9 variables and m=3 factors in our analysis)</li>
                  <li><strong>f</strong> = (f₁, f₂, ..., fₘ)ᵀ is the vector of common factors (unobserved)</li>
                  <li><strong>ε</strong> = (ε₁, ε₂, ..., εₚ)ᵀ is the vector of specific factors (errors)</li>
                </ul>
                
                <p>For each individual variable, this can be written as:</p>
                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg overflow-x-auto">
                  <p class="font-mono">X₁ = μ₁ + l₁₁f₁ + l₁₂f₂ + ... + l₁ₘfₘ + ε₁</p>
                  <p class="font-mono">X₂ = μ₂ + l₂₁f₁ + l₂₂f₂ + ... + l₂ₘfₘ + ε₂</p>
                  <p class="font-mono">⋮</p>
                  <p class="font-mono">Xₚ = μₚ + lₚ₁f₁ + lₚ₂f₂ + ... + lₚₘfₘ + εₚ</p>
                </div>
              </div>
            </div>
            
            <!-- Factor Analysis Assumptions -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-clipboard-list mr-2 text-green-600 dark:text-green-400"></i>
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400 mr-2">Step 2</span>
                Model Assumptions
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-2">
                <p>The factor analysis model makes several key assumptions:</p>
                
                <ol class="list-decimal pl-5 space-y-2">
                  <li><strong>Mean Assumptions:</strong>
                    <ul class="list-disc pl-5 mt-1">
                      <li>E(ε) = 0 (The specific factors have mean zero)</li>
                      <li>E(f) = 0 (The common factors have mean zero)</li>
                    </ul>
                  </li>
                  
                  <li><strong>Variance Assumptions:</strong>
                    <ul class="list-disc pl-5 mt-1">
                      <li>Var(f) = I (The common factors have unit variance and are uncorrelated)</li>
                      <li>Var(ε) = Ψ (A diagonal matrix with specific variances ψᵢ on the diagonal)</li>
                    </ul>
                  </li>
                  
                  <li><strong>Independence Assumptions:</strong>
                    <ul class="list-disc pl-5 mt-1">
                      <li>Cov(f, ε) = 0 (The common factors and specific factors are uncorrelated)</li>
                    </ul>
                  </li>
                </ol>
                
                <p>With these assumptions, the covariance structure of the observed variables can be modeled as:</p>
                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg overflow-x-auto">
                  <p class="font-mono text-center">Σ = Var(X) = LLᵀ + Ψ</p>
                </div>
                
                <p>This means the variance of each variable can be decomposed as:</p>
                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg overflow-x-auto">
                  <p class="font-mono text-center">Var(Xᵢ) = l²ᵢ₁ + l²ᵢ₂ + ... + l²ᵢₘ + ψᵢ = hᵢ² + ψᵢ</p>
                </div>
                
                <p>Where hᵢ² = l²ᵢ₁ + l²ᵢ₂ + ... + l²ᵢₘ is called the <strong>communality</strong> of variable i, representing the variance explained by the common factors.</p>
              </div>
            </div>
             <!-- Adequacy Tests for Factor Analysis -->
             <div>
              <h3 class="text-xl font-semibold mb-3 mt-8 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-tasks mr-2 text-teal-600 dark:text-teal-400"></i>
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-teal-100 text-teal-600 dark:bg-teal-900/30 dark:text-teal-400 mr-2">Step 3</span>
                Adequacy Tests for Factor Analysis
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-4">
                <p>Before proceeding with factor analysis, we need to evaluate whether our data is suitable for this technique. Two critical tests help determine if the correlation structure of the variables justifies the use of factor analysis.</p>
                
                <!-- Bartlett's Test Adequacy Section -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                    <h4 class="font-semibold text-blue-700 dark:text-blue-400 mb-2">Bartlett's Test of Sphericity</h4>
                    <p class="text-sm mb-3">Bartlett's test measures whether there are significant correlations among variables by testing if the correlation matrix is significantly different from an identity matrix.</p>
                    <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto">
                      <p class="font-semibold text-sm mb-1">Null Hypothesis (H0) - Correlation matrix is an identity matrix.</p>
                      <p class="font-semibold text-sm mb-1">Alternative Hypothesis (H1) - Correlation matrix is not an identity matrix.</p>
                    </div>  
                    <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto">
                      <p class="font-semibold text-sm mb-1">Mathematical Properties:</p>
                      <ul class="list-disc text-sm pl-5 space-y-1">
                        <li><strong>Power:</strong> Good power to detect non-identity correlation matrices</li>
                        <li><strong>Effect Size:</strong> Proportional to sample size and deviation from identity</li>
                        <li><strong>Sensitivity:</strong> Highly sensitive to sample size; may show significance with large samples even with small correlations</li>
                      </ul>
                    </div>
                    
                    <p class="text-sm mt-3">For adequate data, the following should be met:</p>
                    <ul class="list-disc text-sm pl-5 mt-1">
                      <li>Statistically significant result (p < 0.05)</li>
                      <li>Large chi-square value relative to degrees of freedom</li>
                      <li>Small determinant of correlation matrix (< 0.00001), but not zero</li>
                    </ul>
                    
                    <p class="text-sm mt-3 font-medium">Interpretation Guidelines:</p>
                    <table class="w-full text-sm mt-1 border-collapse">
                      <thead class="bg-blue-100 dark:bg-blue-800/50">
                        <tr>
                          <th class="p-2 text-left">p-value</th>
                          <th class="p-2 text-left">Interpretation</th>
                        </tr>
                      </thead>
                      <tbody class="bg-white dark:bg-gray-800/60">
                        <tr>
                          <td class="p-2 border-t">p < 0.001</td>
                          <td class="p-2 border-t">Strong evidence for factor analysis</td>
                        </tr>
                        <tr>
                          <td class="p-2 border-t">0.001 ≤ p < 0.05</td>
                          <td class="p-2 border-t">Adequate for factor analysis</td>
                        </tr>
                        <tr>
                          <td class="p-2 border-t">p ≥ 0.05</td>
                          <td class="p-2 border-t">Factor analysis not recommended</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  <!-- KMO Measure Section -->
                  <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg">
                    <h4 class="font-semibold text-purple-700 dark:text-purple-400 mb-2">Kaiser-Meyer-Olkin (KMO) Measure</h4>
                    <p class="text-sm mb-3">The KMO test evaluates the sampling adequacy by comparing the magnitudes of the observed correlation coefficients to the partial correlation coefficients.</p>
                    
                    <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto mt-2">
                      <p class="font-mono text-center">
                        KMO = 
                        <span style="display: inline-block; vertical-align: middle;">
                          <span style="display: block; text-align: center; border-bottom: 1px solid; margin-bottom: 0.1em;">
                            ∑<sub>i</sub>∑<sub>j≠i</sub> r<sub>ij</sub><sup>2</sup>
                          </span>
                          <span style="display: block; text-align: center;">
                            ∑<sub>i</sub>∑<sub>j≠i</sub> r<sub>ij</sub><sup>2</sup> + ∑<sub>i</sub>∑<sub>j≠i</sub> p<sub>ij</sub><sup>2</sup>
                          </span>
                        </span>
                      </p>                    </div>
                    
                    <p class="text-sm mt-2">Where:</p>
                    <ul class="list-disc text-sm pl-5 space-y-1">
                      <li>r<sub>ij</sub> = correlation coefficient between variables i and j</li>
                      <li>p<sub>ij</sub> = partial correlation coefficient between variables i and j</li>
                    </ul>
                    
                    <p class="text-sm mt-3">The KMO measure ranges from 0 to 1:</p>
                    <ul class="list-disc text-sm pl-5 mt-1">
                      <li>High values (close to 1) indicate factor analysis may yield distinct, reliable factors</li>
                      <li>Low values (close to 0) indicate correlations between pairs of variables cannot be explained by other variables</li>
                    </ul>
                    
                    <p class="text-sm mt-3 font-medium">Kaiser's Classification of KMO Values:</p>
                    <table class="w-full text-sm mt-1 border-collapse">
                      <thead class="bg-purple-100 dark:bg-purple-800/50">
                        <tr>
                          <th class="p-2 text-left">KMO Value</th>
                          <th class="p-2 text-left">Interpretation</th>
                        </tr>
                      </thead>
                      <tbody class="bg-white dark:bg-gray-800/60">
                        <tr>
                          <td class="p-2 border-t">≥ 0.9</td>
                          <td class="p-2 border-t">Marvelous</td>
                        </tr>
                        <tr>
                          <td class="p-2 border-t">0.8 - 0.89</td>
                          <td class="p-2 border-t">Meritorious</td>
                        </tr>
                        <tr>
                          <td class="p-2 border-t">0.7 - 0.79</td>
                          <td class="p-2 border-t">Middling</td>
                        </tr>
                        <tr>
                          <td class="p-2 border-t">0.6 - 0.69</td>
                          <td class="p-2 border-t">Mediocre</td>
                        </tr>
                        <tr>
                          <td class="p-2 border-t">0.5 - 0.59</td>
                          <td class="p-2 border-t">Miserable</td>
                        </tr>
                        <tr>
                          <td class="p-2 border-t">< 0.5</td>
                          <td class="p-2 border-t">Unacceptable</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                
                <div class="mt-4 p-3 bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 rounded-r-lg">
                  <p class="text-sm"><strong>Note:</strong> For our dataset, both tests confirm the adequacy for factor analysis:</p>
                  <ul class="list-disc text-sm pl-5 mt-1">
                    <li>Bartlett's Test: χ² = 839.43, p-value = 5.99e-153 (highly significant)</li>
                    <li>KMO Measure: 0.703 (Middling adequacy according to Kaiser's classification)</li>
                  </ul>
                </div>
            
            <!-- Estimation Methods for Factor Analysis -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-project-diagram mr-2 text-purple-600 dark:text-purple-400"></i>
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400 mr-2">Step 4</span>
                Estimation Methods for Factor Analysis
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-4">
                <p>There are several methods for estimating factor loadings in factor analysis. The two most common approaches are the Principal Component Method (which we used) and the Maximum Likelihood Method.</p>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-4">
                  <!-- Principal Component Method -->
                  <div class="bg-blue-50 dark:bg-blue-900/20 p-5 rounded-lg">
                    <h4 class="font-semibold text-lg text-blue-700 dark:text-blue-400 mb-3">Principal Component Method</h4>
                    <p class="mb-3">This method uses eigenvalue decomposition of the correlation or covariance matrix to estimate factor loadings:</p>
                    
                    <ol class="list-decimal pl-5 space-y-4">
                      <li>
                        <strong>Eigenvalue Decomposition:</strong> The correlation or covariance matrix S is decomposed into eigenvalues and eigenvectors:
                        <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto mt-2">
                          <p class="font-mono text-center">S = EΛEᵀ</p>
                        </div>
                        <p class="mt-2 text-sm">Where E is the matrix of eigenvectors and Λ is a diagonal matrix of eigenvalues λ₁ ≥ λ₂ ≥ ... ≥ λₚ.</p>
                      </li>
                      
                      <li>
                        <strong>Factor Loading Estimation:</strong> The principal component method estimates the factor loadings as:
                        <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto mt-2">
                          <p class="font-mono text-center">L = E_m Λ_m^(1/2)</p>
                        </div>
                        <p class="mt-2 text-sm">Where E_m consists of the first m eigenvectors (columns of E) and Λ_m^(1/2) is a diagonal matrix with the square roots of the first m eigenvalues.</p>
                      </li>
                      
                      <li>
                        <strong>Specific Variance Estimation:</strong> The specific variances are estimated as:
                        <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto mt-2">
                          <p class="font-mono text-center">ψᵢ = sᵢᵢ - ∑ᵐⱼ₌₁ l²ᵢⱼ</p>
                        </div>
                        <p class="mt-2 text-sm">Where sᵢᵢ is the variance of variable i, and ∑ᵐⱼ₌₁ l²ᵢⱼ is the communality of variable i.</p>
                      </li>
                    </ol>
                  </div>
                  
                  <!-- Maximum Likelihood Method -->
                  <div class="bg-green-50 dark:bg-green-900/20 p-5 rounded-lg">
                    <h4 class="font-semibold text-lg text-green-700 dark:text-green-400 mb-3">Maximum Likelihood Method</h4>
                    <p class="mb-3">This method estimates parameters by finding values that maximize the likelihood of making the observations given the parameters:</p>
                    
                    <ol class="list-decimal pl-5 space-y-4">
                      <li>
                        <strong>Model Assumption:</strong> Assumes multivariate normality of observed variables:
                        <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto mt-2">
                          <p class="font-mono text-center">X ~ N(μ, Σ)</p>
                          <p class="font-mono text-center">Σ = LLᵀ + Ψ</p>
                        </div>
                      </li>
                      
                      <li>
                        <strong>Log-Likelihood Function:</strong> Under these assumptions, we maximize:
                        <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto mt-2">
                          <p class="font-mono text-center">ln L(L, Ψ | S) = -½[ln|LLᵀ + Ψ| + tr((LLᵀ + Ψ)⁻¹S) - ln|S| - p]</p>
                        </div>
                        <p class="mt-2 text-sm">Where S is the sample covariance matrix, p is the number of variables, and tr is the trace function.</p>
                      </li>
                      
                      <li>
                        <strong>Iterative Solution:</strong> The maximization requires iterative algorithms like the Expectation-Maximization (EM) algorithm to find the factor loadings L and specific variances Ψ.
                      </li>
                    </ol>
                    
                    <p class="mt-3 text-sm">The advantage of the Maximum Likelihood method is that it allows for statistical testing of the adequacy of the factor model and for computing confidence intervals.</p>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Factor Analysis vs PCA -->
            <div>
              <h3 class="text-xl font-semibold mb-3 mt-8 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-balance-scale mr-2 text-amber-600 dark:text-amber-400"></i>
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-400 mr-2">Step 5</span>
                Factor Analysis vs. Principal Component Analysis
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-4">
                <p>Although the Principal Component Method is used in Factor Analysis, Factor Analysis itself differs from Principal Component Analysis (PCA) in several ways:</p>
                
                <div class="overflow-x-auto">
                  <table class="min-w-full bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-sm mt-3">
                    <thead class="bg-gray-100 dark:bg-gray-700">
                      <tr>
                        <th class="px-5 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider">Aspect</th>
                        <th class="px-5 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider">Factor Analysis</th>
                        <th class="px-5 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider">Principal Component Analysis</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 dark:divide-gray-600">
                      <tr>
                        <td class="px-5 py-3 text-sm font-medium">Focus</td>
                        <td class="px-5 py-3 text-sm">Explains covariance/correlation among variables</td>
                        <td class="px-5 py-3 text-sm">Explains maximum variance in the data</td>
                      </tr>
                      <tr>
                        <td class="px-5 py-3 text-sm font-medium">Model Structure</td>
                        <td class="px-5 py-3 text-sm">Observed variables are linear combinations of factors</td>
                        <td class="px-5 py-3 text-sm">Components are linear combinations of observed variables</td>
                      </tr>
                      <tr>
                        <td class="px-5 py-3 text-sm font-medium">Orthogonality</td>
                        <td class="px-5 py-3 text-sm">Factors don't need to be orthogonal (can be with rotation)</td>
                        <td class="px-5 py-3 text-sm">Components are always orthogonal</td>
                      </tr>
                      <tr>
                        <td class="px-5 py-3 text-sm font-medium">Error Term</td>
                        <td class="px-5 py-3 text-sm">Includes an error term (specific variance)</td>
                        <td class="px-5 py-3 text-sm">Does not include an error term</td>
                      </tr>
                      <tr>
                        <td class="px-5 py-3 text-sm font-medium">Interpretability</td>
                        <td class="px-5 py-3 text-sm">Factors are interpretable and can be labeled</td>
                        <td class="px-5 py-3 text-sm">Components are often difficult to interpret</td>
                      </tr>
                      <tr>
                        <td class="px-5 py-3 text-sm font-medium">Purpose</td>
                        <td class="px-5 py-3 text-sm">Primarily used to identify latent constructs</td>
                        <td class="px-5 py-3 text-sm">Primarily used for dimension reduction</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                
                <p class="text-sm italic text-gray-600 dark:text-gray-400 mt-2">Note: Despite these differences, PCA is often used as an extraction method in Factor Analysis (as we did in our analysis), which can sometimes blur the distinction between the two methods.</p>
              </div>
            </div>
            
           
                
                <!-- Goodness-of-Fit Testing -->
                <div class="mt-6">
                  <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">
                    <span class="px-3 py-1 text-xs font-semibold rounded-full bg-indigo-100 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400 mr-2">Step 6</span>
                    Goodness-of-Fit Testing(Bartlett-Corrected Likelihood Ratio Test)</h4>
                  <p>In maximum likelihood factor analysis, we can assess the fit of the model by testing whether the residual correlations are close enough to zero, indicating the model adequately explains the observed correlations.</p>
                  
                  <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg mt-3">
                    <p class="font-semibold text-purple-700 dark:text-purple-400">Mathematical Formulation:</p>
                    <p class="text-sm mt-2">The goodness-of-fit test statistic is calculated as:</p>
                    <div class="bg-white dark:bg-gray-800 p-3 rounded-lg overflow-x-auto mt-2">
                      <p class="font-mono text-center">
                        X² = (n - 1 - 
                        <span style="display: inline-block; vertical-align: middle;">
                          <span style="display: block; text-align: center; border-bottom: 1px solid; margin-bottom: 0.1em;">
                            2p + 4m - 5
                          </span>
                          <span style="display: block; text-align: center;">
                            6
                          </span>
                        </span>
                        ) log 
                        <span style="display: inline-block; vertical-align: middle;">
                          <span style="display: block; text-align: center; border-bottom: 1px solid; margin-bottom: 0.1em;">
                            |L̂L̂' + Ψ̂|
                          </span>
                          <span style="display: block; text-align: center;">
                            |Σ̂|
                          </span>
                        </span>
                      </p>                    </div>
                    <p class="text-sm mt-2">Where:</p>
                    <ul class="list-disc text-sm pl-5 space-y-1">
                      <li>n = sample size</li>
                      <li>p = number of variables</li>
                      <li>m = number of factors</li>
                      <li>|\hat{L}\hat{L}'+\hat{\Psi}| = determinant of the model-implied covariance matrix</li>
                      <li>|\hat{\Sigma}| = determinant of the sample covariance matrix</li>
                    </ul>
                    
                    <div class="mt-3">
                      <p class="font-semibold text-purple-700 dark:text-purple-400">Testing Procedure:</p>
                      <ol class="list-decimal text-sm pl-5 space-y-1 mt-1">
                        <li><strong>Null Hypothesis (H₀):</strong> The m-factor model fits the data well</li>
                        <li><strong>Alternative Hypothesis (H₁):</strong> The m-factor model does not fit the data well</li>
                        <li>The test statistic follows a chi-square distribution with df = [(p-m)² - (p+m)]/2 degrees of freedom</li>
                        <li>We <em>fail to reject</em> H₀ if the p-value > α (typically 0.05)</li>
                      </ol>
                    </div>
                    
                    <p class="text-sm mt-3"><strong>Note:</strong> Unlike most statistical tests, for goodness-of-fit we want a <em>non-significant</em> result (p > 0.05), indicating no significant difference between the observed correlations and those predicted by the model.</p>
                    
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md mt-3">
                      <p class="text-sm font-semibold">Practical Considerations:</p>
                      <ul class="list-disc text-sm pl-5 mt-1">
                        <li>This test is sensitive to sample size—large samples may lead to rejection even with small deviations</li>
                        <li>Additional fit indices are often used: RMSEA, CFI, TLI, and SRMR</li>
                        <li>Examining residual correlations can provide insights into local areas of misfit</li>
                      </ul>
                    </div>
                  </div>
                  
                  <p class="text-sm mt-2 italic">When evaluating any factor analysis model, it's important to consider both statistical fit and theoretical interpretability.</p>
                  
                  <!-- Comparison Table -->
                  <div class="mt-6">
                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3">Comparison: Bartlett Tests in Factor Analysis</h4>
                    <p class="text-sm mb-3">It's important to distinguish between the two types of Bartlett tests used in factor analysis:</p>
                    
                    <div class="overflow-x-auto">
                      <table class="w-full bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-sm">
                        <thead class="bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900/40 dark:to-purple-900/40">
                          <tr>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider">Feature</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-blue-700 dark:text-blue-300 uppercase tracking-wider">Bartlett-Corrected Likelihood Ratio Test</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-purple-700 dark:text-purple-300 uppercase tracking-wider">Bartlett's Test of Sphericity</th>
                          </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
                          <tr class="hover:bg-gray-50 dark:hover:bg-gray-800/60">
                            <td class="px-4 py-3 text-sm font-medium">Purpose</td>
                            <td class="px-4 py-3 text-sm">Tests if a factor/SEM model fits the data.</td>
                            <td class="px-4 py-3 text-sm">Tests if variables are uncorrelated (identity matrix).</td>
                          </tr>
                          <tr class="hover:bg-gray-50 dark:hover:bg-gray-800/60">
                            <td class="px-4 py-3 text-sm font-medium">When Used</td>
                            <td class="px-4 py-3 text-sm">After model fitting (e.g., CFA, SEM).</td>
                            <td class="px-4 py-3 text-sm">Before factor analysis (e.g., PCA, EFA).</td>
                          </tr>
                          <tr class="hover:bg-gray-50 dark:hover:bg-gray-800/60">
                            <td class="px-4 py-3 text-sm font-medium">Null Hypothesis (H₀)</td>
                            <td class="px-4 py-3 text-sm">"The model's covariance structure fits the data."</td>
                            <td class="px-4 py-3 text-sm">"Variables are uncorrelated (𝑹 = 𝑰)."</td>
                          </tr>
                          <tr class="hover:bg-gray-50 dark:hover:bg-gray-800/60">
                            <td class="px-4 py-3 text-sm font-medium">Statistic Compares</td>
                            <td class="px-4 py-3 text-sm">Model-implied vs. sample covariance matrices.</td>
                            <td class="px-4 py-3 text-sm">Sample correlation matrix vs. identity matrix.</td>
                          </tr>
                          <tr class="hover:bg-gray-50 dark:hover:bg-gray-800/60">
                            <td class="px-4 py-3 text-sm font-medium">Significant Result</td>
                            <td class="px-4 py-3 text-sm text-red-600 dark:text-red-400">Reject H₀: Poor model fit (revise model).</td>
                            <td class="px-4 py-3 text-sm text-green-600 dark:text-green-400">Reject H₀: Data is suitable for factor analysis.</td>
                          </tr>
                          <tr class="hover:bg-gray-50 dark:hover:bg-gray-800/60">
                            <td class="px-4 py-3 text-sm font-medium">Non-Significant Result</td>
                            <td class="px-4 py-3 text-sm text-green-600 dark:text-green-400">Model is adequate.</td>
                            <td class="px-4 py-3 text-sm text-red-600 dark:text-red-400">Avoid factor analysis (no correlations).</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    
                    <p class="text-sm mt-3 italic">Note: Both tests use Bartlett's name but serve opposite purposes in the factor analysis workflow—one validates data suitability at the beginning, while the other evaluates model fit at the end.</p>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Verification with Python Results -->
            <div>
              <h3 class="text-xl font-semibold mb-3 mt-8 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-check-circle mr-2 text-indigo-600 dark:text-indigo-400"></i>
                Verification with Our Python Results
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-4">
                <p>Let's verify our mathematical understanding with the results from the Python implementation:</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Eigenvalues from Analysis</h4>
                    <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg overflow-x-auto">
                      <p class="font-mono">λ₁ = 3.298</p>
                      <p class="font-mono">λ₂ = 1.214</p>
                      <p class="font-mono">λ₃ = 1.196</p>
                      <p class="font-mono">λ₄ = 0.850</p>
                      <p class="font-mono">λ₅ = 0.750</p>
                      <p class="font-mono">...</p>
                    </div>
                  </div>
                  
                  <div>
                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Variance Explained</h4>
                    <div class="bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg overflow-x-auto">
                      <p class="font-mono">Factor 1: 36.64%</p>
                      <p class="font-mono">Factor 2: 13.48%</p>
                      <p class="font-mono">Factor 3: 12.28%</p>
                      <p class="font-mono">Total: 62.40%</p>
                    </div>
                    <p class="mt-2 text-sm">This confirms the variance explained by each factor is proportional to its eigenvalue, where the percentage is λᵢ/∑λᵢ × 100%.</p>
                  </div>
                </div>
                
                <p class="mt-4">The communalities we found in our analysis represent the proportion of each variable's variance explained by the common factors:</p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div class="bg-gray-50 dark:bg-gray-700/30 p-3 rounded-lg">
                    <p class="font-mono text-sm">climate: 0.795</p>
                    <p class="font-mono text-sm">housing: 0.518</p>
                    <p class="font-mono text-sm">health: 0.722</p>
                  </div>
                  <div class="bg-gray-50 dark:bg-gray-700/30 p-3 rounded-lg">
                    <p class="font-mono text-sm">crime: 0.512</p>
                    <p class="font-mono text-sm">trans: 0.510</p>
                    <p class="font-mono text-sm">educate: 0.561</p>
                  </div>
                  <div class="bg-gray-50 dark:bg-gray-700/30 p-3 rounded-lg">
                    <p class="font-mono text-sm">arts: 0.754</p>
                    <p class="font-mono text-sm">recreate: 0.517</p>
                    <p class="font-mono text-sm">econ: 0.728</p>
                  </div>
                </div>
                
                <p class="mt-4">For each variable, the communality hᵢ² represents the sum of squared factor loadings:</p>
                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg overflow-x-auto">
                  <p class="font-mono text-center">hᵢ² = l²ᵢ₁ + l²ᵢ₂ + ... + l²ᵢₘ</p>
                </div>
                
                <p>For example, the communality of the "climate" variable (0.795) equals the sum of its squared loadings across the three factors. This indicates that 79.5% of the variance in climate ratings is explained by the three common factors, while the remaining 20.5% is specific variance.</p>
              </div>
            </div>
            
            <!-- Factor Score Calculation -->
            <div>
              <h3 class="text-xl font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-calculator mr-2 text-pink-600 dark:text-pink-400"></i>
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-pink-100 text-pink-600 dark:bg-pink-900/30 dark:text-pink-400 mr-2">Step 7</span>
                Factor Score Calculation
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-4">
                <p>In our Python code, we calculated factor scores using the method <code>fa.transform(df1)</code>. Mathematically, using the principal component method, the factor scores are calculated as:</p>
                
                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg overflow-x-auto">
                  <p class="font-mono text-center">f̂ᵢ = (L'L)⁻¹L'(Yᵢ-ȳ)</p>
                </div>
                
                <p>Where:</p>
                <ul class="list-disc pl-5 space-y-2">
                  <li>f̂ᵢ is the vector of estimated factor scores for the ith observation</li>
                  <li>L is the matrix of estimated factor loadings</li>
                  <li>Yᵢ is the vector of observed variables for the ith observation</li>
                  <li>ȳ is the vector of sample means</li>
                </ul>
                
                <p>For the principal component method, when using the unrotated factor loadings, this simplifies to:</p>
                
                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg overflow-x-auto">
                  <p class="font-mono text-center">f̂ᵢ = [1/√λ₁ · e₁'(Yᵢ-ȳ), 1/√λ₂ · e₂'(Yᵢ-ȳ), ..., 1/√λₘ · eₘ'(Yᵢ-ȳ)]'</p>
                </div>
                
                <p>Where:</p>
                <ul class="list-disc pl-5 space-y-2">
                  <li>λⱼ is the jth eigenvalue</li>
                  <li>eⱼ is the jth eigenvector</li>
                </ul>
                
                <p>These factor scores allow us to represent each observation (place in our dataset) in terms of the latent factors, providing a dimension-reduced representation of the data.</p>
              </div>
            </div>
            
            <!-- Advantages and Limitations -->
            <div>
              <h3 class="text-xl font-semibold mb-3 mt-8 text-gray-800 dark:text-gray-200 flex items-center">
                <i class="fas fa-balance-scale-left mr-2 text-amber-600 dark:text-amber-400"></i>
                <span class="px-3 py-1 text-xs font-semibold rounded-full bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-400 mr-2">Step 8</span>
                Advantages and Limitations of Factor Analysis
              </h3>
              <div class="text-gray-700 dark:text-gray-300 space-y-4">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <!-- Advantages -->
                  <div>
                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3 flex items-center">
                      <i class="fas fa-plus-circle text-green-500 mr-2"></i>
                      Advantages
                    </h4>
                    <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4">
                      <ul class="list-disc pl-5 space-y-2">
                        <li><strong>Data Reduction:</strong> Reduces large datasets to a smaller number of factors, making analysis more manageable</li>
                        <li><strong>Uncovers Latent Variables:</strong> Identifies underlying constructs that may not be directly observable</li>
                        <li><strong>Improves Interpretability:</strong> Makes data interpretation easier by grouping related variables</li>
                        <li><strong>Eliminates Multicollinearity:</strong> Addresses issues with correlated variables in further analyses</li>
                        <li><strong>Questionnaire Refinement:</strong> Can help improve survey design by identifying redundant questions</li>
                        <li><strong>Integrates with Other Methods:</strong> Factor scores can be used as inputs for other statistical analyses</li>
                      </ul>
                    </div>
                    
                    <div class="mt-4 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                      <p class="text-sm font-semibold text-blue-700 dark:text-blue-400 mb-2">Applications:</p>
                      <ul class="list-disc pl-5 text-sm space-y-1">
                        <li>Market research to understand consumer preferences</li>
                        <li>Psychology to identify personality traits</li>
                        <li>Education to measure academic abilities</li>
                        <li>Social sciences to explore complex social phenomena</li>
                        <li>Quality of life studies (like our analysis)</li>
                      </ul>
                    </div>
                  </div>
                  
                  <!-- Limitations -->
                  <div>
                    <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-3 flex items-center">
                      <i class="fas fa-minus-circle text-red-500 mr-2"></i>
                      Limitations
                    </h4>
                    <div class="bg-red-50 dark:bg-red-900/20 rounded-lg p-4">
                      <ul class="list-disc pl-5 space-y-2">
                        <li><strong>Subjectivity:</strong> Naming and interpreting factors relies heavily on researcher judgment</li>
                        <li><strong>No Unique Solution:</strong> Different rotation methods may yield different interpretations</li>
                        <li><strong>Requires Assumptions:</strong> Assumes linear relationships and normally distributed errors</li>
                        <li><strong>Sample Size Sensitivity:</strong> Results can be unreliable with small samples (rule of thumb: 10-15 observations per variable)</li>
                        <li><strong>Categorical Variables:</strong> Not directly applicable to categorical data</li>
                        <li><strong>Causality Not Established:</strong> Identifies correlations, not causal relationships</li>
                        <li><strong>Naming Challenge:</strong> Assigning meaningful names to factors can be difficult and subjective</li>
                      </ul>
                    </div>
                    
                    <div class="mt-4 bg-gray-50 dark:bg-gray-700/30 p-4 rounded-lg">
                      <p class="text-sm font-semibold mb-2">Mitigation Strategies:</p>
                      <ul class="list-disc pl-5 text-sm space-y-1">
                        <li>Use multiple factor extraction and rotation methods to check solution stability</li>
                        <li>Conduct confirmatory factor analysis after exploratory analysis</li>
                        <li>Validate results with split samples or new data</li>
                        <li>Combine statistical criteria with theoretical knowledge</li>
                      </ul>
                    </div>
                  </div>
                </div>
                
                <!-- Application to Our Analysis -->
                <div class="mt-6 border-l-4 border-indigo-500 pl-4 py-2 bg-indigo-50 dark:bg-indigo-900/20">
                  <p class="text-indigo-800 dark:text-indigo-200 font-medium">Application to Our Analysis</p>
                  <p class="mt-2">In our quality of life analysis, factor analysis successfully reduced 9 variables into 3 underlying factors explaining 62.4% of the variance. This provides a more manageable way to understand what determines the quality of life across different locations, revealing underlying patterns and relationships that might not be immediately obvious from the raw data.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Footer for Mathematical Explanation Tab -->
    <footer class="bg-gradient-to-br from-gray-900 via-purple-950 to-indigo-900 text-white py-12 mt-12 relative overflow-hidden">
      <!-- Animated background elements -->
      <div class="absolute inset-0 overflow-hidden">
        <div class="particles-js absolute inset-0 opacity-20" id="math-footer-particles"></div>
        <div class="absolute top-0 right-0 w-96 h-96 bg-blue-500/10 rounded-full filter blur-3xl animate-pulse-slow"></div>
        <div class="absolute bottom-0 left-0 w-96 h-96 bg-purple-500/10 rounded-full filter blur-3xl animate-pulse-slow" style="animation-delay: 2s"></div>
      </div>
      
      <!-- Border glow top -->
      <div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-purple-500/50 to-transparent"></div>
      
      <!-- Content container -->
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
          <!-- About Creator Section - Enhanced with 3D card -->
          <div class="space-y-4 perspective">
            <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-300">
              <i class="fas fa-user-circle mr-3 text-purple-400"></i>
              About Aditto Ahosan Kabbo
            </h3>
            <p class="text-gray-300 text-sm leading-relaxed">Data Enthusiast and Statistics Student at Pabna University of Science and Technology. Passionate about transforming raw data into actionable insights.</p>
            
            <!-- 3D interactive profile card -->
            <div class="profile-card bg-gradient-to-br from-purple-900/60 to-indigo-900/60 backdrop-blur-lg rounded-xl p-6 mt-4 border border-white/10 shadow-xl transform transition-all duration-500 hover:shadow-purple-500/20 group relative">
              <!-- Card tilt effect - JS will be added later -->
              <div class="absolute inset-0 bg-gradient-to-br from-purple-500/5 to-blue-500/5 opacity-0 group-hover:opacity-100 rounded-xl transition-opacity"></div>
              
              <!-- Animated profile picture -->
              <div class="relative w-32 h-32 mx-auto mb-5 rounded-full overflow-hidden profile-pic-container perspective">
                <div class="profile-pic-inner transform transition-all duration-700">
                  <img src="https://raw.githubusercontent.com/AdittoAhosanKabbo/AdittoAhosanKabbo/main/Assets/20221031_113233-removebg.png" 
                      alt="Aditto Ahosan Kabbo" 
                      class="w-full h-full object-cover rounded-full border-2 border-purple-400/70 shadow-lg"
                      onerror="this.src='https://avatars.githubusercontent.com/u/AdittoAhosanKabbo'"
                      style="aspect-ratio: 1/1; object-fit: cover; object-position: center top;">
                </div>
                
                <!-- Glowing ring animation -->
                <div class="absolute inset-0 border-2 border-transparent rounded-full animate-spin-slow opacity-0 group-hover:opacity-100" style="background: linear-gradient(45deg, transparent, rgba(147, 51, 234, 0.3), transparent); animation-duration: 3s;"></div>
              </div>
              
              <!-- Animated title with typewriter effect -->
              <div class="text-center h-6 mb-2">
                <span class="inline-block font-medium text-purple-300 typewriter-container overflow-hidden whitespace-nowrap" data-typing="🎓 Statistics Student,💻 Data Enthusiast,📊 Skilled in Visualization ">🎓 Statistics Student</span>
              </div>
              
              <!-- Interactive buttons that appear on hover -->
              <div class="mt-4 flex justify-center space-x-3 opacity-0 group-hover:opacity-100 transition-opacity">
                <button class="btn-glow px-3 py-1 rounded-full bg-purple-600/30 hover:bg-purple-600/50 text-xs font-medium border border-purple-500/30 transition-all flex items-center" onclick="window.open('https://github.com/AdittoAhosanKabbo', '_blank')">
                  <i class="fab fa-github mr-1"></i> GitHub
                </button>
                <button class="btn-glow px-3 py-1 rounded-full bg-blue-600/30 hover:bg-blue-600/50 text-xs font-medium border border-blue-500/30 transition-all flex items-center" onclick="window.open('https://www.linkedin.com/in/adittoahosankabbo/', '_blank')">
                  <i class="fab fa-linkedin mr-1"></i> LinkedIn
                </button>
              </div>
            </div>
          </div>
          
          <!-- Enhanced Connect with me - Interactive 3D social links -->
          <div class="space-y-5">
            <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300">
              <i class="fas fa-link mr-3 text-blue-400"></i>
              Connect with me
            </h3>
            <ul class="space-y-3 text-gray-300">
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-linkedin text-blue-400 w-6"></i>
                <a href="https://www.linkedin.com/in/adittoahosankabbo/" target="_blank" class="ml-2 hover:underline">LinkedIn</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-github text-gray-400 w-6"></i>
                <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="ml-2 hover:underline">GitHub</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-facebook text-blue-500 w-6"></i>
                <a href="https://www.facebook.com/Adittoahosan" target="_blank" class="ml-2 hover:underline">Facebook</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-kaggle text-cyan-500 w-6"></i>
                <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="ml-2 hover:underline">Kaggle</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="far fa-envelope text-red-400 w-6"></i>
                <a href="mailto:adittoahosankabbo@gmail.com" class="ml-2 hover:underline">adittoahosankabbo@gmail.com</a>
              </li>
              <li class="flex items-center hover:text-white transition-colors">
                <i class="fab fa-whatsapp text-green-400 w-6"></i>
                <a href="https://wa.me/8801749018051?text=hello" target="_blank" class="ml-2 hover:underline">WhatsApp</a>
              </li>
            </ul>
          </div>
          
          <!-- Skills & Project Links -->
          <div class="space-y-4">
            <h3 class="text-xl font-bold flex items-center">
              <i class="fas fa-laptop-code mr-2 text-green-400"></i>
              Skills & Projects
            </h3>
            <div class="grid grid-cols-2 gap-2 mb-4">
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fab fa-python text-xl text-blue-400"></i>
                <p class="text-xs mt-1">Python</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-database text-xl text-blue-500"></i>
                <p class="text-xs mt-1">SQL</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fab fa-r-project text-xl text-blue-300"></i>
                <p class="text-xs mt-1">R</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-table text-xl text-green-400"></i>
                <p class="text-xs mt-1">Excel</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-chart-bar text-xl text-purple-400"></i>
                <p class="text-xs mt-1">Power BI</p>
              </div>
              <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
                <i class="fas fa-chart-line text-xl text-purple-300"></i>
                <p class="text-xs mt-1">SPSS</p>
              </div>
            </div>
            <p class="text-gray-300 text-sm">View more data analysis and statistics projects on my GitHub and Kaggle profiles.</p>
            <div class="mt-4">
              <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:from-purple-700 hover:to-indigo-700 transition-all inline-flex items-center">
                <i class="fab fa-github mr-2"></i> View GitHub Projects
              </a>
            </div>
          </div>
        </div>
        
        <div class="mt-8 pt-6 border-t border-white/10 flex flex-col md:flex-row justify-between items-center">
          <p class="text-gray-400 text-sm">© 2025 Aditto Ahosan Kabbo. All rights reserved.</p>
          <div class="flex space-x-4 mt-4 md:mt-0">
            <a href="https://www.hackerrank.com/profile/aditahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-hackerrank"></i>
            </a>
            <a href="https://www.reddit.com/user/AhosanKabbo/" target="_blank" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-reddit-alien"></i>
            </a>
            <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
              <i class="fab fa-kaggle"></i>
            </a>
          </div>
        </div>
      </div>
      
      <!-- Footer particles container -->
      <div id="math-footer-particles-js" class="absolute inset-0 opacity-20"></div>
    </footer>
  </div>
  
  <!-- Report Tab Content -->
  <div id="reportTabContent" class="main-tab-content hidden">
    <div class="report-container">
      <div class="report-header relative overflow-hidden min-h-[240px]">
      <!-- Dynamic Animated Background -->
      <div class="absolute inset-0 bg-gradient-to-br from-indigo-600 via-purple-600 to-blue-500 background-animate"></div>
      
      <!-- Animated particles overlay -->
      <div id="particles-header" class="absolute inset-0 opacity-60"></div>
      
      <!-- Geometric decorations -->
      <div class="absolute top-0 right-0 w-96 h-96 bg-gradient-to-br from-pink-500/30 to-purple-500/30 rounded-full filter blur-3xl transform translate-x-1/3 -translate-y-1/3 animate-pulse-slow"></div>
      <div class="absolute bottom-0 left-0 w-96 h-96 bg-gradient-to-tr from-blue-500/30 to-teal-500/30 rounded-full filter blur-3xl transform -translate-x-1/3 translate-y-1/3 animate-pulse-slow" style="animation-delay: 2s"></div>
      
      <!-- Animated shapes -->
      <div class="header-shape shape-1 absolute"></div>
      <div class="header-shape shape-2 absolute"></div>
      <div class="header-shape shape-3 absolute"></div>
      
      <!-- Header content with 3D effect -->
      <div class="relative z-10 p-8 perspective-container" id="headerContent">
        <!-- Glassmorphism card for title -->
        <div class="text-center p-6 rounded-2xl bg-white/10 backdrop-blur-md border border-white/20 shadow-xl transform transition-all duration-500 hover:scale-105 header-card">
          <h1 class="text-4xl md:text-5xl font-bold mb-2 text-white text-shadow-glow tracking-wide header-title">Factor Analysis Report</h1>
          <div class="h-6 mb-3">
            <p class="text-white/90 text-lg typewriter"></p>
          </div>
          
          <!-- Interactive metric cards -->
          <div class="flex flex-nowrap justify-center gap-5 mt-8">
            <div class="metric-card rounded-2xl bg-white/15 backdrop-blur-md p-5 border border-white/20 flex flex-col items-center justify-between transition-all duration-500 cursor-pointer hover:bg-white/25 hover:scale-105 hover:shadow-glow relative group w-44 h-44" data-metric="samples">
              <!-- Animated background gradient -->
              <div class="absolute inset-0 bg-gradient-to-r from-blue-500/0 via-blue-500/30 to-blue-500/0 opacity-0 group-hover:opacity-100 rounded-2xl blur-sm transition-opacity animate-pulse-slow"></div>
              
              <!-- Particle effect container -->
              <div class="absolute inset-0 overflow-hidden rounded-2xl particle-container opacity-0 group-hover:opacity-30"></div>
              
              <!-- Empty top spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- 3D Card effect wrapper -->
              <div class="card-content relative z-10 flex flex-col items-center transform transition-transform duration-300">
                <!-- Icon with glow effect -->
                <div class="icon-wrapper relative mb-3">
                  <div class="absolute inset-0 bg-blue-400/30 rounded-full blur-md scale-0 group-hover:scale-150 transition-transform duration-700"></div>
                  <i class="fas fa-database text-3xl text-blue-200 relative"></i>
                </div>
                
                <!-- Value with counting animation -->
                <div class="font-bold text-white text-3xl mb-3 relative z-10 count-up value-pulse" data-target="329">0</div>
                
                <!-- Label with shimmer effect -->
                <div class="text-blue-100 text-sm font-medium relative z-10 label-shimmer w-full text-center">Samples</div>
              </div>
              
              <!-- Empty bottom spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- Corner accent -->
              <div class="absolute top-0 right-0 w-4 h-4 bg-blue-400/50 rounded-bl-xl rounded-tr-xl transform -translate-y-0.5 translate-x-0.5"></div>
            </div>
            
            <div class="metric-card rounded-2xl bg-white/15 backdrop-blur-md p-5 border border-white/20 flex flex-col items-center justify-between transition-all duration-500 cursor-pointer hover:bg-white/25 hover:scale-105 hover:shadow-glow relative group w-44 h-44" data-metric="variables">
              <!-- Animated background gradient -->
              <div class="absolute inset-0 bg-gradient-to-r from-purple-500/0 via-purple-500/30 to-purple-500/0 opacity-0 group-hover:opacity-100 rounded-2xl blur-sm transition-opacity animate-pulse-slow"></div>
              
              <!-- Particle effect container -->
              <div class="absolute inset-0 overflow-hidden rounded-2xl particle-container opacity-0 group-hover:opacity-30"></div>
              
              <!-- Empty top spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- 3D Card effect wrapper -->
              <div class="card-content relative z-10 flex flex-col items-center transform transition-transform duration-300">
                <!-- Icon with glow effect -->
                <div class="icon-wrapper relative mb-3">
                  <div class="absolute inset-0 bg-purple-400/30 rounded-full blur-md scale-0 group-hover:scale-150 transition-transform duration-700"></div>
                  <i class="fas fa-table text-3xl text-purple-200 relative"></i>
                </div>
                
                <!-- Value with counting animation -->
                <div class="font-bold text-white text-3xl mb-3 relative z-10 count-up value-pulse" data-target="9">0</div>
                
                <!-- Label with shimmer effect -->
                <div class="text-purple-100 text-sm font-medium relative z-10 label-shimmer w-full text-center">Variables Analyzed</div>
              </div>
              
              <!-- Empty bottom spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- Corner accent -->
              <div class="absolute top-0 right-0 w-4 h-4 bg-purple-400/50 rounded-bl-xl rounded-tr-xl transform -translate-y-0.5 translate-x-0.5"></div>
            </div>
            
            <div class="metric-card rounded-2xl bg-white/15 backdrop-blur-md p-5 border border-white/20 flex flex-col items-center justify-between transition-all duration-500 cursor-pointer hover:bg-white/25 hover:scale-105 hover:shadow-glow relative group w-44 h-44" data-metric="factors">
              <!-- Animated background gradient -->
              <div class="absolute inset-0 bg-gradient-to-r from-green-500/0 via-green-500/30 to-green-500/0 opacity-0 group-hover:opacity-100 rounded-2xl blur-sm transition-opacity animate-pulse-slow"></div>
              
              <!-- Particle effect container -->
              <div class="absolute inset-0 overflow-hidden rounded-2xl particle-container opacity-0 group-hover:opacity-30"></div>
              
              <!-- Empty top spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- 3D Card effect wrapper -->
              <div class="card-content relative z-10 flex flex-col items-center transform transition-transform duration-300">
                <!-- Icon with glow effect -->
                <div class="icon-wrapper relative mb-3">
                  <div class="absolute inset-0 bg-green-400/30 rounded-full blur-md scale-0 group-hover:scale-150 transition-transform duration-700"></div>
                  <i class="fas fa-chart-column text-3xl text-green-200 relative"></i>
                </div>
                
                <!-- Value with counting animation -->
                <div class="font-bold text-white text-3xl mb-3 relative z-10 count-up value-pulse" data-target="3">0</div>
                
                <!-- Label with shimmer effect -->
                <div class="text-green-100 text-sm font-medium relative z-10 label-shimmer w-full text-center">Factors Extracted</div>
              </div>
              
              <!-- Empty bottom spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- Corner accent -->
              <div class="absolute top-0 right-0 w-4 h-4 bg-green-400/50 rounded-bl-xl rounded-tr-xl transform -translate-y-0.5 translate-x-0.5"></div>
            </div>
            
            <div class="metric-card rounded-2xl bg-white/15 backdrop-blur-md p-5 border border-white/20 flex flex-col items-center justify-between transition-all duration-500 cursor-pointer hover:bg-white/25 hover:scale-105 hover:shadow-glow relative group w-44 h-44" data-metric="kmo">
              <!-- Animated background gradient -->
              <div class="absolute inset-0 bg-gradient-to-r from-amber-500/0 via-amber-500/30 to-amber-500/0 opacity-0 group-hover:opacity-100 rounded-2xl blur-sm transition-opacity animate-pulse-slow"></div>
              
              <!-- Particle effect container -->
              <div class="absolute inset-0 overflow-hidden rounded-2xl particle-container opacity-0 group-hover:opacity-30"></div>
              
              <!-- Empty top spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- 3D Card effect wrapper -->
              <div class="card-content relative z-10 flex flex-col items-center transform transition-transform duration-300">
                <!-- Icon with glow effect -->
                <div class="icon-wrapper relative mb-3">
                  <div class="absolute inset-0 bg-amber-400/30 rounded-full blur-md scale-0 group-hover:scale-150 transition-transform duration-700"></div>
                  <i class="fas fa-check-circle text-3xl text-amber-200 relative"></i>
                </div>
                
                <!-- Value with counting animation -->
               
                <div class="font-bold text-white text-3xl mb-3 relative z-10 " data-target="62.4" data-suffix="%">62.4%</div>
                <!-- Label with shimmer effect -->
                <div class="text-amber-100 text-sm font-medium relative z-10 label-shimmer w-full text-center">Variance Exoplained</div>
              </div>
              
              <!-- Empty bottom spacer for alignment -->
              <div class="h-2"></div>
              
              <!-- Corner accent -->
              <div class="absolute top-0 right-0 w-4 h-4 bg-amber-400/50 rounded-bl-xl rounded-tr-xl transform -translate-y-0.5 translate-x-0.5"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Add additional script for the enhanced header features -->
            
    <script>
      // Add to the existing document DOMContentLoaded
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize the header with existing functions
        initHeaderEffects();
        initHeaderParticles();
        initTypingEffect();
        initCountUpAnimation();
        init3DEffect();
      });
      
      // Initialize 3D tilt effect on the header card
      function init3DEffect() {
        const headerContent = document.getElementById('headerContent');
        const headerCard = document.querySelector('.header-card');
        
        if (!headerContent || !headerCard) return;
        
        headerContent.addEventListener('mousemove', (e) => {
          const rect = headerContent.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          
          const centerX = rect.width / 2;
          const centerY = rect.height / 2;
          
          const rotateX = (y - centerY) / 30;
          const rotateY = (centerX - x) / 30;
          
          headerCard.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.05, 1.05, 1.05)`;
        });
        
        headerContent.addEventListener('mouseleave', () => {
          headerCard.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)';
        });
      }
      
      // Initialize typing effect for the subtitle
      function initTypingEffect() {
        const typewriter = document.querySelector('.typewriter');
        if (!typewriter) return;
        
        const text = "Advanced statistical analysis with visualizations and interactive elements";
        typewriter.textContent = '';
        
        let charIndex = 0;
        function typeText() {
          if (charIndex < text.length) {
            typewriter.textContent += text.charAt(charIndex);
            charIndex++;
            setTimeout(typeText, 50);
          }
        }
        
        // Start typing after a brief delay
        setTimeout(typeText, 500);
      }
      
      // Initialize count-up animation for metrics
      function initCountUpAnimation() {
        // Regular count up for integers
        document.querySelectorAll('.count-up').forEach(counter => {
          const target = parseInt(counter.getAttribute('data-target'));
          const duration = 2000; // 2 seconds
          
          let startTime = null;
          
          function animateCount(timestamp) {
            if (!startTime) startTime = timestamp;
            const progress = timestamp - startTime;
            const percentage = Math.min(progress / duration, 1);
            
            const currentCount = Math.floor(percentage * target);
            counter.textContent = currentCount;
            
            if (percentage < 1) {
              requestAnimationFrame(animateCount);
            } else {
              counter.textContent = target;
            }
          }
          
          requestAnimationFrame(animateCount);
        });
        
        // Count up for decimal values (like KMO)
        document.querySelectorAll('.count-up-decimal').forEach(counter => {
          const target = parseFloat(counter.getAttribute('data-target'));
          const duration = 2000; // 2 seconds
          
          let startTime = null;
          
          function animateCount(timestamp) {
            if (!startTime) startTime = timestamp;
            const progress = timestamp - startTime;
            const percentage = Math.min(progress / duration, 1);
            
            const currentCount = percentage * target;
            counter.textContent = currentCount.toFixed(3);
            
            if (percentage < 1) {
              requestAnimationFrame(animateCount);
            } else {
              counter.textContent = target.toFixed(3);
            }
          }
          
          requestAnimationFrame(animateCount);
        });
      }
      






  // Initialize particle effects for the header background
      function initHeaderParticles() {
        if (typeof particlesJS === 'function') {
          particlesJS("particles-header", {
            particles: {
              number: {
                value: 30,
                density: {
                  enable: true,
                  value_area: 800
                }
              },
              color: {
                value: "#ffffff"
              },
              shape: {
                type: "circle",
                stroke: {
                  width: 0,
                  color: "#000000"
                }
              },
              opacity: {
                value: 0.3,
                random: true,
                anim: {
                  enable: true,
                  speed: 1,
                  opacity_min: 0.1,
                  sync: false
                }
              },
              size: {
                value: 3,
                random: true,
                anim: {
                  enable: true,
                  speed: 2,
                  size_min: 0.1,
                  sync: false
                }
              },
              line_linked: {
                enable: true,
                distance: 150,
                color: "#ffffff",
                opacity: 0.2,
                width: 1
              },
              move: {
                enable: true,
                speed: 1,
                direction: "none",
                random: true,
                straight: false,
                out_mode: "out",
                bounce: false,
                attract: {
                  enable: false,
                  rotateX: 600,
                  rotateY: 1200
                }
              }
            },
            interactivity: {
              detect_on: "canvas",
              events: {
                onhover: {
                  enable: true,
                  mode: "grab"
                },
                onclick: {
                  enable: true,
                  mode: "push"
                },
                resize: true
              },
              modes: {
                grab: {
                  distance: 140,
                  line_linked: {
                    opacity: 0.5
                  }
                },
                push: {
                  particles_nb: 3
                }
              }
            },
            retina_detect: true
          });
        }
      }
      
      // Add mouse parallax effect to header elements
      function initHeaderEffects() {
        const header = document.querySelector('.report-header');
        
        if (!header) return;
        
        header.addEventListener('mousemove', (e) => {
          const x = e.clientX / window.innerWidth;
          const y = e.clientY / window.innerHeight;
          
          const shapes = document.querySelectorAll('.header-shape');
          shapes.forEach((shape, index) => {
            const speed = (index + 1) * 20;
            const xOffset = (x * speed) - (speed / 2);
            const yOffset = (y * speed) - (speed / 2);
            shape.style.transform = `translate(${xOffset}px, ${yOffset}px)`;
          });
          
          // Add subtle parallax to other elements
          const title = document.querySelector('.header-title');
          if (title) {
            title.style.transform = `translate(${x * 10 - 5}px, ${y * 10 - 5}px)`;
          }
        });
        
        // Add click effects to metric cards
        document.querySelectorAll('.metric-card').forEach(card => {
          card.addEventListener('click', function() {
            this.classList.add('scale-90');
            setTimeout(() => {
              this.classList.remove('scale-90');
            }, 150);
            
            // Pulse effect on click
            const type = this.getAttribute('data-metric');
            const value = document.querySelector(`.count-up[data-target="${type}"]`) || 
                        document.querySelector(`.count-up-decimal[data-target="${type}"]`);
            
            if (value) {
              value.classList.add('scale-125', 'text-shadow-glow');
              setTimeout(() => {
                value.classList.remove('scale-125', 'text-shadow-glow');
              }, 300);
            }
          });
        });
      }
    </script>
      <div class="p-6">













      
      <!-- Quick Summary & Chart -->
      <div class="key-finding mb-4">
        <strong>Key Finding:</strong> <span class="highlight">3 factors</span> explain <span class="highlight">62.4%</span> of variance.
      </div>
      
      <!-- Main Report Sections -->
      <details open>
        <summary class="section-title">🔍 1. Data Preparation</summary>
        <div class="content-box">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <h4 class="font-semibold mb-2">Dataset Overview</h4>
              <ul class="list-disc pl-5 space-y-2">
                <li><span class="tooltip">Initial Data<span class="tooltip-text">Total observations and variables before preprocessing</span></span>: 329 rows, 10 columns</li>
                <li><span class="tooltip">Columns<span class="tooltip-text">Variables in the dataset</span></span>: climate, housing, health, crime, trans, educate, arts, recreate, econ, id</li>
                <li><span class="tooltip">Preprocessing<span class="tooltip-text">Data cleaning steps taken</span></span>: Dropped <code class="bg-gray-100 px-1">id</code> column</li>
                <li><span class="tooltip">Missing Values<span class="tooltip-text">How missing data was handled</span></span>: None found</li>
                <li><span class="tooltip">Final Dataset<span class="tooltip-text">Dataset dimensions after cleaning</span></span>: 329 rows × 9 columns</li>
              </ul>
            </div>
            <div>
              <h4 class="font-semibold mb-2">Variables Overview</h4>
              <div class="overflow-auto max-h-48">
                <table class="w-full">
                  <thead>
                    <tr>
                      <th>Variable</th>
                      <th>Role in Analysis</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="interactive-cell">
                      <td>climate</td>
                      <td><span class="badge badge-info">Factor 3</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>housing</td>
                      <td><span class="badge">Factor 1</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>health</td>
                      <td><span class="badge">Factor 1</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>crime</td>
                      <td><span class="badge badge-warning">Factor 2</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>trans</td>
                      <td><span class="badge">Factor 1</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>educate</td>
                      <td><span class="badge badge-warning">Factor 2</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>arts</td>
                      <td><span class="badge">Factor 1</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>recreate</td>
                      <td><span class="badge">Factor 1</span></td>
                    </tr>
                    <tr class="interactive-cell">
                      <td>econ</td>
                      <td><span class="badge badge-warning">Factor 2</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </details>
      
      <details>
        <summary class="section-title">🧪 2. Suitability Tests</summary>
        <div class="content-box">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
              <h4 class="font-semibold mb-3">Bartlett's Test of Sphericity</h4>
              <div class="stat-card text-center">
                <div class="text-2xl font-bold">839.43</div>
                <div class="text-sm text-gray-500">Chi-square value</div>
              </div>
              <div class="stat-card text-center">
                <div class="text-2xl font-bold text-green-600">5.99e-153</div>
                <div class="text-sm text-gray-500">p-value</div>
              </div>
              <div class="p-3 mt-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                <span class="font-semibold">Conclusion: </span>
                <span class="text-green-700">Data is suitable for factor analysis</span>
              </div>
            </div>
            
            <div>
              <h4 class="font-semibold mb-3">Kaiser-Meyer-Olkin (KMO) Test</h4>
              <div class="text-center">
                <div class="relative inline-block w-40 h-40">
                  <svg class="w-full h-full" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" fill="#f0f2f5" stroke="#e9ecef" stroke-width="5"></circle>
                    <path d="M50 5 A45 45 0 1 1 5 50" stroke="#4361ee" stroke-width="10" fill="none" stroke-linecap="round"></path>
                    <text x="50" y="50" font-size="18" text-anchor="middle" dy="6" font-weight="bold">0.703</text>
                  </svg>
                </div>
                <div class="mt-2 text-md">
                  <span class="font-semibold">Interpretation: </span>Good sampling adequacy
                </div>
              </div>
              <div class="grid grid-cols-5 gap-1 mt-3">
                <div class="text-center text-xs p-1">0.00</div>
                <div class="text-center text-xs p-1">0.25</div>
                <div class="text-center text-xs p-1">0.50</div>
                <div class="text-center text-xs p-1">0.75</div>
                <div class="text-center text-xs p-1">1.00</div>
              </div>
              <div class="h-3 bg-gray-200 rounded-full w-full relative">
                <div class="h-3 bg-gradient-to-r from-red-400 via-yellow-300 to-green-500 rounded-full" style="width: 70.3%">
                  <div class="absolute -bottom-4 left-[70.3%] transform -translate-x-1/2">
                    <div class="w-3 h-3 bg-blue-600 rounded-full"></div>
                  </div>
                </div>
              </div>
              <div class="grid grid-cols-3 gap-1 mt-4 text-xs text-center">
                <div class="p-1 bg-red-100 rounded">Poor<br>&lt;0.5</div>
                <div class="p-1 bg-yellow-100 rounded">Acceptable<br>0.5-0.7</div>
                <div class="p-1 bg-green-100 rounded">Good<br>&gt;0.7</div>
              </div>
            </div>
          </div>
        </div>
      </details>
      
      <details>
        <summary class="section-title">📐 3. Factor Determination</summary>
        <div class="content-box">
          <div class="flex flex-col md:flex-row gap-6">
            <div class="flex-1">
              <h4 class="font-semibold mb-3">Eigenvalues (Kaiser Criterion)</h4>
              <table class="w-full">
                <thead>
                  <tr>
                    <th>Factor</th>
                    <th>Eigenvalue</th>
                    <th>Retained</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="interactive-cell">
                    <td>1</td>
                    <td class="bold-value">3.298</td>
                    <td><span class="text-green-500 font-bold">✓</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>2</td>
                    <td class="bold-value">1.214</td>
                    <td><span class="text-green-500 font-bold">✓</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>3</td>
                    <td class="bold-value">1.196</td>
                    <td><span class="text-green-500 font-bold">✓</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>4–9</td>
                    <td>&lt; 1</td>
                    <td><span class="text-red-500">✗</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div class="flex-1">
              <h4 class="font-semibold mb-3">Scree Plot</h4>
              <div class="chart-container">
                <div class="chart-container" style="position: relative; height: 300px; width: 100%; margin: 1rem 0;">
                <canvas id="screePlot"></canvas>
            </div>
              </div>
              <div class="mt-2 text-sm text-gray-600">
                <p>Scree plot shows an elbow at factor 4, confirming 3-factor retention.</p>
              </div>
            </div>
          </div>
        </div>
      </details>
      
      <details>
        <summary class="section-title">📊 4. Factor Loadings</summary>
        <div class="content-box">
          <div class="tabs">
            <div class="tab active" data-tab="table">Loadings Table</div>
            <div class="tab" data-tab="heatmap">Heatmap View</div>
            <div class="tab" data-tab="grouped">Grouped Factors</div>
          </div>
          
          <div class="tab-content active" id="table">
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead>
                  <tr>
                    <th>Variable</th>
                    <th>Factor 1</th>
                    <th>Factor 2</th>
                    <th>Factor 3</th>
                    <th>Main Loading</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="interactive-cell">
                    <td>climate</td>
                    <td>0.287</td>
                    <td>0.076</td>
                    <td class="font-bold text-blue-600">0.841</td>
                    <td><span class="badge badge-info">Factor 3</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>housing</td>
                    <td class="font-bold text-indigo-600">0.698</td>
                    <td>0.153</td>
                    <td>0.084</td>
                    <td><span class="badge">Factor 1</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>health</td>
                    <td class="font-bold text-indigo-600">0.744</td>
                    <td>-0.410</td>
                    <td>-0.020</td>
                    <td><span class="badge">Factor 1</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>crime</td>
                    <td>0.471</td>
                    <td class="font-bold text-pink-600">0.522</td>
                    <td>0.135</td>
                    <td><span class="badge badge-warning">Factor 2</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>trans</td>
                    <td class="font-bold text-indigo-600">0.681</td>
                    <td>-0.156</td>
                    <td>-0.148</td>
                    <td><span class="badge">Factor 1</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>educate</td>
                    <td>0.498</td>
                    <td class="font-bold text-pink-600">-0.498</td>
                    <td>-0.253</td>
                    <td><span class="badge badge-warning">Factor 2</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>arts</td>
                    <td class="font-bold text-indigo-600">0.860</td>
                    <td>-0.115</td>
                    <td>0.012</td>
                    <td><span class="badge">Factor 1</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>recreate</td>
                    <td class="font-bold text-indigo-600">0.642</td>
                    <td>0.322</td>
                    <td>0.044</td>
                    <td><span class="badge">Factor 1</span></td>
                  </tr>
                  <tr class="interactive-cell">
                    <td>econ</td>
                    <td>0.298</td>
                    <td class="font-bold text-pink-600">0.595</td>
                    <td>-0.533</td>
                    <td><span class="badge badge-warning">Factor 2</span></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <div class="tab-content" id="heatmap">
            <div class="chart-container bg-white rounded-lg shadow-sm p-4" style="height: 500px;">
              <canvas id="heatmapChart" style="width: 100%; height: 100%;"></canvas>
            </div>
          </div>
          
          <div class="tab-content" id="grouped">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="p-4 bg-indigo-50 rounded-lg border-l-4 border-indigo-500">
                <h4 class="font-bold mb-2 text-indigo-700">Factor 1: Quality of Life/Amenities</h4>
                <ul class="list-disc pl-5">
                  <li>housing <span class="text-sm text-gray-600">(0.698)</span></li>
                  <li>health <span class="text-sm text-gray-600">(0.744)</span></li>
                  <li>trans <span class="text-sm text-gray-600">(0.681)</span></li>
                  <li>arts <span class="text-sm text-gray-600">(0.860)</span></li>
                  <li>recreate <span class="text-sm text-gray-600">(0.642)</span></li>
                </ul>
              </div>
              
              <div class="p-4 bg-pink-50 rounded-lg border-l-4 border-pink-500">
                <h4 class="font-bold mb-2 text-pink-700">Factor 2: Socioeconomic</h4>
                <ul class="list-disc pl-5">
                  <li>crime <span class="text-sm text-gray-600">(0.522)</span></li>
                  <li>educate <span class="text-sm text-gray-600">(-0.498)</span></li>
                  <li>econ <span class="text-sm text-gray-600">(0.595)</span></li>
                </ul>
              </div>
              
              <div class="p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                <h4 class="font-bold mb-2 text-blue-700">Factor 3: Climate</h4>
                <ul class="list-disc pl-5">
                  <li>climate <span class="text-sm text-gray-600">(0.841)</span></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </details>
      
      <details>
        <summary class="section-title">📈 5. Communalities</summary>
        <div class="content-box">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-semibold mb-4 text-lg text-gray-700 dark:text-gray-200">Communalities Distribution</h4>
              <div class="chart-container relative rounded-lg overflow-hidden bg-white dark:bg-gray-800 shadow-sm" style="height: 380px;">
                <div class="chart-container" style="position: relative; height: 400px; width: 100%; margin: 1rem 0;">
                <canvas id="communalitiesChart"></canvas>
            </div>
                <div class="absolute top-2 right-2 flex space-x-2">
                  <button class="chart-action bg-white/80 dark:bg-gray-700/80 hover:bg-white dark:hover:bg-gray-700 p-1 rounded text-gray-500 dark:text-gray-400 transition-all">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <button class="chart-action bg-white/80 dark:bg-gray-700/80 hover:bg-white dark:hover:bg-gray-700 p-1.5 rounded-full text-blue-600 dark:text-blue-400 shadow-sm transition-all" data-action="sort" title="Sort values">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12" />
                    </svg>
                  </button>
                </div>
              </div>

              
            </div>
            
            <div>
              <h4 class="font-semibold mb-4 text-lg text-gray-700 dark:text-gray-200">Communality Values</h4>
              <div class="overflow-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm" style="max-height: 400px;">
                <table class="w-full bg-white dark:bg-gray-800">
                  <thead class="bg-gray-50 dark:bg-gray-700">
                    <tr>
                      <th class="py-3 px-4 text-left font-medium text-gray-700 dark:text-gray-300">Variable</th>
                      <th class="py-3 px-4 text-left font-medium text-gray-700 dark:text-gray-300">Communality</th>
                      <th class="py-3 px-4 text-left font-medium text-gray-700 dark:text-gray-300">Interpretation</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">climate</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-emerald-500" style="width: 79.5%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.795</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400">Excellent</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">housing</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-indigo-500" style="width: 51.8%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.518</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400">Good</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">health</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-teal-500" style="width: 72.2%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.722</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400">Excellent</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">crime</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-orange-500" style="width: 51.2%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.512</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400">Good</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">trans</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-blue-500" style="width: 51.0%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.510</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400">Good</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">educate</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-pink-500" style="width: 56.1%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.561</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400">Good</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">arts</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-emerald-500" style="width: 75.4%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.754</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400">Excellent</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">recreate</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-violet-500" style="width: 51.7%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.517</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400">Good</span></td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700">
                      <td class="py-3 px-4">econ</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-green-500" style="width: 72.8%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.728</span>
                        </div>
                      </td>
                      <td class="py-3 px-4"><span class="px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400">Excellent</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="mt-6 grid grid-cols-3 gap-4">
            <div class="p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg border-l-4 border-blue-500">
              <p class="text-gray-700 dark:text-gray-300 font-medium">Most communalities > 0.5, indicating good factor explanation of variable variance.</p>
            </div>
            <div class="p-4 bg-green-50 dark:bg-green-900/10 rounded-lg border-l-4 border-green-500">
              <div class="font-semibold text-green-700 dark:text-green-400">Excellent</div>
              <div class="text-sm text-gray-600 dark:text-gray-300">Values > 0.7</div>
            </div>
            <div class="p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg border-l-4 border-blue-500">
              <div class="font-semibold text-blue-700 dark:text-blue-400">Good</div>
              <div class="text-sm text-gray-600 dark:text-gray-300">Values > 0.5</div>
            </div>
          </div>
        </div>
      </details>
      
      <details>
        <summary class="section-title">📉 6. Variance Explained</summary>
        <div class="content-box">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <h4 class="font-semibold mb-4 text-lg text-gray-700 dark:text-gray-200">Variance Distribution</h4>
              <div class="chart-container relative rounded-lg overflow-hidden bg-white dark:bg-gray-800 shadow-sm" style="height: 380px;">
                <div class="chart-container" style="position: relative; height: 400px; width: 100%; margin: 1rem 0;">
                <canvas id="varianceExplainedChart"></canvas>
            </div>
              </div>
            </div>
            
            <div>
              <h4 class="font-semibold mb-4 text-lg text-gray-700 dark:text-gray-200">Variance Detail</h4>
              <div class="overflow-auto rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm" style="max-height: 380px;">
                <table class="w-full bg-white dark:bg-gray-800">
                  <thead class="bg-gray-50 dark:bg-gray-700">
                    <tr>
                      <th class="py-3 px-4 text-left font-medium text-gray-700 dark:text-gray-300">Factor</th>
                      <th class="py-3 px-4 text-left font-medium text-gray-700 dark:text-gray-300">Variance</th>
                      <th class="py-3 px-4 text-left font-medium text-gray-700 dark:text-gray-300">Proportional Var</th>
                      <th class="py-3 px-4 text-left font-medium text-gray-700 dark:text-gray-300">Cumulative Var</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="border-t border-gray-200 dark:border-gray-700 hover:bg-blue-50 dark:hover:bg-blue-900/10 transition-colors duration-150 variance-row" data-index="0">
                      <td class="py-3 px-4 font-medium">Factor 1</td>
                      <td class="py-3 px-4 text-right">3.298</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-indigo-500 variance-progress-bar" style="width: 36.64%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.3664</span>
                        </div>
                      </td>
                      <td class="py-3 px-4 text-right font-medium">0.3664</td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700 hover:bg-pink-50 dark:hover:bg-pink-900/10 transition-colors duration-150 variance-row" data-index="1">
                      <td class="py-3 px-4 font-medium">Factor 2</td>
                      <td class="py-3 px-4 text-right">1.214</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-pink-500 variance-progress-bar" style="width: 13.48%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.1348</span>
                        </div>
                      </td>
                      <td class="py-3 px-4 text-right font-medium">0.5012</td>
                    </tr>
                    <tr class="border-t border-gray-200 dark:border-gray-700 hover:bg-cyan-50 dark:hover:bg-cyan-900/10 transition-colors duration-150 variance-row" data-index="2">
                      <td class="py-3 px-4 font-medium">Factor 3</td>
                      <td class="py-3 px-4 text-right">1.106</td>
                      <td class="py-3 px-4">
                        <div class="flex items-center">
                          <div class="progress-wrapper mr-3 flex-grow bg-gray-200 dark:bg-gray-600 rounded-full h-3">
                            <div class="h-full rounded-full bg-cyan-500 variance-progress-bar" style="width: 12.28%"></div>
                          </div>
                          <span class="text-sm font-medium text-right w-12">0.1228</span>
                        </div>
                      </td>
                      <td class="py-3 px-4 text-right font-medium">0.6240</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              
              <div class="mt-6 p-5 rounded-xl bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 border border-blue-100 dark:border-blue-900/30 shadow-sm">
                <h4 class="font-bold text-gray-800 dark:text-gray-200">Total Variance Explained: <span class="text-2xl text-indigo-600 dark:text-indigo-400">62.4%</span></h4>
                <div class="mt-3">
                  <div class="h-6 w-full bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-blue-500" style="width: 62.4%"></div>
                  </div>
                  <div class="flex justify-between text-xs mt-2 text-gray-600 dark:text-gray-400">
                    <span>0%</span>
                    <span>25%</span>
                    <span>50%</span>
                    <span>75%</span>
                    <span>100%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </details>
      
      <details>
        <summary class="section-title">🔧 7. Practical Implications</summary>
        <div class="content-box">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="p-5 bg-gradient-to-br from-indigo-50 to-blue-50 rounded-lg">
              <div class="flex items-center">
                <div class="p-3 bg-indigo-100 rounded-full mr-3">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 012-2z" />
                  </svg>
                </div>
                <h4 class="text-lg font-bold">Statistical Usage</h4>
              </div>
              <p class="mt-3 text-gray-700">Use factor scores for clustering or regression analysis to reduce dimensionality while retaining information.</p>
            </div>
            
            <div class="p-5 bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg">
              <div class="flex items-center">
                <div class="p-3 bg-green-100 rounded-full mr-3">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
                  </svg>
                </div>
                <h4 class="text-lg font-bold">Factor Names</h4>
              </div>
              <ul class="mt-3 space-y-2 text-gray-700">
                <li><span class="font-medium text-indigo-600">Factor 1:</span> Quality of Life/Amenities</li>
                <li><span class="font-medium text-pink-600">Factor 2:</span> Socioeconomic/Development</li>
                <li><span class="font-medium text-blue-600">Factor 3:</span> Climate</li>
              </ul>
            </div>
            
            <div class="p-5 bg-gradient-to-br from-amber-50 to-yellow-50 rounded-lg">
              <div class="flex items-center">
                <div class="p-3 bg-yellow-100 rounded-full mr-3">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                  </svg>
                </div>
                <h4 class="text-lg font-bold">Further Steps</h4>
              </div>
              <p class="mt-3 text-gray-700">Consider factor rotation for clearer interpretation and refined factor structure for better theoretical alignment.</p>
            </div>
          </div>
        </div>
      </details>
      
      <details>
        <summary class="section-title">📋 8. Summary Table</summary>
        <div class="content-box">
          <table class="w-full">
            <thead>
              <tr>
                <th>Step</th>
                <th>Result/Interpretation</th>
              </tr>
            </thead>
            <tbody>
              <tr class="interactive-cell">
                <td>Data Suitability</td>
                <td><span class="font-medium">Bartlett's p < 0.05</span>, <span class="font-medium">KMO = 0.703</span> (Good)</td>
              </tr>
              <tr class="interactive-cell">
                <td>Factors Retained</td>
                <td>3 (Eigenvalues > 1, Scree plot elbow)</td>
              </tr>
              <tr class="interactive-cell">
                <td>Main Factor Themes</td>
                <td>
                  <span class="badge">1: Quality of Life</span>
                  <span class="badge badge-warning">2: Socioeconomic</span>
                  <span class="badge badge-info">3: Climate</span>
                </td>
              </tr>
              <tr class="interactive-cell">
                <td>Variance Explained</td>
                <td>
                  <div class="flex items-center">
                    <span class="mr-2">62.4% (by 3 factors)</span>
                    <div class="progress-wrapper w-32">
                      <div class="progress-bar bg-gradient-to-r from-indigo-500 to-purple-500" style="width: 62.4%"></div>
                    </div>
                  </div>
                </td>
              </tr>
              <tr class="interactive-cell">
                <td>Communalities</td>
                <td>Most > 0.5 (factors explain most variable variance)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>
    </div>
  </div>

  <div id="particles-js" class="fixed inset-0 pointer-events-none"></div>

  <script>
    // Register the datalabels plugin
    Chart.register(ChartDataLabels);
    
    // Initialize tabs with smooth transitions
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // Add a subtle pulse effect when clicking tabs
        tab.classList.add('pulse-effect');
        setTimeout(() => tab.classList.remove('pulse-effect'), 300);
        
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => {
          c.classList.remove('active');
          c.style.opacity = '0';
        });
        
        tab.classList.add('active');
        const activeContent = document.getElementById(tab.dataset.tab);
        activeContent.classList.add('active');
        
        // Fade in the selected tab content
        setTimeout(() => {
          activeContent.style.opacity = '1';
        }, 10);
      });
    });

    // Initialize Charts
    // Initialize Dark Mode - toggle removed
    function initTheme() {
      // Always use light mode since dark mode toggle was removed
      document.documentElement.classList.remove('dark-mode');
      localStorage.setItem('darkMode', 'false');
    }
    
    // Export functionality (using direct handler now)
    function initExport() {
      // Handled by onclick="handleExport()" now
      console.log("Export initialization skipped - using direct handler");
    }
    
    // Share functionality (using direct handler now)
    function initShare() {
      // Handled by onclick="handleShare()" now
      console.log("Share initialization skipped - using direct handler");
    }
    
    // Interactive elements
    function initInteractions() {
      const interactiveCells = document.querySelectorAll('.interactive-cell');
      interactiveCells.forEach((cell, index) => {
        cell.addEventListener('click', function() {
          this.classList.add('pulse-effect');
          setTimeout(() => this.classList.remove('pulse-effect'), 300);
          
          // Add info tooltip when clicked
          const toast = document.createElement('div');
          toast.className = 'fixed bottom-4 left-4 bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 px-4 py-2 rounded-lg shadow-lg z-50 flex items-center';
          toast.innerHTML = `<i class="fas fa-info-circle mr-2"></i> Click to copy the value to clipboard`;
          document.body.appendChild(toast);
          
          setTimeout(() => {
            document.body.removeChild(toast);
          }, 2000);
          
          // Copy the cell content
          const content = this.innerText.trim();
          navigator.clipboard.writeText(content).catch(() => {});
        });
        
        // Add reveal animation
        setTimeout(() => {
          cell.style.opacity = '1';
          cell.style.transform = 'translateY(0)';
        }, 70 * index);
      });
    }
    
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize tab switching for Factor Loadings section
      initFactorLoadingsTabs();
      
      // Add window resize handler for heatmap
      window.addEventListener('resize', () => {
        const heatmapTab = document.querySelector('.tab[data-tab="heatmap"]');
        if (heatmapTab && heatmapTab.classList.contains('active')) {
          const canvas = document.getElementById('heatmapChart');
          if (canvas) {
            canvas.width = canvas.parentElement.offsetWidth;
            canvas.height = 400; // Fixed height
            drawHeatmap();
          }
        }
      });

      initSocialLinks();
      initTheme();
      initExport();
      initShare();
      initInteractions();      // Variance Explained Pie Chart
      const varianceCtx = document.getElementById('varianceChart').getContext('2d');
      const varianceChart = new Chart(varianceCtx, {
        type: 'doughnut',
        data: {
          labels: ['Factor 1', 'Factor 2', 'Factor 3', 'Unexplained'],
          datasets: [{
            data: [36.64, 13.48, 12.28, 37.6],
            backgroundColor: [
              'rgba(67, 97, 238, 0.7)',
              'rgba(247, 37, 133, 0.7)',
              'rgba(76, 201, 240, 0.7)',
              'rgba(200, 200, 200, 0.5)'
            ],
            borderColor: [
              'rgba(67, 97, 238, 1)',
              'rgba(247, 37, 133, 1)',
              'rgba(76, 201, 240, 1)',
              'rgba(200, 200, 200, 1)'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: {
            animateRotate: true,
            animateScale: true,
            duration: 2000,
            easing: 'easeOutQuart'
          },
          plugins: {
            datalabels: {
              display: false  // Disable data labels for this chart
            },
            legend: {
              position: 'bottom',
              labels: {
                usePointStyle: true,
                padding: 20,
                font: {
                  size: 12
                }
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              padding: 12,
              cornerRadius: 6,
              callbacks: {
                label: function(context) {
                  let label = context.label || '';
                  if (label) {
                    label += ': ';
                  }
                  label += context.raw + '%';
                  return label;
                }
              }
            }
          }
        }
      });
      
      // Initialize charts when DOM is loaded
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize Scree Plot
        const screeCtx = document.getElementById('screePlot');
        if (screeCtx) {
          const screePlot = new Chart(screeCtx.getContext('2d'), {
            type: 'line',
            data: {
              labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
              datasets: [{
                label: 'Eigenvalues',
                data: [3.298, 1.214, 1.196, 0.85, 0.75, 0.65, 0.45, 0.32, 0.28],
                borderColor: 'rgba(67, 97, 238, 1)',
                backgroundColor: 'rgba(67, 97, 238, 0.1)',
                pointBackgroundColor: 'rgba(67, 97, 238, 1)',
                pointBorderColor: 'rgba(255, 255, 255, 1)',
                pointBorderWidth: 2,
                pointRadius: 6,
                pointHoverRadius: 8,
                fill: true,
                tension: 0.3
              }, {
                label: 'Kaiser Criterion (Eigenvalue=1)',
                data: [1, 1, 1, 1, 1, 1, 1, 1, 1],
                borderColor: 'rgba(255, 99, 132, 1)',
                borderDash: [5, 5],
                pointRadius: 0,
                fill: false
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                annotation: {
                  annotations: {
                    elbow: {
                      type: 'point',
                      xValue: 3,
                      yValue: 0.85,
                      backgroundColor: 'rgba(255, 99, 132, 0.2)',
                      borderColor: 'rgba(255, 99, 132, 1)',
                      borderWidth: 2,
                      radius: 8,
                      label: {
                        content: 'Elbow Point',
                        enabled: true,
                        position: 'top'
                      }
                    }
                  }
                }
              }
            }
          });
        }

        // Initialize Communalities Chart
        const communalitiesCtx = document.getElementById('communalitiesChart');
        if (communalitiesCtx) {
          const communalitiesChart = new Chart(communalitiesCtx.getContext('2d'), {
            type: 'bar',
            data: {
              labels: ['climate', 'housing', 'health', 'crime', 'trans', 'educate', 'arts', 'recreate', 'econ'],
              datasets: [{
                label: 'Communality',
                data: [0.795, 0.518, 0.722, 0.512, 0.510, 0.561, 0.754, 0.517, 0.728],
                backgroundColor: [
                  '#10b981', '#6366f1', '#14b8a6', '#f97316', '#3b82f6', 
                  '#ec4899', '#10b981', '#8b5cf6', '#22c55e'
                ],
                borderWidth: 0,
                borderRadius: 4
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                datalabels: {
                  color: '#fff',
                  font: {
                    weight: 'bold'
                  },
                  formatter: (value) => value.toFixed(3)
                }
              }
            }
          });
        }

        // Initialize Variance Distribution Chart
        const varianceCtx = document.getElementById('varianceExplainedChart');
        if (varianceCtx) {
          const varianceChart = new Chart(varianceCtx.getContext('2d'), {
            type: 'bar',
            data: {
              labels: ['Factor 1', 'Factor 2', 'Factor 3'],
              datasets: [{
                label: 'Variance Explained',
                data: [36.64, 13.48, 12.28],
                backgroundColor: [
                  'rgba(99, 102, 241, 0.85)',  // Indigo
                  'rgba(236, 72, 153, 0.85)',  // Pink
                  'rgba(45, 212, 191, 0.85)'   // Teal
                ],
                borderWidth: 2,
                borderColor: [
                  'rgba(99, 102, 241, 1)',
                  'rgba(236, 72, 153, 1)',
                  'rgba(45, 212, 191, 1)'
                ],
                borderRadius: 6,
                hoverBackgroundColor: [
                  'rgba(99, 102, 241, 1)',
                  'rgba(236, 72, 153, 1)',
                  'rgba(45, 212, 191, 1)'
                ],
                hoverBorderWidth: 3,
                barPercentage: 0.8
              }, {
                type: 'line',
                label: 'Cumulative Variance',
                data: [36.64, 50.12, 62.40],
                borderColor: 'rgba(14, 165, 233, 1)',
                backgroundColor: 'rgba(14, 165, 233, 0.1)',
                pointBackgroundColor: 'rgba(14, 165, 233, 1)',
                pointBorderColor: '#ffffff',
                pointBorderWidth: 2,
                pointRadius: 6,
                pointHoverRadius: 8,
                pointHoverBackgroundColor: 'rgba(14, 165, 233, 1)',
                pointHoverBorderColor: '#ffffff',
                pointHoverBorderWidth: 3,
                fill: true,
                tension: 0.2
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              animation: {
                duration: 2000,
                easing: 'easeInOutQuart'
              },
              interaction: {
                mode: 'index',
                intersect: false
              },
              plugins: {
                datalabels: {
                  color: function(context) {
                    return context.datasetIndex === 0 ? '#ffffff' : '#000000';
                  },
                  font: {
                    weight: 'bold',
                    size: 12
                  },
                  formatter: (value, context) => {
                    return value.toFixed(1) + '%';
                  },
                  align: function(context) {
                    return context.datasetIndex === 0 ? 'center' : 'top';
                  },
                  offset: function(context) {
                    return context.datasetIndex === 0 ? 0 : 8;
                  },
                  textStrokeColor: 'rgba(0, 0, 0, 0.3)',
                  textStrokeWidth: 2,
                  textShadowBlur: 3,
                  textShadowColor: 'rgba(0, 0, 0, 0.3)'
                },
                legend: {
                  position: 'top',
                  align: 'center',
                  labels: {
                    usePointStyle: true,
                    padding: 20,
                    font: {
                      size: 12,
                      weight: 'bold'
                    },
                    generateLabels: function(chart) {
                      const datasets = chart.data.datasets;
                      return datasets.map((dataset, i) => ({
                        text: dataset.label,
                        fillStyle: i === 0 ? dataset.backgroundColor[0] : dataset.borderColor,
                        strokeStyle: i === 0 ? dataset.borderColor[0] : dataset.borderColor,
                        lineWidth: 2,
                        hidden: !chart.isDatasetVisible(i),
                        index: i
                      }));
                    }
                },
                tooltip: {
                  enabled: true,
                  backgroundColor: 'rgba(0, 0, 0, 0.8)',
                  titleFont: {
                    size: 13,
                    weight: 'bold'
                  },
                  bodyFont: {
                    size: 12
                  },
                  padding: 12,
                  cornerRadius: 6,
                  displayColors: true,
                  callbacks: {
                    label: function(context) {
                      const label = context.dataset.label || '';
                      const value = context.parsed.y;
                      return `${label}: ${value.toFixed(1)}%`;
                    }
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  max: 40,
                  title: {
                    display: true,
                    text: 'Variance Explained (%)',
                    font: {
                      size: 12,
                      weight: 'bold'
                    },
                    padding: {top: 10, bottom: 10}
                  },
                  ticks: {
                    font: {
                      size: 11
                    },
                    stepSize: 5
                  },
                  grid: {
                    color: 'rgba(0, 0, 0, 0.1)',
                    drawBorder: false,
                    lineWidth: 0.5
                  }
                },
                y1: {
                  position: 'right',
                  beginAtZero: true,
                  max: 100,
                  title: {
                    display: true,
                    text: 'Cumulative Variance (%)',
                    font: {
                      size: 12,
                      weight: 'bold'
                    },
                    padding: {top: 10, bottom: 10}
                  },
                  ticks: {
                    font: {
                      size: 11
                    },
                    stepSize: 10
                  },
                  grid: {
                    display: false
                  }
                },
                x: {
                  grid: {
                    display: false,
                    drawBorder: false
                  },
                  ticks: {
                    font: {
                      size: 11
                    }
                  }
                }
              }
            }
          });
        }
      });

      // Function to destroy existing chart if it exists
      function destroyChart(chartId) {
        const existingChart = Chart.getChart(chartId);
        if (existingChart) {
          existingChart.destroy();
        }
      }

      // Scree Plot with animation and interaction
      const screeCtx = document.getElementById('screePlot');
      if (screeCtx) {
        const screePlot = new Chart(screeCtx.getContext('2d'), {
        type: 'line',
        data: {
          labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
          datasets: [{
            label: 'Eigenvalues',
            data: [3.298, 1.214, 1.196, 0.85, 0.75, 0.65, 0.45, 0.32, 0.28],
            borderColor: 'rgba(67, 97, 238, 1)',
            backgroundColor: 'rgba(67, 97, 238, 0.1)',
            pointBackgroundColor: 'rgba(67, 97, 238, 1)',
            pointBorderColor: 'rgba(255, 255, 255, 1)',
            pointBorderWidth: 2,
            pointRadius: 6,
            pointHoverRadius: 8,
            fill: true,
            tension: 0.3
          }, {
            label: 'Kaiser Criterion (Eigenvalue=1)',
            data: [1, 1, 1, 1, 1, 1, 1, 1, 1],
            borderColor: 'rgba(255, 99, 132, 1)',
            borderDash: [5, 5],
            pointRadius: 0,
            fill: false
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: {
            duration: 2000,
            easing: 'easeOutQuart'
          },
          interaction: {
            mode: 'index',
            intersect: false,
          },
          plugins: {
            datalabels: {
              display: false  // Disable data labels for scree plot
            },
            legend: {
              position: 'bottom',
              labels: {
                usePointStyle: true,
                padding: 15,
                boxWidth: 10
              }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleFont: { weight: 'bold' },
              bodyFont: { size: 13 },
              padding: 10,
              cornerRadius: 6,
              displayColors: false,
              callbacks: {
                afterLabel: function(context) {
                  if (context.datasetIndex === 0) {
                    const factorNum = parseInt(context.label);
                    if (factorNum <= 3) {
                      return '✓ Factor retained (Eigenvalue > 1)';
                    } else {
                      return '✗ Factor not retained (Eigenvalue < 1)';
                    }
                  }
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Eigenvalue',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              grid: {
                color: 'rgba(200, 200, 200, 0.2)'
              }
            },
            x: {
              title: {
                display: true,
                text: 'Factor Number',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              grid: {
                display: false
              }
            }
          }
        }
      });
      
      // Add elbow point annotation
      const annotationPlugin = {
        id: 'elbowAnnotation',
        afterDraw(chart) {
          const ctx = chart.ctx;
          const xAxis = chart.scales.x;
          const yAxis = chart.scales.y;
          
          // Draw elbow annotation
          const elbowX = xAxis.getPixelForValue('4');
          const elbowY = yAxis.getPixelForValue(0.85);
          
          ctx.save();
          ctx.beginPath();
          ctx.arc(elbowX, elbowY, 8, 0, Math.PI * 2);
          ctx.fillStyle = 'rgba(255, 99, 132, 0.2)';
          ctx.fill();
          ctx.strokeStyle = 'rgba(255, 99, 132, 1)';
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.closePath();
          
          ctx.font = '12px Arial';
          ctx.fillStyle = 'rgba(255, 99, 132, 1)';
          ctx.textAlign = 'center';
          ctx.fillText('Elbow Point', elbowX, elbowY - 15);
          ctx.restore();
        }
      };
      
      // Register and add the annotation plugin
      screePlot.options.plugins.annotation = annotationPlugin;
      screePlot.update();
      
      new Chart(heatmapCtx, {
        type: 'bar',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'y',
          plugins: {
            legend: {
              position: 'top',
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  let label = context.dataset.label || '';
                  if (label) {
                    label += ': ';
                  }
                  label += context.parsed.x.toFixed(3);
                  return label;
                }
              }
            }
          },
          scales: {
            x: {
              beginAtZero: true,
              min: -1,
              max: 1,
              ticks: {
                callback: function(value) {
                  return value.toFixed(1);
                }
              }
            }
          }
        }
      });
        // Add animation to elements
      document.querySelectorAll('.stat-card, .interactive-cell').forEach((el, index) => {
        setTimeout(() => {
          el.style.opacity = '1';
          el.style.transform = 'translateY(0)';
        }, 100 * index);
      });
      
      // Add tooltip hover effects
      document.querySelectorAll('.tooltip').forEach(tooltip => {
        tooltip.addEventListener('mouseenter', function() {
          this.querySelector('.tooltip-text').style.visibility = 'visible';
          this.querySelector('.tooltip-text').style.opacity = '1';
        });
        
        tooltip.addEventListener('mouseleave', function() {
          this.querySelector('.tooltip-text').style.visibility = 'hidden';
          this.querySelector('.tooltip-text').style.opacity = '0';
        });
      });
      
      // Add interactive section collapsing with animation
      document.querySelectorAll('details').forEach(detail => {
        detail.addEventListener('toggle', function() {
          if (this.open) {
            // When opening a section, animate entrance of its child elements
            const contentElements = this.querySelectorAll('.content-box > *');
            contentElements.forEach((el, index) => {
              el.style.opacity = '0';
              el.style.transform = 'translateY(20px)';
              
              setTimeout(() => {
                el.style.transition = 'all 0.5s ease';
                el.style.opacity = '1';
                el.style.transform = 'translateY(0)';
              }, 100 + (index * 50));
            });
          }
        });
      });
      
      // Add "Save as Image" functionality to charts
      document.querySelectorAll('.chart-container').forEach(container => {
        const chartId = container.querySelector('canvas').id;
        
        // Add button to download chart as image
        const downloadBtn = document.createElement('button');
        downloadBtn.className = 'absolute top-2 right-2 bg-white/50 dark:bg-gray-800/50 hover:bg-white/80 dark:hover:bg-gray-800/80 p-1 rounded-full transition-all text-gray-600 dark:text-gray-300';
        downloadBtn.innerHTML = '<i class="fas fa-download"></i>';
        downloadBtn.title = 'Save chart as image';
        
        downloadBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          
          const canvas = document.getElementById(chartId);
          const link = document.createElement('a');
          link.download = `factor-analysis-${chartId}.png`;
          link.href = canvas.toDataURL('image/png');
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          // Show confirmation
          const toast = document.createElement('div');
          toast.className = 'fixed bottom-4 left-4 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 px-4 py-2 rounded shadow-lg z-50';
          toast.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Chart saved as image';
          document.body.appendChild(toast);
          setTimeout(() => {
            document.body.removeChild(toast);
          }, 3000);
        });
        
        // Add positioning to container if not already present
        container.style.position = 'relative';
        container.appendChild(downloadBtn);
      });
    }); // End of DOMContentLoaded event listener
    
    // Initialize the floating action button
    addFloatingActionButton();
    
    // Add expanding card animation when hovering over key stat cards
    document.querySelectorAll('.stat-card').forEach(card => {
      card.addEventListener('mouseenter', function() {
        const valueEl = this.querySelector('.text-3xl');
        if (valueEl) {
          valueEl.style.transition = 'transform 0.3s ease';
          valueEl.style.transform = 'scale(1.2)';
        }
      });
      
      card.addEventListener('mouseleave', function() {
        const valueEl = this.querySelector('.text-3xl');
        if (valueEl) {
          valueEl.style.transform = 'scale(1)';
        }
      });
    });
    
    // Add pulse effect to the report header on load
    setTimeout(() => {
      const header = document.querySelector('.report-header');
      header.classList.add('pulse-effect');
      setTimeout(() => header.classList.remove('pulse-effect'), 800);
    }, 1000);
    
    // Add floating action button for quick navigation
    const addFloatingActionButton = () => {
      const fab = document.createElement('div');
      fab.className = 'fixed bottom-6 right-6 bg-primary dark:bg-primary hover:bg-secondary dark:hover:bg-secondary rounded-full w-14 h-14 flex items-center justify-center shadow-lg cursor-pointer z-50 transition-all';
      fab.innerHTML = '<i class="fas fa-chevron-up text-white text-xl"></i>';
      
      fab.addEventListener('click', function() {
        // Check if the menu is already open
        const isOpen = this.getAttribute('data-open') === 'true';
        
        if (isOpen) {
          // Close the menu
          const menu = document.getElementById('fab-menu');
          if (menu) menu.remove();
          this.setAttribute('data-open', 'false');
          this.innerHTML = '<i class="fas fa-chevron-up text-white text-xl"></i>';
        } else {
          // Open the menu
          this.setAttribute('data-open', 'true');
          this.innerHTML = '<i class="fas fa-times text-white text-xl"></i>';
          
          const menu = document.createElement('div');
          menu.id = 'fab-menu';
          menu.className = 'fixed right-6 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 transition-all overflow-hidden';
          menu.style.bottom = '80px';
          menu.style.width = '200px';
          menu.style.animation = 'fadeIn 0.3s ease';
          
          // Create menu items for each section
          const sections = [
            { title: 'Key Findings', icon: 'fa-key', color: 'text-indigo-500' },
            { title: 'Data Preparation', icon: 'fa-database', color: 'text-blue-500' },
            { title: 'Suitability Tests', icon: 'fa-vial', color: 'text-green-500' },
            { title: 'Factor Determination', icon: 'fa-ruler', color: 'text-amber-500' },
            { title: 'Factor Loadings', icon: 'fa-table', color: 'text-red-500' },
            { title: 'Communalities', icon: 'fa-chart-bar', color: 'text-purple-500' },
            { title: 'Variance Explained', icon: 'fa-chart-pie', color: 'text-pink-500' },
            { title: 'Practical Implications', icon: 'fa-lightbulb', color: 'text-cyan-500' },
            { title: 'Summary Table', icon: 'fa-clipboard-list', color: 'text-teal-500' }
          ];
          
          menu.innerHTML = `<div class="py-2">
            ${sections.map((section, index) => `
              <div class="section-link px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer flex items-center transition-all" data-index="${index}">
                <i class="fas ${section.icon} ${section.color} w-6"></i>
                <span class="ml-2 text-sm">${section.title}</span>
              </div>
            `).join('')}
          </div>`;
          
          document.body.appendChild(menu);
          
          // Add click handlers to menu items
          menu.querySelectorAll('.section-link').forEach(link => {
            link.addEventListener('click', function() {
              const index = parseInt(this.getAttribute('data-index'));
              const sections = document.querySelectorAll('details');
              
              if (index === 0) {
                // Scroll to key findings
                document.querySelector('.key-finding').scrollIntoView({ behavior: 'smooth' });
              } else if (sections[index - 1]) {
                // Open the section and scroll to it
                sections[index - 1].open = true;
                sections[index - 1].scrollIntoView({ behavior: 'smooth' });
              }
              
              // Close the menu
              document.getElementById('fab-menu').remove();
              fab.setAttribute('data-open', 'false');
              fab.innerHTML = '<i class="fas fa-chevron-up text-white text-xl"></i>';
            });
          });
        }
      });
      
      document.body.appendChild(fab);
    };
    
    // Add floating action button after a slight delay
    setTimeout(addFloatingActionButton, 2000);
    
    // Add the annotation plugin
      varianceExplainedChart.options.plugins.annotation = guideline60pct;
      varianceExplainedChart.update();
      
      // Add CSS for animation
      const style = document.createElement('style');
      style.textContent = `
        @keyframes progress-pulse {
          0% { transform: scaleY(1); }
          50% { transform: scaleY(1.2); }
          100% { transform: scaleY(1); }
        }
        .progress-pulse {
          animation: progress-pulse 0.5s ease;
        }
        
        .factor-tooltip {
          position: fixed;
          z-index: 9999;
          background: white;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
          padding: 12px;
          max-width: 280px;
          pointer-events: none;
          opacity: 0;
          transform: translateY(10px);
          transition: opacity 0.3s, transform 0.3s;
        }
        
        .factor-tooltip.show {
          opacity: 1;
          transform: translateY(0);
        }
      `;
      document.head.appendChild(style);
      
      // Make variance explained section interactive
      document.addEventListener('DOMContentLoaded', function() {
        // Create tooltip element
        const tooltip = document.createElement('div');
        tooltip.className = 'factor-tooltip';
        document.body.appendChild(tooltip);
        
        // Factor data
        const factorInfo = [
          {
            name: "Quality of Life/Amenities",
            variables: ["housing", "health", "trans", "arts", "recreate"],
            description: "Represents variables related to living conditions and amenities.",
            color: "indigo"
          },
          {
            name: "Socioeconomic",
            variables: ["crime", "educate", "econ"],
            description: "Represents variables related to economic and social factors.",
            color: "pink"
          },
          {
            name: "Climate",
            variables: ["climate"],
            description: "Represents environment-related variables.",
            color: "cyan"
          }
        ];
        
        // Add row hover effect
        document.querySelectorAll('.variance-row').forEach((row, index) => {
          row.addEventListener('mouseenter', function() {
            // Highlight chart bar
            highlightChartBar(index);
            
            // Show factor info tooltip
            const info = factorInfo[index];
            tooltip.innerHTML = `
              <div class="font-bold text-${info.color}-600 text-lg">Factor ${index + 1}: ${info.name}</div>
              <div class="mt-2">
                <div class="font-medium">Variance explained: <span class="font-bold">${varianceExplainedChart.data.datasets[0].data[index].toFixed(2)}%</span></div>
                <div class="mt-1 font-medium">Variables: <span class="text-gray-600">${info.variables.join(", ")}</span></div>
                <div class="mt-2 text-sm text-gray-600">
                  ${info.description}
                </div>
              </div>
            `;
            
            tooltip.classList.add('show');
            
            // Position tooltip next to the row
            const rect = this.getBoundingClientRect();
            tooltip.style.left = (rect.right + 20) + 'px';
            tooltip.style.top = (rect.top - 10) + 'px';
          });
          
          row.addEventListener('mouseleave', function() {
            // Reset chart
            resetChartBars();
            tooltip.classList.remove('show');
          });
          
          row.addEventListener('click', function() {
            // Pulse effect on row
            this.classList.add('bg-gray-100', 'dark:bg-gray-800');
            setTimeout(() => {
              this.classList.remove('bg-gray-100', 'dark:bg-gray-800');
            }, 300);
            
            // Animate the progress bar
            const progressBar = this.querySelector('.variance-progress-bar');
            if (progressBar) {
              progressBar.classList.add('progress-pulse');
              setTimeout(() => {
                progressBar.classList.remove('progress-pulse');
              }, 500);
            }
          });
        });
        
        // Add chart interactions
        document.getElementById('varianceExplainedChart').addEventListener('mousemove', function(e) {
          const points = varianceExplainedChart.getElementsAtEventForMode(e, 'nearest', { intersect: true }, false);
          if (points.length && points[0].datasetIndex === 0) {
            const index = points[0].index;
            
            // Reset all bars
            resetChartBars();
            
            // Highlight selected bar
            highlightChartBar(index);
            
            // Highlight table row
            highlightTableRow(index);
          } else {
            // Reset highlights
            resetChartBars();
            resetTableRows();
          }
        });
        
        document.getElementById('varianceExplainedChart').addEventListener('mouseleave', function() {
          resetChartBars();
          resetTableRows();
        });
        
        // Make total variance box interactive
        const totalVarianceBox = document.querySelector('.mt-6.p-5.rounded-xl');
        if (totalVarianceBox) {
          totalVarianceBox.classList.add('cursor-pointer', 'transition-transform', 'hover:shadow-md', 'duration-300');
          totalVarianceBox.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-5px)';
          });
          
          totalVarianceBox.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
          });
          
          totalVarianceBox.addEventListener('click', function() {
            const progressBar = this.querySelector('.bg-gradient-to-r');
            progressBar.style.transition = 'width 1s ease-in-out';
            progressBar.style.width = '0%';
            
            setTimeout(() => {
              progressBar.style.width = '62.4%';
            }, 100);
          });
        }
        
        // Utility functions
        function highlightChartBar(index) {
          const dataset = varianceExplainedChart.data.datasets[0];
          const originalBgColors = [
            'rgba(79, 70, 229, 0.8)',
            'rgba(236, 72, 153, 0.8)',
            'rgba(20, 184, 166, 0.8)'
          ];
          
          dataset.backgroundColor = [...originalBgColors];
          dataset.backgroundColor[index] = index === 0 
            ? 'rgba(79, 70, 229, 1)' 
            : (index === 1 ? 'rgba(236, 72, 153, 1)' : 'rgba(20, 184, 166, 1)');
          
          varianceExplainedChart.update();
        }
        
        function resetChartBars() {
          const dataset = varianceExplainedChart.data.datasets[0];
          dataset.backgroundColor = [
            'rgba(79, 70, 229, 0.8)',
            'rgba(236, 72, 153, 0.8)',
            'rgba(20, 184, 166, 0.8)'
          ];
          varianceExplainedChart.update();
        }
        
        function highlightTableRow(index) {
          resetTableRows();
          const row = document.querySelector(`.variance-row[data-index="${index}"]`);
          if (row) {
            if (index === 0) {
              row.classList.add('bg-indigo-50', 'dark:bg-indigo-900/20');
            } else if (index === 1) {
              row.classList.add('bg-pink-50', 'dark:bg-pink-900/20');
            } else {
              row.classList.add('bg-cyan-50', 'dark:bg-cyan-900/20');
            }
          }
        }
        
        function resetTableRows() {
          document.querySelectorAll('.variance-row').forEach(row => {
            row.classList.remove('bg-indigo-50', 'bg-pink-50', 'bg-cyan-50');
            row.classList.remove('dark:bg-indigo-900/20', 'dark:bg-pink-900/20', 'dark:bg-cyan-900/20');
          });
        }
      });
      
      // Enhanced Heatmap Chart for Factor Loadings with interactivity
  </script>

  <!-- Dataset Viewer Script -->
  <script>
    // Dataset viewer functionality and Jupyter notebook modal
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize dataset viewer
      initDatasetViewer();
      // Initialize Jupyter notebook modal
      initJupyterNotebookModal();
    });
    
          function initJupyterNotebookModal() {
      // Elements
      const notebookBtn = document.getElementById('notebookBtn');
      const notebookModal = document.getElementById('notebookModal');
      const notebookContent = document.getElementById('notebookContent');
      const notebookOverlay = document.getElementById('notebookOverlay');
      const notebookCloseBtn = document.getElementById('notebookCloseBtn');
      
      console.log('Initializing notebook modal, button:', notebookBtn);
      
      // Modal controls
      const openNotebookModal = () => {
        notebookModal.classList.remove('hidden');
        // Add entrance animation
        setTimeout(() => {
          notebookContent.classList.remove('scale-95', 'opacity-0');
          notebookContent.classList.add('scale-100', 'opacity-100');
        }, 10);
      };
      
      const closeNotebookModal = () => {
        // Add exit animation
        notebookContent.classList.remove('scale-100', 'opacity-100');
        notebookContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => {
          notebookModal.classList.add('hidden');
        }, 300);
      };
      
      // Event listeners
      notebookBtn.addEventListener('click', openNotebookModal);
      notebookCloseBtn.addEventListener('click', closeNotebookModal);
      notebookOverlay.addEventListener('click', closeNotebookModal);
      
      // Add keyboard shortcut (Alt+J) to open notebook modal
      document.addEventListener('keydown', function(e) {
        if (e.altKey && e.key === 'j') {
          openNotebookModal();
        }
        // Add Escape key to close modal
        if (e.key === 'Escape' && !notebookModal.classList.contains('hidden')) {
          closeNotebookModal();
        }
      });
    }
    
    function initDatasetViewer() {
      // Elements
      const datasetBtn = document.getElementById('datasetBtn');
      const datasetModal = document.getElementById('datasetModal');
      const datasetContent = document.getElementById('datasetContent');
      const datasetOverlay = document.getElementById('datasetOverlay');
      const datasetCloseBtn = document.getElementById('datasetCloseBtn');
      const datasetLoader = document.getElementById('datasetLoader');
      const datasetError = document.getElementById('datasetError');
      const datasetTableContainer = document.getElementById('datasetTableContainer');
      const datasetSearch = document.getElementById('datasetSearch');
      const datasetDownloadBtn = document.getElementById('datasetDownloadBtn');
      const retryBtn = document.getElementById('retryBtn');
      
      // Tab elements
      const datasetView = document.getElementById('datasetView');
      const summaryTabBtn = document.getElementById('summaryTabBtn');
      const tableTabBtn = document.getElementById('tableTabBtn');
      const dataSummaryTab = document.getElementById('dataSummaryTab');
      const dataTableTab = document.getElementById('dataTableTab');
      
      // Stats tab elements
      const numericalStatsBtn = document.getElementById('numericalStatsBtn');
      const categoricalStatsBtn = document.getElementById('categoricalStatsBtn');
      const numericalStatsTab = document.getElementById('numericalStatsTab');
      const categoricalStatsTab = document.getElementById('categoricalStatsTab');
      
      // Modal controls
      const openModal = () => {
        datasetModal.classList.remove('hidden');
        // Add entrance animation
        setTimeout(() => {
          datasetContent.classList.remove('scale-95', 'opacity-0');
          datasetContent.classList.add('scale-100', 'opacity-100');
        }, 10);
        
        // Load dataset if not already loaded
        if (window.datasetLoaded !== true) {
          loadDataset();
        }
      };
      
      const closeModal = () => {
        // Add exit animation
        datasetContent.classList.remove('scale-100', 'opacity-100');
        datasetContent.classList.add('scale-95', 'opacity-0');
        setTimeout(() => {
          datasetModal.classList.add('hidden');
        }, 300);
      };
      
      // Event listeners
      datasetBtn.addEventListener('click', openModal);
      datasetCloseBtn.addEventListener('click', closeModal);
      datasetOverlay.addEventListener('click', closeModal);
      retryBtn.addEventListener('click', loadDataset);
      
      // No need for default tab initialization here as we do it when data loads
      
      // Tab switching
      summaryTabBtn.addEventListener('click', function() {
        summaryTabBtn.classList.add('text-blue-600', 'dark:text-blue-400', 'border-blue-600', 'dark:border-blue-400');
        summaryTabBtn.classList.remove('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        tableTabBtn.classList.remove('text-blue-600', 'dark:text-blue-400', 'border-blue-600', 'dark:border-blue-400');
        tableTabBtn.classList.add('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        dataSummaryTab.classList.remove('hidden');
        dataTableTab.classList.add('hidden');
      });
      
      tableTabBtn.addEventListener('click', function() {
        tableTabBtn.classList.add('text-blue-600', 'dark:text-blue-400', 'border-blue-600', 'dark:border-blue-400');
        tableTabBtn.classList.remove('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        summaryTabBtn.classList.remove('text-blue-600', 'dark:text-blue-400', 'border-blue-600', 'dark:border-blue-400');
        summaryTabBtn.classList.add('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        dataTableTab.classList.remove('hidden');
        dataSummaryTab.classList.add('hidden');
      });
      
      // Stats tab switching
      numericalStatsBtn.addEventListener('click', function() {
        numericalStatsBtn.classList.add('text-green-600', 'dark:text-green-400', 'border-green-600', 'dark:border-green-400');
        numericalStatsBtn.classList.remove('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        categoricalStatsBtn.classList.remove('text-green-600', 'dark:text-green-400', 'border-green-600', 'dark:border-green-400');
        categoricalStatsBtn.classList.add('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        numericalStatsTab.classList.remove('hidden');
        categoricalStatsTab.classList.add('hidden');
      });
      
      categoricalStatsBtn.addEventListener('click', function() {
        categoricalStatsBtn.classList.add('text-green-600', 'dark:text-green-400', 'border-green-600', 'dark:border-green-400');
        categoricalStatsBtn.classList.remove('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        numericalStatsBtn.classList.remove('text-green-600', 'dark:text-green-400', 'border-green-600', 'dark:border-green-400');
        numericalStatsBtn.classList.add('text-gray-500', 'hover:text-gray-600', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'border-transparent');
        
        categoricalStatsTab.classList.remove('hidden');
        numericalStatsTab.classList.add('hidden');
      });
      
      // Generate data summary
      function generateDataSummary() {
        if (!dataset || dataset.length === 0) return;
        
        // 1. Update dataset overview
        document.getElementById('summaryTotalRows').textContent = dataset.length;
        document.getElementById('summaryTotalCols').textContent = Object.keys(dataset[0]).length;
        
        // 2. Display sample records (first 5)
        displaySampleRecords();
        
        // 3. Generate variable information
        generateVariableInfo();
        
        // 4. Check data quality
        checkDataQuality();
        
        // 5. Calculate basic statistics
        calculateBasicStats();
      }
      
      // Display sample records
      function displaySampleRecords() {
        const sampleTableHeader = document.getElementById('sampleTableHeader');
        const sampleTableBody = document.getElementById('sampleTableBody');
        
        // Clear existing content
        sampleTableHeader.innerHTML = '';
        sampleTableBody.innerHTML = '';
        
        // Get headers
        const headers = Object.keys(dataset[0]);
        
        // Add header cells
        headers.forEach(header => {
          sampleTableHeader.innerHTML += `
            <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
              ${header}
            </th>
          `;
        });
        
        // Add sample rows (first 5)
        const sampleSize = Math.min(5, dataset.length);
        for (let i = 0; i < sampleSize; i++) {
          const row = dataset[i];
          let rowHtml = '<tr>';
          
          headers.forEach(header => {
            rowHtml += `<td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${row[header] || ''}</td>`;
          });
          
          rowHtml += '</tr>';
          sampleTableBody.innerHTML += rowHtml;
        }
      }
      
      // Generate variable information
      function generateVariableInfo() {
        const variableInfoBody = document.getElementById('variableInfoBody');
        variableInfoBody.innerHTML = '';
        
        if (dataset.length === 0) return;
        
        const headers = Object.keys(dataset[0]);
        const totalRows = dataset.length;
        
        headers.forEach(header => {
          // Determine variable type
          let variableType = determineVariableType(header);
          
          // Count non-null values
          let nonNullCount = dataset.filter(row => row[header] && row[header] !== '').length;
          let nonNullPercentage = ((nonNullCount / totalRows) * 100).toFixed(2);
          
          variableInfoBody.innerHTML += `
            <tr>
              <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200 font-medium">${header}</td>
              <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">
                <span class="px-2 py-1 text-xs font-medium rounded-full ${getTypeClass(variableType)}">
                  ${variableType}
                </span>
              </td>
              <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${nonNullCount} (${nonNullPercentage}%)</td>
            </tr>
          `;
        });
      }
      
      // Determine variable type
      function determineVariableType(header) {
        // In this factor analysis dataset, all variables are likely numerical
        // You could add more sophisticated type detection here
        const sampleValues = dataset.slice(0, 10).map(row => row[header]);
        
        // Check if values are numeric
        const numericValues = sampleValues.filter(val => !isNaN(parseFloat(val)) && val !== '' && val !== null);
        if (numericValues.length > 0.8 * sampleValues.length) {
          return 'Numerical';
        }
        
        // Check if it's a categorical variable with few unique values
        const uniqueValues = new Set(dataset.map(row => row[header])).size;
        if (uniqueValues < 10 || uniqueValues < dataset.length * 0.05) {
          return 'Categorical';
        }
        
        return 'Text';
      }
      
      // Get CSS class based on variable type
      function getTypeClass(variableType) {
        switch (variableType) {
          case 'Numerical':
            return 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400';
          case 'Categorical':
            return 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400';
          case 'Text':
            return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400';
          default:
            return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';
        }
      }
      
      // Check data quality
      function checkDataQuality() {
        // 1. Count missing values
        let totalMissingValues = 0;
        const missingByColumn = {};
        const headers = Object.keys(dataset[0]);
        
        headers.forEach(header => {
          const missingCount = dataset.filter(row => !row[header] || row[header] === '').length;
          missingByColumn[header] = missingCount;
          totalMissingValues += missingCount;
        });
        
        document.getElementById('summaryMissingValues').textContent = totalMissingValues;
        
        // Populate missing values table
        const missingValuesBody = document.getElementById('missingValuesBody');
        missingValuesBody.innerHTML = '';
        
        Object.entries(missingByColumn)
          .filter(([_, count]) => count > 0)  // Only show columns with missing values
          .sort(([_, countA], [__, countB]) => countB - countA)  // Sort by count (descending)
          .forEach(([column, count]) => {
            const percentage = ((count / dataset.length) * 100).toFixed(2);
            missingValuesBody.innerHTML += `
              <tr>
                <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${column}</td>
                <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${count}</td>
                <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${percentage}%</td>
              </tr>
            `;
          });
        
        // If no missing values, add a message
        if (totalMissingValues === 0) {
          missingValuesBody.innerHTML = `
            <tr>
              <td colspan="3" class="px-4 py-2 text-sm text-center text-green-600 dark:text-green-400">
                No missing values found in the dataset!
              </td>
            </tr>
          `;
        }
        
        // 2. Count duplicate rows
        const rowStrings = dataset.map(row => JSON.stringify(row));
        const uniqueRowStrings = new Set(rowStrings);
        const duplicateCount = rowStrings.length - uniqueRowStrings.size;
        
        document.getElementById('summaryDuplicates').textContent = duplicateCount;
        
        // 3. Detect potential outliers using a simple IQR method for numeric columns
        let totalOutliers = 0;
        
        headers.forEach(header => {
          // Only check numerical columns
          const values = dataset.map(row => parseFloat(row[header])).filter(val => !isNaN(val));
          
          if (values.length > 0) {
            // Sort values
            values.sort((a, b) => a - b);
            
            // Calculate quartiles
            const q1Index = Math.floor(values.length * 0.25);
            const q3Index = Math.floor(values.length * 0.75);
            const q1 = values[q1Index];
            const q3 = values[q3Index];
            
            // Calculate IQR and bounds
            const iqr = q3 - q1;
            const lowerBound = q1 - 1.5 * iqr;
            const upperBound = q3 + 1.5 * iqr;
            
            // Count outliers
            const outliers = values.filter(val => val < lowerBound || val > upperBound);
            totalOutliers += outliers.length;
          }
        });
        
        document.getElementById('summaryOutliers').textContent = totalOutliers;
      }
      
      // Calculate basic statistics
      function calculateBasicStats() {
        const numericalStatsBody = document.getElementById('numericalStatsBody');
        const categoricalStatsBody = document.getElementById('categoricalStatsBody');
        
        numericalStatsBody.innerHTML = '';
        categoricalStatsBody.innerHTML = '';
        
        const headers = Object.keys(dataset[0]);
        
        headers.forEach(header => {
          const variableType = determineVariableType(header);
          
          if (variableType === 'Numerical') {
            // Calculate numerical statistics
            const values = dataset.map(row => parseFloat(row[header])).filter(val => !isNaN(val));
            
            if (values.length > 0) {
              // Calculate mean
              const mean = values.reduce((sum, val) => sum + val, 0) / values.length;
              
              // Calculate median
              const sortedValues = [...values].sort((a, b) => a - b);
              const median = sortedValues.length % 2 === 0
                ? (sortedValues[sortedValues.length / 2 - 1] + sortedValues[sortedValues.length / 2]) / 2
                : sortedValues[Math.floor(sortedValues.length / 2)];
              
              // Calculate standard deviation
              const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;
              const std = Math.sqrt(variance);
              
              // Get min and max
              const min = Math.min(...values);
              const max = Math.max(...values);
              
              numericalStatsBody.innerHTML += `
                <tr>
                  <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200 font-medium">${header}</td>
                  <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${mean.toFixed(2)}</td>
                  <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${median.toFixed(2)}</td>
                  <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${std.toFixed(2)}</td>
                  <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${min.toFixed(2)}</td>
                  <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${max.toFixed(2)}</td>
                </tr>
              `;
            }
          } else if (variableType === 'Categorical' || variableType === 'Text') {
            // Calculate categorical statistics
            const valueCountMap = {};
            let totalNonEmpty = 0;
            
            dataset.forEach(row => {
              const value = row[header];
              if (value && value !== '') {
                valueCountMap[value] = (valueCountMap[value] || 0) + 1;
                totalNonEmpty++;
              }
            });
            
            const uniqueValues = Object.keys(valueCountMap).length;
            
            // Find most common value
            let mostCommon = '';
            let highestCount = 0;
            
            Object.entries(valueCountMap).forEach(([value, count]) => {
              if (count > highestCount) {
                mostCommon = value;
                highestCount = count;
              }
            });
            
            const frequency = totalNonEmpty > 0 ? ((highestCount / totalNonEmpty) * 100).toFixed(2) + '%' : 'N/A';
            
            categoricalStatsBody.innerHTML += `
              <tr>
                <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200 font-medium">${header}</td>
                <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${uniqueValues}</td>
                <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${mostCommon}</td>
                <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200">${frequency}</td>
              </tr>
            `;
          }
        });
        
                 // Add message if no numerical variables
         if (numericalStatsBody.innerHTML === '') {
           numericalStatsBody.innerHTML = `
             <tr>
               <td colspan="6" class="px-4 py-2 text-sm text-center text-gray-500 dark:text-gray-400">
                 No numerical variables found in the dataset.
               </td>
             </tr>
           `;
         }
         
         // Add message if no categorical variables
         if (categoricalStatsBody.innerHTML === '') {
           categoricalStatsBody.innerHTML = `
             <tr>
               <td colspan="4" class="px-4 py-2 text-sm text-center text-gray-500 dark:text-gray-400">
                 No categorical variables found in the dataset.
               </td>
             </tr>
           `;
         }
       }
      
      // Dataset functionality
      let dataset = []; // Will hold the full dataset
      let filteredDataset = []; // Will hold the filtered dataset
      let currentPage = 1;
      let pageSize = 25;
      
      // CSV fetcher function
      async function loadDataset() {
        // Show loader, hide error and view
        datasetLoader.classList.remove('hidden');
        datasetError.classList.add('hidden');
        datasetView.classList.add('hidden');
        
        try {
          // Get raw CSV from GitHub
          const response = await fetch('https://raw.githubusercontent.com/AdittoAhosanKabbo/Dimension_Reduction/main/Factor%20_Analaysis/FA1/places_tf.csv');
          
          if (!response.ok) {
            throw new Error(`Failed to fetch dataset: ${response.status} ${response.statusText}`);
          }
          
          const csvText = await response.text();
          
          // Parse CSV
          dataset = parseCSV(csvText);
          filteredDataset = [...dataset];
          
          // Update UI
          updateDatasetTable();
          updatePagination();
          updateStats();
          
          // Generate data summary
          generateDataSummary();
          
                     // Hide loader, show view
          datasetLoader.classList.add('hidden');
           datasetView.classList.remove('hidden');
          window.datasetLoaded = true;
           
           // Set default tabs (initially show data summary)
           summaryTabBtn.click();
           numericalStatsBtn.click();
          
          // Initialize search functionality
          initSearch();
          
          // Initialize download functionality
          initDownload(csvText);
          
          // Initialize pagination
          initPagination();
          
          // Initialize sorting
          initSorting();
          
        } catch (error) {
          console.error('Error loading dataset:', error);
          
          // Show error message
          datasetLoader.classList.add('hidden');
          datasetError.classList.remove('hidden');
          document.getElementById('errorMessage').textContent = error.message || 'Failed to load dataset from GitHub.';
        }
      }
      
      // CSV parser function
      function parseCSV(csvText) {
        const lines = csvText.split('\n');
        
        // Get headers from first line
        const headers = lines[0].split(',').map(header => header.trim());
        
        // Parse data rows
        const data = [];
        for (let i = 1; i < lines.length; i++) {
          if (lines[i].trim() === '') continue; // Skip empty lines
          
          const values = lines[i].split(',').map(value => value.trim());
          
          // Create object with headers as keys
          const row = {};
          headers.forEach((header, index) => {
            row[header] = values[index];
          });
          
          data.push(row);
        }
        
        return data;
      }
      
      // Update pagination controls
      function updatePagination() {
        const prevPageBtn = document.getElementById('prevPageBtn');
        const nextPageBtn = document.getElementById('nextPageBtn');
        const currentPageEl = document.getElementById('currentPage');
        const totalPagesEl = document.getElementById('totalPages');
        const startRowEl = document.getElementById('startRow');
        const endRowEl = document.getElementById('endRow');
        const totalRowsEl = document.getElementById('totalRows');
        
        // Calculate total pages
        const totalPages = pageSize === 'all' ? 1 : Math.ceil(filteredDataset.length / pageSize);
        
        // Update UI elements
        currentPageEl.textContent = currentPage;
        totalPagesEl.textContent = totalPages;
        
        // Update row count display
        const startRow = filteredDataset.length === 0 ? 0 : pageSize === 'all' ? 1 : (currentPage - 1) * pageSize + 1;
        const endRow = pageSize === 'all' ? filteredDataset.length : Math.min(startRow + parseInt(pageSize) - 1, filteredDataset.length);
        
        startRowEl.textContent = startRow;
        endRowEl.textContent = endRow;
        totalRowsEl.textContent = filteredDataset.length;
        
        // Enable/disable pagination buttons
        prevPageBtn.disabled = currentPage <= 1;
        nextPageBtn.disabled = currentPage >= totalPages;
      }
      
      // Update dataset statistics
      function updateStats() {
        const rowCount = document.getElementById('dataRowCount');
        const colCount = document.getElementById('dataColCount');
        
        if (dataset.length > 0) {
          rowCount.textContent = dataset.length;
          colCount.textContent = Object.keys(dataset[0]).length;
        }
      }
      
      // Initialize pagination controls
      function initPagination() {
        const prevPageBtn = document.getElementById('prevPageBtn');
        const nextPageBtn = document.getElementById('nextPageBtn');
        const pageSizeSelect = document.getElementById('dataPageSize');
        
        prevPageBtn.addEventListener('click', () => {
          if (currentPage > 1) {
            currentPage--;
            updateDatasetTable();
            updatePagination();
          }
        });
        
        nextPageBtn.addEventListener('click', () => {
          const totalPages = pageSize === 'all' ? 1 : Math.ceil(filteredDataset.length / pageSize);
          if (currentPage < totalPages) {
            currentPage++;
            updateDatasetTable();
            updatePagination();
          }
        });
        
        pageSizeSelect.addEventListener('change', () => {
          pageSize = pageSizeSelect.value;
          currentPage = 1; // Reset to first page
          updateDatasetTable();
          updatePagination();
        });
      }
      
      // Initialize search functionality
      function initSearch() {
        datasetSearch.addEventListener('input', debounce(function() {
          const searchTerm = this.value.toLowerCase();
          
          if (searchTerm === '') {
            filteredDataset = [...dataset];
          } else {
            filteredDataset = dataset.filter(row => {
              return Object.values(row).some(value => 
                value.toString().toLowerCase().includes(searchTerm)
              );
            });
          }
          
          currentPage = 1; // Reset to first page
          updateDatasetTable();
          updatePagination();
        }, 300));
      }
      
      // Initialize sorting functionality
      function initSorting() {
        document.querySelectorAll('#tableHeader th').forEach(th => {
          th.addEventListener('click', function() {
            const column = this.getAttribute('data-column');
            
            // Remove sort indicators from all headers
            document.querySelectorAll('#tableHeader th').forEach(header => {
              header.querySelector('i').className = 'fas fa-sort text-gray-400 ml-1';
            });
            
            // Get current sort direction
            let sortDirection = this.getAttribute('data-sort') || 'none';
            
            // Determine new sort direction
            if (sortDirection === 'none' || sortDirection === 'desc') {
              sortDirection = 'asc';
              this.querySelector('i').className = 'fas fa-sort-up text-blue-500 ml-1';
            } else {
              sortDirection = 'desc';
              this.querySelector('i').className = 'fas fa-sort-down text-blue-500 ml-1';
            }
            
            // Set new sort direction
            this.setAttribute('data-sort', sortDirection);
            
            // Sort the dataset
            filteredDataset.sort((a, b) => {
              const valueA = a[column];
              const valueB = b[column];
              
              // Try to convert to numbers for numeric comparison
              const numA = !isNaN(parseFloat(valueA)) ? parseFloat(valueA) : valueA;
              const numB = !isNaN(parseFloat(valueB)) ? parseFloat(valueB) : valueB;
              
              if (sortDirection === 'asc') {
                return numA > numB ? 1 : -1;
              } else {
                return numA < numB ? 1 : -1;
              }
            });
            
            updateDatasetTable();
          });
        });
      }
      
      // Initialize download functionality
      function initDownload(csvText) {
        datasetDownloadBtn.addEventListener('click', () => {
          const blob = new Blob([csvText], { type: 'text/csv' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'factor_analysis_dataset.csv';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        });
      }
      
      // Debounce function for search input
      function debounce(func, wait) {
        let timeout;
        return function(...args) {
          const context = this;
          clearTimeout(timeout);
          timeout = setTimeout(() => func.apply(context, args), wait);
        };
      }
      
      // Initialize Factor Loadings tabs
      function initFactorLoadingsTabs() {
        const tabs = document.querySelectorAll('.tabs .tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
          tab.addEventListener('click', () => {
            // Remove active class from all tabs and contents
            tabs.forEach(t => t.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab
            tab.classList.add('active');
            
            // Show corresponding content
            const tabId = tab.getAttribute('data-tab');
            const content = document.getElementById(tabId);
            if (content) {
              content.classList.add('active');
              
              // Initialize heatmap if heatmap tab is selected
              if (tabId === 'heatmap') {
                const canvas = document.getElementById('heatmapChart');
                if (canvas) {
                  // Set canvas dimensions
                  canvas.width = canvas.parentElement.offsetWidth;
                  canvas.height = 400; // Fixed height
                  drawHeatmap();
                }
              }
            }
          });
        });
      }

      // Function to draw the heatmap visualization for factor loadings
      function drawHeatmap() {
        console.log('Initializing heatmap...');
        const canvas = document.getElementById('heatmapChart');
        if (!canvas) {
          console.error('Heatmap canvas element not found');
          return;
        }
        
        const ctx = canvas.getContext('2d');
        if (!ctx) {
          console.error('Could not get 2D context for heatmap canvas');
          return;
        }
        
        // Clear previous drawing
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        const variables = ['climate', 'housing', 'health', 'crime', 'trans', 'educate', 'arts', 'recreate', 'econ'];
        const factors = ['Factor 1', 'Factor 2', 'Factor 3'];
        const values = [
          [0.287, 0.076, 0.841],
          [0.698, 0.153, 0.084],
          [0.744, -0.410, -0.020],
          [0.471, 0.522, 0.135],
          [0.681, -0.156, -0.148],
          [0.498, -0.498, -0.253],
          [0.860, -0.115, 0.012],
          [0.642, 0.322, 0.044],
          [0.298, 0.595, -0.533]
        ];
        
        // Check if heatmap should be redrawn (first time or window resize)
        if (!window.heatmapData) {
          window.heatmapData = {
            variables,
            factors,
            values,
            highlighted: null
          };
        }
        
        // Calculate grid dimensions
        const padding = 50;
        const cellWidth = (canvas.width - padding * 2) / factors.length;
        const cellHeight = (canvas.height - padding * 2) / variables.length;
        
        // Draw column headers
        ctx.font = 'bold 14px Arial';
        ctx.textAlign = 'center';
        ctx.fillStyle = '#333';
        factors.forEach((factor, i) => {
          ctx.fillText(factor, padding + cellWidth * i + cellWidth / 2, padding - 20);
        });
        
        // Draw row headers
        ctx.textAlign = 'right';
        variables.forEach((variable, i) => {
          ctx.fillText(variable, padding - 10, padding + cellHeight * i + cellHeight / 2 + 5);
        });
        
        // Draw cells
        for (let row = 0; row < variables.length; row++) {
          for (let col = 0; col < factors.length; col++) {
            const value = values[row][col];
            const x = padding + col * cellWidth;
            const y = padding + row * cellHeight;
            
            // Calculate color intensity based on value
            const intensity = Math.min(Math.abs(value), 1);
            let color;
            let borderColor;
            if (value > 0) {
              color = `rgba(67, 97, 238, ${intensity})`;
              borderColor = `rgba(67, 97, 238, 1)`;
            } else {
              color = `rgba(247, 37, 133, ${intensity})`;
              borderColor = `rgba(247, 37, 133, 1)`;
            }
            
            // Draw cell background
            ctx.fillStyle = color;
            
            // Check if this cell is highlighted
            if (window.heatmapData.highlighted === `${row}-${col}`) {
              ctx.shadowColor = '#333';
              ctx.shadowBlur = 10;
              ctx.strokeStyle = '#000';
              ctx.lineWidth = 2;
            } else {
              ctx.shadowBlur = 0;
              ctx.strokeStyle = '#ddd';
              ctx.lineWidth = 0.5;
            }
            
            ctx.fillRect(x, y, cellWidth, cellHeight);
            ctx.strokeRect(x, y, cellWidth, cellHeight);
            
            // Draw value text
            ctx.shadowBlur = 0;
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillStyle = intensity > 0.5 ? 'white' : '#333';
            ctx.fillText(value.toFixed(3), x + cellWidth / 2, y + cellHeight / 2 + 5);
          }
        }
        
        // Add event listener for interactive hover effects if not already added
        if (!window.heatmapEventAdded) {
          window.heatmapEventAdded = true;
          canvas.addEventListener('mousemove', function(event) {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            
            // Check if mouse is in grid area
            if (x > padding && x < canvas.width - padding && y > padding && y < canvas.height - padding) {
              const col = Math.floor((x - padding) / cellWidth);
              const row = Math.floor((y - padding) / cellHeight);
              
              if (col >= 0 && col < factors.length && row >= 0 && row < variables.length) {
                const cellId = `${row}-${col}`;
                if (window.heatmapData.highlighted !== cellId) {
                  window.heatmapData.highlighted = cellId;
                  drawHeatmap();
                  
                  // Show tooltip
                  const variable = variables[row];
                  const factor = factors[col];
                  const value = values[row][col];
                  
                  const tooltip = document.createElement('div');
                  tooltip.id = 'heatmap-tooltip';
                  tooltip.className = 'fixed bg-white dark:bg-gray-800 p-3 rounded shadow-lg z-50';
                  tooltip.style.left = (event.clientX + 10) + 'px';
                  tooltip.style.top = (event.clientY - 30) + 'px';
                  
                  let strengthClass;
                  let strengthText;
                  
                  if (Math.abs(value) > 0.7) {
                    strengthClass = 'text-green-600 dark:text-green-400';
                    strengthText = 'Strong';
                  } else if (Math.abs(value) > 0.5) {
                    strengthClass = 'text-blue-600 dark:text-blue-400';
                    strengthText = 'Moderate';
                  } else if (Math.abs(value) > 0.3) {
                    strengthClass = 'text-yellow-600 dark:text-yellow-400';
                    strengthText = 'Weak';
                  } else {
                    strengthClass = 'text-gray-600 dark:text-gray-400';
                    strengthText = 'Very Weak';
                  }
                  
                  tooltip.innerHTML = `
                    <div class="font-bold">${variable} → ${factor}</div>
                    <div>Loading: <span class="font-bold">${value.toFixed(3)}</span></div>
                    <div>Strength: <span class="${strengthClass} font-bold">${strengthText}</span></div>
                  `;
                  
                  // Remove existing tooltip if any
                  const existingTooltip = document.getElementById('heatmap-tooltip');
                  if (existingTooltip) {
                    document.body.removeChild(existingTooltip);
                  }
                  
                  document.body.appendChild(tooltip);
                }
                return;
              }
            }
            
            // If we got here, we're not over a cell
            if (window.heatmapData.highlighted) {
              window.heatmapData.highlighted = null;
              drawHeatmap();
              
              // Remove tooltip
              const existingTooltip = document.getElementById('heatmap-tooltip');
              if (existingTooltip) {
                document.body.removeChild(existingTooltip);
              }
            }
          });
          
          canvas.addEventListener('mouseleave', function() {
            // Clear highlight when mouse leaves canvas
            if (window.heatmapData.highlighted) {
              window.heatmapData.highlighted = null;
              drawHeatmap();
              
              // Remove tooltip
              const existingTooltip = document.getElementById('heatmap-tooltip');
              if (existingTooltip) {
                document.body.removeChild(existingTooltip);
              }
            }
          });
          
          window.heatmapEventAdded = true;
        }
      }

      // Initialize social links and enhanced creator profile features
      function initSocialLinks() {
        // Add hover effects to social links
        const socialIcons = document.querySelectorAll('footer a i');
        socialIcons.forEach(icon => {
          icon.parentElement.addEventListener('mouseenter', () => {
            icon.classList.add('animate-bounce');
            setTimeout(() => {
              icon.classList.remove('animate-bounce');
            }, 1000);
          });
        });
        
        // Add a scroll to top feature in footer
        const footerContainer = document.querySelector('footer');
        if (footerContainer) {
          const scrollTopBtn = document.createElement('button');
          scrollTopBtn.className = 'fixed bottom-6 right-6 bg-purple-600 text-white w-10 h-10 rounded-full flex items-center justify-center shadow-lg hover:bg-purple-700 transition-colors';
          scrollTopBtn.innerHTML = '<i class="fas fa-arrow-up"></i>';
          scrollTopBtn.style.zIndex = '50';
          scrollTopBtn.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
          
          // Only show when scrolled down
          scrollTopBtn.style.opacity = '0';
          scrollTopBtn.style.visibility = 'hidden';
          scrollTopBtn.style.transition = 'opacity 0.3s, visibility 0.3s';
          
          window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
              scrollTopBtn.style.opacity = '1';
              scrollTopBtn.style.visibility = 'visible';
            } else {
              scrollTopBtn.style.opacity = '0';
              scrollTopBtn.style.visibility = 'hidden';
            }
          });
          
          document.body.appendChild(scrollTopBtn);
        }
        
        // Create a tooltip for the creator badge
        const creatorBadge = document.querySelector('.interactive-badge');
        if (creatorBadge) {
          creatorBadge.setAttribute('title', 'Click to view my profile and contact information');
        }
      }

      // Update dataset table with current page data
      function updateDatasetTable() {
        const tableHeader = document.getElementById('tableHeader');
        const tableBody = document.getElementById('tableBody');
        
        // Clear existing content
        tableHeader.innerHTML = '';
        tableBody.innerHTML = '';
        
        if (dataset.length === 0) {
          tableBody.innerHTML = `
            <tr>
              <td colspan="100%" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">
                No data available
              </td>
            </tr>
          `;
          return;
        }
        
        // Add headers
        const headers = Object.keys(dataset[0]);
        headers.forEach(header => {
          tableHeader.innerHTML += `
            <th data-column="${header}" class="px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600/50 transition-colors">
              ${header}
              <i class="fas fa-sort text-gray-400 ml-1"></i>
            </th>
          `;
        });
        
        // Calculate slice indices based on pagination
        const startIndex = pageSize === 'all' ? 0 : (currentPage - 1) * parseInt(pageSize);
        const endIndex = pageSize === 'all' ? filteredDataset.length : startIndex + parseInt(pageSize);
        
        // Add rows for current page
        const pageData = filteredDataset.slice(startIndex, endIndex);
        
        pageData.forEach((row, rowIndex) => {
          let rowHtml = `
            <tr class="${rowIndex % 2 === 0 ? 'bg-white dark:bg-gray-800' : 'bg-gray-50 dark:bg-gray-700/50'} hover:bg-gray-100 dark:hover:bg-gray-600/50 transition-colors">
          `;
          
          headers.forEach(header => {
            rowHtml += `
              <td class="px-4 py-2 text-sm text-gray-800 dark:text-gray-200 whitespace-nowrap">
                ${row[header] || ''}
              </td>
            `;
          });
          
          rowHtml += '</tr>';
          tableBody.innerHTML += rowHtml;
        });
      }
    }
  </script>

  <!-- Direct button handling -->
  <script>
    // Direct export handler
    function handleExport() {
      console.log("Export button clicked");
      // Show notification
      const notification = document.createElement('div');
      notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center';
      notification.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Preparing PDF export...';
      notification.style.zIndex = '9999'; // Ensure it's above everything
      document.body.appendChild(notification);
      
      // Trigger print after a short delay
      setTimeout(() => {
        window.print();
        
        notification.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Export complete!';
        setTimeout(() => {
          if (document.body.contains(notification)) {
            document.body.removeChild(notification);
          }
        }, 2000);
      }, 1000);
    }
    
    // Direct share handler
    function handleShare() {
      console.log("Share button clicked");
      
      const url = window.location.href;
      const title = 'Factor Analysis Report';
      
      try {
        if (navigator.share) {
          navigator.share({
            title: title,
            url: url
          }).catch(() => {
            directCopyToClipboard(url);
          });
        } else {
          directCopyToClipboard(url);
        }
      } catch (e) {
        console.error("Share failed:", e);
        directCopyToClipboard(url);
      }
    }
    
    // Helper function to copy text to clipboard
    function directCopyToClipboard(text) {
      // Create a temporary textarea
      const textArea = document.createElement('textarea');
      textArea.value = text;
      textArea.style.position = 'fixed';
      textArea.style.left = '-9999px';
      textArea.style.top = '-9999px';
      document.body.appendChild(textArea);
      
      try {
        // Try to select and copy
        textArea.select();
        const success = document.execCommand('copy');
        
        // Show notification based on success
        const notification = document.createElement('div');
        if (success) {
          notification.className = 'fixed bottom-4 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center';
          notification.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Link copied to clipboard!';
        } else {
          notification.className = 'fixed bottom-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center';
          notification.innerHTML = '<i class="fas fa-exclamation-circle mr-2"></i> Failed to copy link!';
        }
        
        notification.style.zIndex = '9999'; // Ensure it's above everything
        document.body.appendChild(notification);
        
        setTimeout(() => {
          if (document.body.contains(notification)) {
            document.body.removeChild(notification);
          }
        }, 2000);
      } catch (err) {
        console.error('Unable to copy', err);
      }
      
      document.body.removeChild(textArea);
    }
  </script>

  <!-- Footer for Report Section -->
  <footer class="bg-gradient-to-br from-gray-900 via-purple-950 to-indigo-900 text-white py-12 mt-12 relative overflow-hidden">
    <!-- Animated background elements -->
    <div class="absolute inset-0 overflow-hidden">
      <div class="particles-js absolute inset-0 opacity-20" id="report-footer-particles"></div>
      <div class="absolute top-0 right-0 w-96 h-96 bg-blue-500/10 rounded-full filter blur-3xl animate-pulse-slow"></div>
      <div class="absolute bottom-0 left-0 w-96 h-96 bg-purple-500/10 rounded-full filter blur-3xl animate-pulse-slow" style="animation-delay: 2s"></div>
    </div>
    
    <!-- Border glow top -->
    <div class="absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-purple-500/50 to-transparent"></div>
    
    <!-- Content container -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
        <!-- About Creator Section - Enhanced with 3D card -->
        <div class="space-y-4 perspective">
          <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-300">
            <i class="fas fa-user-circle mr-3 text-purple-400"></i>
            About Aditto Ahosan Kabbo
          </h3>
          <p class="text-gray-300 text-sm leading-relaxed">Data Enthusiast and Statistics Student at Pabna University of Science and Technology. Passionate about transforming raw data into actionable insights.</p>
          
          <!-- 3D interactive profile card -->
          <div class="profile-card bg-gradient-to-br from-purple-900/60 to-indigo-900/60 backdrop-blur-lg rounded-xl p-6 mt-4 border border-white/10 shadow-xl transform transition-all duration-500 hover:shadow-purple-500/20 group relative">
            <!-- Card tilt effect - JS will be added later -->
            <div class="absolute inset-0 bg-gradient-to-br from-purple-500/5 to-blue-500/5 opacity-0 group-hover:opacity-100 rounded-xl transition-opacity"></div>
            
            <!-- Animated profile picture -->
            <div class="relative w-32 h-32 mx-auto mb-5 rounded-full overflow-hidden profile-pic-container perspective">
              <div class="profile-pic-inner transform transition-all duration-700">
                <img src="https://raw.githubusercontent.com/AdittoAhosanKabbo/AdittoAhosanKabbo/main/Assets/20221031_113233-removebg.png" 
                    alt="Aditto Ahosan Kabbo" 
                    class="w-full h-full object-cover rounded-full border-2 border-purple-400/70 shadow-lg"
                    onerror="this.src='https://avatars.githubusercontent.com/u/AdittoAhosanKabbo'"
                    style="aspect-ratio: 1/1; object-fit: cover; object-position: center top;">
              </div>
              
              <!-- Glowing ring animation -->
              <div class="absolute inset-0 border-2 border-transparent rounded-full animate-spin-slow opacity-0 group-hover:opacity-100" style="background: linear-gradient(45deg, transparent, rgba(147, 51, 234, 0.3), transparent); animation-duration: 3s;"></div>
            </div>
            
            <!-- Animated title with typewriter effect -->
            <div class="text-center h-6 mb-2">
              <span class="inline-block font-medium text-purple-300 typewriter-container overflow-hidden whitespace-nowrap" data-typing="🎓 Statistics Student,💻 Data Enthusiast,📊 Skilled in Visualization ">🎓 Statistics Student</span>
            </div>
            
            <!-- Interactive buttons that appear on hover -->
            <div class="mt-4 flex justify-center space-x-3 opacity-0 group-hover:opacity-100 transition-opacity">
              <button class="btn-glow px-3 py-1 rounded-full bg-purple-600/30 hover:bg-purple-600/50 text-xs font-medium border border-purple-500/30 transition-all flex items-center" onclick="window.open('https://github.com/AdittoAhosanKabbo', '_blank')">
                <i class="fab fa-github mr-1"></i> GitHub
              </button>
              <button class="btn-glow px-3 py-1 rounded-full bg-blue-600/30 hover:bg-blue-600/50 text-xs font-medium border border-blue-500/30 transition-all flex items-center" onclick="window.open('https://www.linkedin.com/in/adittoahosankabbo/', '_blank')">
                <i class="fab fa-linkedin mr-1"></i> LinkedIn
              </button>
            </div>
          </div>
        </div>
        
        <!-- Enhanced Connect with me - Interactive 3D social links -->
        <div class="space-y-5">
          <h3 class="text-2xl font-bold flex items-center bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300">
            <i class="fas fa-link mr-3 text-blue-400"></i>
            Connect with me
          </h3>
          <ul class="space-y-3 text-gray-300">
            <li class="flex items-center hover:text-white transition-colors">
              <i class="fab fa-linkedin text-blue-400 w-6"></i>
              <a href="https://www.linkedin.com/in/adittoahosankabbo/" target="_blank" class="ml-2 hover:underline">LinkedIn</a>
            </li>
            <li class="flex items-center hover:text-white transition-colors">
              <i class="fab fa-github text-gray-400 w-6"></i>
              <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="ml-2 hover:underline">GitHub</a>
            </li>
            <li class="flex items-center hover:text-white transition-colors">
              <i class="fab fa-facebook text-blue-500 w-6"></i>
              <a href="https://www.facebook.com/Adittoahosan" target="_blank" class="ml-2 hover:underline">Facebook</a>
            </li>
            <li class="flex items-center hover:text-white transition-colors">
              <i class="fab fa-kaggle text-cyan-500 w-6"></i>
              <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="ml-2 hover:underline">Kaggle</a>
            </li>
            <li class="flex items-center hover:text-white transition-colors">
              <i class="far fa-envelope text-red-400 w-6"></i>
              <a href="mailto:adittoahosankabbo@gmail.com" class="ml-2 hover:underline">adittoahosankabbo@gmail.com</a>
            </li>
            <li class="flex items-center hover:text-white transition-colors">
              <i class="fab fa-whatsapp text-green-400 w-6"></i>
              <a href="https://wa.me/8801749018051?text=hello" target="_blank" class="ml-2 hover:underline">WhatsApp</a>
            </li>
          </ul>
        </div>
        
        <!-- Skills & Project Links -->
        <div class="space-y-4">
          <h3 class="text-xl font-bold flex items-center">
            <i class="fas fa-laptop-code mr-2 text-green-400"></i>
            Skills & Projects
          </h3>
          <div class="grid grid-cols-2 gap-2 mb-4">
            <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
              <i class="fab fa-python text-xl text-blue-400"></i>
              <p class="text-xs mt-1">Python</p>
            </div>
            <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
              <i class="fas fa-database text-xl text-blue-500"></i>
              <p class="text-xs mt-1">SQL</p>
            </div>
            <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
              <i class="fab fa-r-project text-xl text-blue-300"></i>
              <p class="text-xs mt-1">R</p>
            </div>
            <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
              <i class="fas fa-table text-xl text-green-400"></i>
              <p class="text-xs mt-1">Excel</p>
            </div>
            <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
              <i class="fas fa-chart-bar text-xl text-purple-400"></i>
              <p class="text-xs mt-1">Power BI</p>
            </div>
            <div class="bg-white/10 backdrop-blur-sm p-2 rounded text-center">
              <i class="fas fa-chart-line text-xl text-purple-300"></i>
              <p class="text-xs mt-1">SPSS</p>
            </div>
          </div>
          <p class="text-gray-300 text-sm">View more data analysis and statistics projects on my GitHub and Kaggle profiles.</p>
          <div class="mt-4">
            <a href="https://github.com/AdittoAhosanKabbo" target="_blank" class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:from-purple-700 hover:to-indigo-700 transition-all inline-flex items-center">
              <i class="fab fa-github mr-2"></i> View GitHub Projects
            </a>
          </div>
        </div>
      </div>
      
      <div class="mt-8 pt-6 border-t border-white/10 flex flex-col md:flex-row justify-between items-center">
        <p class="text-gray-400 text-sm">© 2025 Aditto Ahosan Kabbo. All rights reserved.</p>
        <div class="flex space-x-4 mt-4 md:mt-0">
          <a href="https://www.hackerrank.com/profile/aditahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
            <i class="fab fa-hackerrank"></i>
          </a>
          <a href="https://www.reddit.com/user/AhosanKabbo/" target="_blank" class="text-gray-400 hover:text-white transition-colors">
            <i class="fab fa-reddit-alien"></i>
          </a>
          <a href="https://www.kaggle.com/adittoahosankabbo" target="_blank" class="text-gray-400 hover:text-white transition-colors">
            <i class="fab fa-kaggle"></i>
          </a>
        </div>
      </div>
    </div>
    
    <!-- Footer particles container -->
    <div id="report-footer-particles-js" class="absolute inset-0 opacity-20"></div>
  </footer>
      </div>
    </div>
    </div>
    
    <script>
      // Tab navigation functionality
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize footers particles
        if (typeof particlesJS === 'function') {
          if (document.getElementById('dataset-footer-particles-js')) {
            particlesJS('dataset-footer-particles-js', {
              particles: {
                number: { value: 30, density: { enable: true, value_area: 800 } },
                color: { value: "#ffffff" },
                opacity: { value: 0.3, random: true },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.2, width: 1 },
                move: { enable: true, speed: 1, direction: "none", random: true, out_mode: "out" }
              }
            });
          }
          
          if (document.getElementById('code-footer-particles-js')) {
            particlesJS('code-footer-particles-js', {
              particles: {
                number: { value: 30, density: { enable: true, value_area: 800 } },
                color: { value: "#ffffff" },
                opacity: { value: 0.3, random: true },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.2, width: 1 },
                move: { enable: true, speed: 1, direction: "none", random: true, out_mode: "out" }
              }
            });
          }
          
          if (document.getElementById('math-footer-particles-js')) {
            particlesJS('math-footer-particles-js', {
              particles: {
                number: { value: 30, density: { enable: true, value_area: 800 } },
                color: { value: "#ffffff" },
                opacity: { value: 0.3, random: true },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.2, width: 1 },
                move: { enable: true, speed: 1, direction: "none", random: true, out_mode: "out" }
              }
            });
          }
          
          if (document.getElementById('report-footer-particles-js')) {
            particlesJS('report-footer-particles-js', {
              particles: {
                number: { value: 30, density: { enable: true, value_area: 800 } },
                color: { value: "#ffffff" },
                opacity: { value: 0.3, random: true },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.2, width: 1 },
                move: { enable: true, speed: 1, direction: "none", random: true, out_mode: "out" }
              }
            });
          }
        }
        
        const tabBtns = document.querySelectorAll('.main-tab-btn');
        const tabContents = document.querySelectorAll('.main-tab-content');
        
        tabBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            // Deactivate all tabs
            tabBtns.forEach(b => {
              b.classList.remove('active', 'border-indigo-500', 'text-indigo-600', 'dark:text-indigo-400');
              b.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');
            });
            
            // Hide all tab content
            tabContents.forEach(content => {
              content.classList.add('hidden');
            });
            
            // Activate clicked tab
            this.classList.add('active', 'border-indigo-500', 'text-indigo-600', 'dark:text-indigo-400');
            this.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');
            
            // Show corresponding content
            const tabId = this.id.replace('Btn', 'Content');
            document.getElementById(tabId).classList.remove('hidden');
            
            // Reinitialize any charts if needed
            if (window.initializeCharts && tabId === 'reportTabContent') {
              setTimeout(function() {
                window.initializeCharts();
              }, 100);
            }
          });
        });
        
        // Connect the notebook button to the existing modal
        const openNotebookModalBtn = document.getElementById('openNotebookModal');
        if (openNotebookModalBtn) {
          openNotebookModalBtn.addEventListener('click', function() {
            const notebookBtn = document.getElementById('notebookBtn');
            if (notebookBtn) {
              notebookBtn.click();
            }
          });
        }
        
        // Connect the dataset button to the existing modal
        const viewDatasetBtn = document.getElementById('viewDatasetBtn');
        if (viewDatasetBtn) {
          viewDatasetBtn.addEventListener('click', function() {
            const datasetBtn = document.getElementById('datasetBtn');
            if (datasetBtn) {
              datasetBtn.click();
            }
          });
        }
      });
    </script>
  
  <!-- Enhanced footer styles and animations -->
  <style>
    /* 3D perspective for cards */
    .perspective {
      perspective: 1000px;
    }
    
    /* Profile card animations */
    .profile-card {
      transform-style: preserve-3d;
      transition: transform 0.3s ease;
    }
    
    .profile-card:hover {
      transform: translateY(-5px) rotateX(5deg);
    }
    
    .profile-pic-inner:hover {
      transform: scale(1.05) rotateY(10deg);
    }
    
    /* Skill shimmer effect */
    .skill-shimmer {
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transform: translateX(-100%);
      animation: shimmer 2s infinite;
      animation-play-state: paused;
    }
    
    .skill-card:hover .skill-shimmer {
      animation-play-state: running;
    }
    
    @keyframes shimmer {
      100% { transform: translateX(100%); }
    }
    
    /* Button glow effects */
    .btn-glow {
      position: relative;
      overflow: hidden;
    }
    
    .btn-glow::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 60%);
      opacity: 0;
      transition: opacity 0.5s;
    }
    
    .btn-glow:hover::after {
      opacity: 1;
    }
    
    .btn-glow-alt {
      box-shadow: 0 0 0 transparent;
      transition: all 0.3s;
    }
    
    .btn-glow-alt:hover {
      box-shadow: 0 0 15px rgba(72, 187, 120, 0.3);
    }
    
    /* Social hexagon styles */
    .social-hexagon {
      width: 100%;
      padding-top: 86.6%; /* Height to width ratio for hexagon */
      position: relative;
      background: rgba(255, 255, 255, 0.05);
      clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .social-hexagon:hover {
      transform: translateY(-5px);
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.2);
    }
    
    .hexagon-inner {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    
    /* Social hexagon specific hover colors */
    .social-hexagon.linkedin:hover { box-shadow: 0 10px 20px -10px rgba(10, 102, 194, 0.5); }
    .social-hexagon.github:hover { box-shadow: 0 10px 20px -10px rgba(100, 100, 100, 0.5); }
    .social-hexagon.facebook:hover { box-shadow: 0 10px 20px -10px rgba(66, 103, 178, 0.5); }
    .social-hexagon.kaggle:hover { box-shadow: 0 10px 20px -10px rgba(32, 182, 216, 0.5); }
    .social-hexagon.email:hover { box-shadow: 0 10px 20px -10px rgba(234, 67, 53, 0.5); }
    .social-hexagon.whatsapp:hover { box-shadow: 0 10px 20px -10px rgba(37, 211, 102, 0.5); }
    .social-hexagon.hackerrank:hover { box-shadow: 0 10px 20px -10px rgba(0, 175, 74, 0.5); }
    .social-hexagon.reddit:hover { box-shadow: 0 10px 20px -10px rgba(255, 69, 0, 0.5); }
    
    /* Animated spin for icons */
    @keyframes spin-once {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .group:hover .group-hover\:animate-spin-once {
      animation: spin-once 0.5s ease-in-out;
    }
    
    /* Animated bounce for scroll to top */
    @keyframes bounce-short {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-3px); }
    }
    
    .animate-bounce-short {
      animation: bounce-short 1s infinite;
    }
    
    /* Slow spin animation */
    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .animate-spin-slow {
      animation: spin-slow 6s linear infinite;
    }
    
    /* Progress bar pulse animation */
    @keyframes pulse-progress {
      0%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(1.1); }
    }
    
    .group-hover\:animate-pulse-progress {
      animation: pulse-progress 1.5s ease infinite;
    }
    
    /* Animated sliding gradient */
    @keyframes slide {
      from { transform: translateX(-50%); }
      to { transform: translateX(0); }
    }
    
    .animate-slide {
      animation: slide 2s linear infinite;
    }
    
    /* Text gradient hover effect */
    .text-gradient-hover {
      background-clip: text;
      -webkit-background-clip: text;
      transition: all 0.3s ease;
    }
    
    .text-gradient-hover:hover {
      color: transparent;
      background-image: linear-gradient(45deg, #8b5cf6, #ec4899);
    }
    
    /* Typewriter effect */
    .typewriter-container::after {
      content: '|';
      animation: blink 1s step-end infinite;
    }
    
    @keyframes blink {
      from, to { opacity: 1; }
      50% { opacity: 0; }
    }
  </style>
  
  <!-- Enhanced footer interactive scripts -->
  <script>
    // Initialize after DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize scroll to top button
      initScrollToTop();
      
      // Initialize profile card tilt effect
      initCardTilt();
      
      // Initialize typewriter effect
      initTypewriter();
      
      // Initialize footer particles
      initFooterParticles();
    });
    
    // Scroll to top functionality
    function initScrollToTop() {
      const scrollBtn = document.getElementById('scrollToTopBtn');
      if (!scrollBtn) return;
      
      window.addEventListener('scroll', function() {
        if (window.scrollY > 500) {
          scrollBtn.classList.remove('invisible', 'opacity-0');
          scrollBtn.classList.add('opacity-100');
        } else {
          scrollBtn.classList.remove('opacity-100');
          scrollBtn.classList.add('opacity-0');
          // Keep invisible class for accessibility after fade out
          setTimeout(() => {
            if (window.scrollY <= 500) {
              scrollBtn.classList.add('invisible');
            }
          }, 300);
        }
      });
      
      scrollBtn.addEventListener('click', function() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
    }
    
    // 3D tilt effect for profile card
    function initCardTilt() {
      const card = document.querySelector('.profile-card');
      if (!card) return;
      
      card.addEventListener('mousemove', function(e) {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        const centerX = rect.width / 2;
        const centerY = rect.height / 2;
        
        const angleX = (y - centerY) / 20;
        const angleY = (centerX - x) / 20;
        
        card.style.transform = `rotateX(${angleX}deg) rotateY(${angleY}deg) translateZ(10px)`;
      });
      
      card.addEventListener('mouseleave', function() {
        card.style.transform = 'rotateX(0) rotateY(0) translateZ(0)';
      });
    }
    
    // Typewriter effect for titles
    function initTypewriter() {
      const typewriterElement = document.querySelector('.typewriter-container');
      if (!typewriterElement) return;
      
      const phrases = typewriterElement.getAttribute('data-typing').split(',');
      let currentPhraseIndex = 0;
      let currentCharIndex = 0;
      let isDeleting = false;
      let typingSpeed = 100;
      
      function type() {
        const currentPhrase = phrases[currentPhraseIndex];
        
        if (isDeleting) {
          typewriterElement.textContent = currentPhrase.substring(0, currentCharIndex - 1);
          currentCharIndex--;
          typingSpeed = 50;
        } else {
          typewriterElement.textContent = currentPhrase.substring(0, currentCharIndex + 1);
          currentCharIndex++;
          typingSpeed = 150;
        }
        
        if (!isDeleting && currentCharIndex === currentPhrase.length) {
          isDeleting = true;
          typingSpeed = 1500; // Pause at the end of phrase
        } else if (isDeleting && currentCharIndex === 0) {
          isDeleting = false;
          currentPhraseIndex = (currentPhraseIndex + 1) % phrases.length;
          typingSpeed = 500; // Pause before next phrase
        }
        
        setTimeout(type, typingSpeed);
      }
      
      setTimeout(type, 1000);
    }
    
    // Initialize particles effect in footer
    function initFooterParticles() {
      if (typeof particlesJS === 'function' && document.getElementById('footer-particles-js')) {
        particlesJS('footer-particles-js', {
          particles: {
            number: { value: 30, density: { enable: true, value_area: 800 } },
            color: { value: "#ffffff" },
            shape: { type: "circle" },
            opacity: { value: 0.3, random: true },
            size: { value: 3, random: true },
            line_linked: {
              enable: true,
              distance: 150,
              color: "#ffffff",
              opacity: 0.2,
              width: 1
            },
            move: {
              enable: true,
              speed: 1,
              direction: "none",
              random: true,
              straight: false,
              out_mode: "out",
              bounce: false
            }
          },
          interactivity: {
            detect_on: "canvas",
            events: {
              onhover: { enable: true, mode: "grab" },
              onclick: { enable: true, mode: "push" },
              resize: true
            }
          },
          retina_detect: true
        });
      }
    }
  </script>

  <!-- Initialize Factor Loadings tabs and Heatmap -->
  <script>
    // Ensure tabs are initialized correctly
    document.addEventListener('DOMContentLoaded', function() {
      // Directly initialize tabs on all tab elements
      const tabs = document.querySelectorAll('.tabs .tab');
      const tabContents = document.querySelectorAll('.tab-content');
      
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          // Remove active class from all tabs and contents
          tabs.forEach(t => t.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));
          
          // Add active class to clicked tab
          tab.classList.add('active');
          
          // Show corresponding content
          const tabId = tab.getAttribute('data-tab');
          const content = document.getElementById(tabId);
          if (content) {
            content.classList.add('active');
            
            // Initialize heatmap if heatmap tab is selected
            if (tabId === 'heatmap') {
              const canvas = document.getElementById('heatmapChart');
              if (canvas) {
                canvas.width = canvas.parentElement.offsetWidth;
                canvas.height = 400;
                if (typeof drawHeatmap === 'function') {
                  drawHeatmap();
                }
              }
            }
          }
        });
      });
      
      // Initialize heatmap if heatmap tab is already active on page load
      const activeTab = document.querySelector('.tabs .tab.active');
      if (activeTab && activeTab.getAttribute('data-tab') === 'heatmap') {
        const canvas = document.getElementById('heatmapChart');
        if (canvas) {
          canvas.width = canvas.parentElement.offsetWidth;
          canvas.height = 400;
          if (typeof drawHeatmap === 'function') {
            drawHeatmap();
          }
        }
      }
    });
  </script>

  <!-- Performance and Accessibility Enhancements -->
  <script>
    // Initialize accessibility features
    document.addEventListener('DOMContentLoaded', function() {
      // Load settings from localStorage
      applyUserPreferences();
      
      // Initialize AOS for scroll animations if available
      if (typeof AOS !== 'undefined') {
        AOS.init({
          duration: 800,
          easing: 'ease-in-out',
          once: true,
          mirror: false,
          disable: window.matchMedia('(prefers-reduced-motion: reduce)').matches
        });
      }
      
      // Add lazy loading for images
      document.querySelectorAll('img:not([loading])').forEach(img => {
        img.setAttribute('loading', 'lazy');
      });
      
      // Lazy load iframes
      document.querySelectorAll('iframe:not([loading])').forEach(iframe => {
        iframe.setAttribute('loading', 'lazy');
      });
      
      // Add keyboard navigation for tabs
      initKeyboardNavigation();
      
      // Initialize text size toggle button
      const textSizeToggle = document.getElementById('textSizeToggle');
      if (textSizeToggle) {
        textSizeToggle.addEventListener('click', function() {
          document.body.classList.toggle('text-size-large');
          localStorage.setItem('largeText', document.body.classList.contains('text-size-large'));
          showToast(document.body.classList.contains('text-size-large') ? 'Larger text enabled' : 'Standard text size restored');
        });
      }
      
      // Initialize high contrast toggle button
      const contrastToggle = document.getElementById('contrastToggle');
      if (contrastToggle) {
        contrastToggle.addEventListener('click', function() {
          document.body.classList.toggle('high-contrast');
          localStorage.setItem('highContrast', document.body.classList.contains('high-contrast'));
          showToast(document.body.classList.contains('high-contrast') ? 'High contrast mode enabled' : 'Standard contrast restored');
        });
      }
      
      // Add ARIA labels to charts for better screen reader support
      document.querySelectorAll('.chart-container').forEach(container => {
        const canvas = container.querySelector('canvas');
        if (canvas) {
          if (!canvas.hasAttribute('aria-label')) {
            const title = container.querySelector('h3, h4, .chart-title')?.textContent || 'Chart visualization';
            canvas.setAttribute('aria-label', title);
          }
        }
      });
      
      // Hide loading overlay when page is fully loaded
      const loadingOverlay = document.getElementById('loadingOverlay');
      if (loadingOverlay) {
        loadingOverlay.style.opacity = '0';
        setTimeout(() => {
          loadingOverlay.style.display = 'none';
        }, 300);
      }
    });
    
    // Apply user's saved preferences
    function applyUserPreferences() {
      // Apply text size preference
      if (localStorage.getItem('largeText') === 'true') {
        document.body.classList.add('text-size-large');
      }
      
      // Apply contrast preference
      if (localStorage.getItem('highContrast') === 'true') {
        document.body.classList.add('high-contrast');
      }
      
      // Apply theme preference
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) {
        document.documentElement.classList.toggle('dark', savedTheme === 'dark');
        
        // Update theme toggle button if it exists
        const themeSwitcher = document.getElementById('themeSwitcher');
        if (themeSwitcher) {
          const lightIcon = themeSwitcher.querySelector('.light-icon');
          const darkIcon = themeSwitcher.querySelector('.dark-icon');
          
          if (lightIcon && darkIcon) {
            if (savedTheme === 'dark') {
              lightIcon.classList.add('hidden');
              darkIcon.classList.remove('hidden');
            } else {
              lightIcon.classList.remove('hidden');
              darkIcon.classList.add('hidden');
            }
          }
        }
      }
    }
    
    // Initialize keyboard navigation for interactive elements
    function initKeyboardNavigation() {
      // Tab navigation with arrow keys
      const tabButtons = document.querySelectorAll('[role="tab"]');
      
      tabButtons.forEach(tab => {
        tab.addEventListener('keydown', function(e) {
          // Arrow right or down: next tab
          if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
            e.preventDefault();
            const nextTab = this.nextElementSibling;
            if (nextTab && nextTab.getAttribute('role') === 'tab') {
              nextTab.focus();
              nextTab.click();
            } else {
              // Cycle to first tab if at the end
              const firstTab = this.parentNode.querySelector('[role="tab"]:first-child');
              if (firstTab) {
                firstTab.focus();
                firstTab.click();
              }
            }
          }
          
          // Arrow left or up: previous tab
          if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
            e.preventDefault();
            const prevTab = this.previousElementSibling;
            if (prevTab && prevTab.getAttribute('role') === 'tab') {
              prevTab.focus();
              prevTab.click();
            } else {
              // Cycle to last tab if at the beginning
              const lastTab = this.parentNode.querySelector('[role="tab"]:last-child');
              if (lastTab) {
                lastTab.focus();
                lastTab.click();
              }
            }
          }
        });
      });
    }
    
    // Function to show toast notifications
    function showToast(message, type = 'info', duration = 3000) {
      // Remove existing toasts
      document.querySelectorAll('.toast-notification').forEach(toast => {
        document.body.removeChild(toast);
      });
      
      // Create new toast
      const toast = document.createElement('div');
      toast.className = `fixed bottom-4 right-4 z-50 px-4 py-2 rounded-lg shadow-lg toast-notification ${
        type === 'success' ? 'bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100' :
        type === 'error' ? 'bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100' :
        'bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100'
      }`;
      
      // Add icon based on type
      let icon = '';
      if (type === 'success') icon = '<i class="fas fa-check-circle mr-2"></i>';
      else if (type === 'error') icon = '<i class="fas fa-exclamation-circle mr-2"></i>';
      else icon = '<i class="fas fa-info-circle mr-2"></i>';
      
      toast.innerHTML = `${icon}${message}`;
      document.body.appendChild(toast);
      
      // Animate in
      toast.style.transition = 'all 0.3s ease';
      toast.style.opacity = '0';
      toast.style.transform = 'translateY(20px)';
      
      // Trigger reflow to ensure animation works
      void toast.offsetWidth;
      
      toast.style.opacity = '1';
      toast.style.transform = 'translateY(0)';
      
      // Add close button
      const closeBtn = document.createElement('button');
      closeBtn.className = 'ml-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white';
      closeBtn.innerHTML = '<i class="fas fa-times"></i>';
      closeBtn.setAttribute('aria-label', 'Close notification');
      closeBtn.onclick = function() {
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(20px)';
        setTimeout(() => {
          if (document.body.contains(toast)) {
            document.body.removeChild(toast);
          }
        }, 300);
      };
      toast.appendChild(closeBtn);
      
      // Remove after duration
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(20px)';
        setTimeout(() => {
          if (document.body.contains(toast)) {
            document.body.removeChild(toast);
          }
        }, 300);
      }, duration);
    }
  </script>

</body>
</html>